# This is a TOML configuration file for Wflow.
# Relative file paths are interpreted as being relative to this TOML file.
# Wflow documentation https://deltares.github.io/Wflow.jl/dev/
# TOML documentation: https://github.com/toml-lang/toml

dir_input = "data/input"
dir_output = "data/output"

[time]
calendar = "proleptic_gregorian"
endtime = 2000-01-03T00:00:00
starttime = 1999-12-31T00:00:00
time_units = "days since 1900-01-01 00:00:00"
timestepsecs = 86400

[state]
path_input = "instates-moselle-sed.nc"
path_output = "outstates-moselle-sed.nc"

# if listed, the variable must be present in the NetCDF or error
# if not listed, the variable can get a default value if it has one

[state.variables]
river_water_clay__mass = "clayload"
river_bed_clay__mass = "claystore"
river_water_gravel__mass = "gravload"
river_bed_gravel__mass = "gravstore"
"river_water_aggregates~large__mass" = "laggload"
"river_bed_aggregates~large__mass" = "laggstore"
river_water_clay__mass_flow_rate = "outclay"
river_water_gravel__mass_flow_rate = "outgrav"
"river_water_aggregates~large__mass_flow_rate" = "outlagg"
"river_water_aggregates~small__mass_flow_rate" = "outsagg"
river_water_sand__mass_flow_rate = "outsand"
river_water_silt__mass_flow_rate = "outsilt"
"river_water_aggregates~small__mass" = "saggload" 
"river_bed_aggregates~small__mass" = "saggstore"
river_water_sand__mass = "sandload" 
river_bed_sand__mass = "sandstore"
river_water_silt__mass = "siltload" 
river_bed_silt__mass = "siltstore"

[input]
path_forcing = "forcing-moselle-sed.nc"
path_static = "staticmaps-moselle-sed.nc"

# these are not directly part of the model
gauges = "wflow_gauges"
ldd = "wflow_ldd"
river_location = "wflow_river"
subcatchment = "wflow_subcatch"
reservoir_area__number = "wflow_reservoirareas"
lake_area__number = "wflow_lakeareas"

[input.forcing]
atmosphere_water__precipitation_volume_flux = "P"
land_surface_water__depth = "levKinL"
river_water__depth = "h"
land_surface_water__volume_flow_rate = "runL"
river_water__volume_flow_rate = "q"

[input.parameters]
land_surface__slope = "Slope"
river__length = "wflow_riverlength"
river__slope = "RiverSlope"
river__width = "wflow_riverwidth"

reservoir_surface__area = "ResSimpleArea"
reservoir_location__number = "wflow_reservoirlocs"
lake_surface__area = "LakeArea"
lake_location__number = "wflow_lakelocs"
"reservoir_sediment~bedload__trapping_efficiency_coefficient" = "ResTrapEff"

vegetation_canopy__gap_fraction = "CanopyGapFraction"
"soil~compacted__area_fraction" = "PathFrac"
soil_erosion__rainfall_soil_detachability_factor = "soil_detachability"
soil_erosion__eurosem_exponent = "eros_spl_EUROSEM"
soil_erosion__usle_k_factor = "usle_k"
soil_erosion__usle_c_factor = "USLE_C"
soil_erosion__answers_overland_flow_factor = "eros_ov"

soil_clay__mass_fraction = "fclay_soil"
soil_silt__mass_fraction = "fsilt_soil"
soil_sand__mass_fraction = "fsand_soil"
"soil_aggregates~small__mass_fraction" = "fsagg_soil"
"soil_aggregates~large__mass_fraction" = "flagg_soil"

land_surface_water_sediment__particle_density = "sediment_density"
land_surface_water_sediment__govers_transport_capacity_coefficient = "c_govers"
land_surface_water_sediment__govers_transport_capacity_exponent = "n_govers"
land_surface_water_sediment__d50_diameter = "d50_soil"
land_surface_water_clay__d50_diameter = "dm_clay"
land_surface_water_silt__d50_diameter = "dm_silt"
land_surface_water_sand__d50_diameter = "dm_sand"
"land_surface_water_aggregates~small__d50_diameter" = "dm_sagg"
"land_surface_water_aggregates~large__d50_diameter" = "dm_lagg"

river_water_sediment__particle_density = "sediment_density"
river_water_sediment__d50_diameter = "D50_River"
river_water_sediment__bagnold_transport_capacity_coefficient = "c_Bagnold"
river_water_sediment__bagnold_transport_capacity_exponent = "exp_Bagnold"
river_water_sediment__kodatie_transport_capacity_a-coefficient = "a_kodatie"
river_water_sediment__kodatie_transport_capacity_b-coefficient = "b_kodatie"
river_water_sediment__kodatie_transport_capacity_c-coefficient = "c_kodatie"
river_water_sediment__kodatie_transport_capacity_d-coefficient = "d_kodatie"

river_bottom-and-bank_sediment__d50_diameter = "D50_River"
river_bottom-and-bank_clay__mass_fraction = "ClayF_River"
river_bottom-and-bank_silt__mass_fraction = "SiltF_River"
river_bottom-and-bank_sand__mass_fraction = "SandF_River"
river_bottom-and-bank_gravel__mass_fraction = "GravelF_River"
river_bottom-and-bank_clay__d50_diameter = "dm_clay"
river_bottom-and-bank_silt__d50_diameter = "dm_silt"
river_bottom-and-bank_sand__d50_diameter = "dm_sand"
"river_bottom-and-bank_aggregates~small__d50_diameter" = "dm_sagg"
"river_bottom-and-bank_aggregates~large__d50_diameter" = "dm_lagg"
river_bottom-and-bank_gravel__d50_diameter = "dm_gravel"

river_water_clay__d50_diameter = "dm_clay"
river_water_silt__d50_diameter = "dm_silt"
river_water_sand__d50_diameter = "dm_sand"
"river_water_aggregates~small__d50_diameter" = "dm_sagg"
"river_water_aggregates~large__d50_diameter" = "dm_lagg"
river_water_gravel__d50_diameter = "dm_gravel"

# specify the internal IDs of the parameters which vary over time
# the external name mapping needs to be below together with the other mappings
[input.dynamic]
forcing = [
  "atmosphere_water__precipitation_volume_flux",
  "land_surface_water__depth",
  "river_water__depth",
  "land_surface_water__volume_flow_rate",
  "river_water__volume_flow_rate",
]

[model]
reinit = true
run_river_model = true
dolake = false
doreservoir = true # cannot use reservoirs as in sbm because then states/volume need to be added
rainfall_erosion = "answers" # Rainfall erosion equation: ["answers", "eurosem"]
overland_flow_erosion = "answers" # Overland flow erosion equation: ["answers"]
land_transport = "yalinpart" # Overland flow transport capacity method: ["yalinpart", "govers", "yalin"]
river_transport = "bagnold" # River flow transport capacity method: ["bagnold", "engelund", "yang", "kodatie", "molinas"]
type = "sediment"

[output]
path = "output-moselle-sed.nc"

[output.variables]
"soil_erosion~rainfall__mass_flow_rate" = "rainfall_erosion"
"soil_erosion~overland_flow__mass_flow_rate" = "overland_flow_erosion"
soil_erosion__mass_flow_rate = "soilloss"
soil_erosion_clay__mass_flow_rate = "erosclay"

land_surface_water_sediment_transport_capacity__mass_flow_rate = "TCsed"
land_surface_water_clay_transport_capacity__mass_flow_rate = "TCclay"

"land_surface_water_sediment~to-river__mass_flow_rate" = "inlandsed"
"land_surface_water_clay~to-river__mass_flow_rate" = "inlandclay"

land_surface_water_sediment__mass_flow_rate = "olsed"
land_surface_water_clay__mass_flow_rate = "olclay"

lateral.river.hydrological_forcing.waterlevel_river = "h_riv"
lateral.river.sediment_flux.boundary_conditions.erosion_land_clay = "inlandclayriv"
lateral.river.sediment_flux.boundary_conditions.transport_capacity =  "TCsed_riv"

river_water_sediment__mass_concentration = "Sedconc"
"river_water_sediment~suspended__mass_concentration" = "SSconc"
"river_water_sediment~bedload__mass_concentration" = "Bedconc"

river_water_sediment_deposition__mass = "deposition_riv"
river_water_sediment_erosion__mass = "erosion_riv"
river_water_clay__mass_flow_rate = "outclay"
river_water_clay__mass = "clayload"

[csv]
path = "output-moselle-sediment.csv"

[[csv.column]]
coordinate.x = 6.931
coordinate.y = 48.085
header = "SL"
parameter = "soil_erosion__mass_flow_rate"

[[csv.column]]
coordinate.x = 6.931
coordinate.y = 48.085
header = "SSPL"
parameter = "soil_erosion~rainfall__mass_flow_rate"

[[csv.column]]
coordinate.x = 6.931
coordinate.y = 48.085
header = "SOV"
parameter = "soil_erosion~overland_flow__mass_flow_rate"

[[csv.column]]
coordinate.x = 6.931
coordinate.y = 48.085
header = "P"
parameter = "atmosphere_water__precipitation_volume_flux"

[[csv.column]]
coordinate.x = 6.931
coordinate.y = 48.085
header = "ql"
parameter = "vertical.hydrological_forcing.q_land"

# [[csv.column]]
# coordinate.x = 6.931
# coordinate.y = 48.085
# header = "TCsed"
# parameter = "lateral.land.transport_capacity.variables.amount"

# [[csv.column]]
# coordinate.x = 6.931
# coordinate.y = 48.085
# header = "TCclay"
# parameter = "lateral.land.transport_capacity.variables.clay"

# [[csv.column]]
# coordinate.x = 6.931
# coordinate.y = 48.085
# header = "inlandsed"
# parameter = "lateral.land.to_river.variables.amount"

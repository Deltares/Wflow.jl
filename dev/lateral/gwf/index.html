<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Groundwater flow · Wflow.jl</title><link rel="canonical" href="https://deltares.github.io/Wflow.jl/lateral/gwf/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Wflow.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick-start/">Quick start</a></li><li><a class="tocitem" href="../../cli/">Command line interface</a></li><li><a class="tocitem" href="../../structure/">Model structure</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../model/sbm/">wflow_sbm</a></li><li><a class="tocitem" href="../../model/hbv/">wflow_hbv</a></li><li><a class="tocitem" href="../../model/sediment/">wflow_sediment</a></li></ul></li><li><span class="tocitem">Vertical components</span><ul><li><a class="tocitem" href="../../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../../vertical/process/">Vertical processes</a></li><li><a class="tocitem" href="../../vertical/sediment/">Soil Loss</a></li></ul></li><li><span class="tocitem">Lateral components</span><ul><li><a class="tocitem" href="../kinwave/">Kinematic wave</a></li><li class="is-active"><a class="tocitem" href>Groundwater flow</a><ul class="internal"><li><a class="tocitem" href="#Aquifer-types"><span>Aquifer types</span></a></li><li><a class="tocitem" href="#Connectivity"><span>Connectivity</span></a></li><li><a class="tocitem" href="#Constant-head"><span>Constant head</span></a></li><li><a class="tocitem" href="#Aquifer-boundary-conditions"><span>Aquifer boundary conditions</span></a></li></ul></li><li><a class="tocitem" href="../sediment/">Sediment Flux</a></li></ul></li><li><a class="tocitem" href="../../bmi/">Basic Model Interface</a></li><li><a class="tocitem" href="../../fews/">Run from Delft-FEWS</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lateral components</a></li><li class="is-active"><a href>Groundwater flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Groundwater flow</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/lateral/gwf.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Groundwater-flow"><a class="docs-heading-anchor" href="#Groundwater-flow">Groundwater flow</a><a id="Groundwater-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Groundwater-flow" title="Permalink"></a></h1><p>Single layer groundwater flow is defined in the <code>struct GroundwaterFlow</code>, which contains the following fields:</p><ul><li>aquifer</li><li>connectivity</li><li>constanthead</li><li>boundaries</li></ul><pre><code class="language-julia">Base.@kwdef struct GroundwaterFlow
    aquifer::A where A &lt;: Aquifer
    connectivity::Connectivity
    constanthead::ConstantHead
    boundaries::Vector{B} where B &lt;: AquiferBoundaryCondition
end</code></pre><p>The fields of <code>struct GroundwaterFlow</code> are described in more detail below.</p><h2 id="Aquifer-types"><a class="docs-heading-anchor" href="#Aquifer-types">Aquifer types</a><a id="Aquifer-types-1"></a><a class="docs-heading-anchor-permalink" href="#Aquifer-types" title="Permalink"></a></h2><p>Groundwater flow contains the <code>Abstract type</code> <code>Aquifer</code>, that can be either a confined (<code>ConfinedAquifer</code>) or unconfined (<code>UnconfinedAquifer</code>) aquifer. Groundwater flow is solved forward in time and central in space.</p><article class="docstring"><header><a class="docstring-binding" id="Wflow.Aquifer" href="#Wflow.Aquifer"><code>Wflow.Aquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Aquifer</code></pre><p>Abstract type representing an aquifer, either confined or unconfined.</p><p>The vertically averaged governing equation of an unconfined, inhomogeneous and isotropic aquifer in one dimension can be written as:</p><p>S * ∂ϕ / ∂t = ∂ / ∂x * (kH * ∂ϕ / ∂x) + Q</p><p>with:</p><ul><li>S: storativity (or storage coefficient)</li><li>ϕ: hydraulic head (groundwater level)</li><li>t: time</li><li>k: conductivity</li><li>H: H the (saturated) aquifer height: groundwater level - aquifer bottom elevation</li><li>η: elevation of aquifer bottom</li><li>Q: fluxes from boundary conditions (e.g. recharge or abstraction)</li></ul><p>The simplest finite difference formulation is forward in time, central in space, and can be written as:</p><p>Sᵢ * (ϕᵢᵗ⁺¹ - ϕᵢᵗ) / Δt = -Cᵢ₋₁ * (ϕᵢ₋₁ - ϕᵢ) -Cᵢ * (ϕᵢ₊₁ - ϕᵢ) + Qᵢ</p><p>with:</p><ul><li>ᵢ as cell index</li><li>ᵗ as time index</li><li>Δt as step size</li><li>Cᵢ₋₁ as the intercell conductance between cell i-1 and i</li><li>Cᵢ as the intercell conductance between cell i and i+1</li></ul><p>Conductance is defined as:</p><p>C = kH * w / l</p><p>with:</p><ul><li>w the width of the cell to cell connection</li><li>l the length of the cell to cell connection</li></ul><p>k and H may both vary in space; intercell conductance is therefore an average using the properties of two cells. See the documentation below.</p><p>There is only one unknown, ϕᵢᵗ⁺¹. Reshuffling terms: </p><p>ϕᵢᵗ⁺¹ = ϕᵢᵗ + (Cᵢ₋₁ * (ϕᵢ - ϕᵢ₋₁) + Cᵢ * (ϕᵢ₊₁ - ϕᵢ) + Qᵢ) * Δt / Sᵢ</p><p>This can be generalized to two dimensions, for both regular and irregular cell connectivity.</p><p>See this paper for more details:      Chu, W. S., &amp; Willis, R. (1984). An explicit finite difference model for      unconfined aquifers. Groundwater, 22(6), 728-734. </p><p>Boundary conditions can be classified into three categories:</p><ul><li>specified head (Dirichlet)</li><li>specified flux (Neumann)</li><li>head-dependent flux (Robin)</li></ul><p>Neumann and Robin conditions are implemented by adding to or subtracting from a net (lumped) cell flux. Dirichlet conditions are special cased, since they cannot (easily) be implemented via the flux, but the head is set directly instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/cbe4a9f71068d92455202fb81a7fac637a5d3264/src/groundwater/aquifer.jl#LL1-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.ConfinedAquifer" href="#Wflow.ConfinedAquifer"><code>Wflow.ConfinedAquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ConfinedAquifer{T} &lt;: Aquifer</code></pre><p>Confined aquifers are overlain by a poorly permeable confining layer (e.g. clay). No air can get in to fill the pore space so that the aquifer always remains fully saturated. For a confined aquifer, water will always flow along the complete height over the aquifer and transmissivity kH (m d⁻¹) is a constant.</p><p>Specific storage is the amount of water an aquifer releases per unit change in hydraulic head, per unit volume of aquifer, as the aquifer and the groundwater itself is compressed. Its value is much smaller than specific yield, between 1E-5 (stiff) and 0.01 (weak).</p><p>NOTA BENE: <strong>specific</strong> storage is per m of aquifer (conf. specific weight). <strong>Storativity</strong> or (<strong>storage coefficient</strong>) is for the entire aquifer (conf. transmissivity).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/base/#L0-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.UnconfinedAquifer" href="#Wflow.UnconfinedAquifer"><code>Wflow.UnconfinedAquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">UnconfinedAquifer{T} &lt;: Aquifer</code></pre><p>The upper boundary of an unconfined aquifer is the water table (the phreatic surface).</p><p>Specific yield (or drainable porosity) represents the volumetric fraction the aquifer will yield when all water drains and the pore volume is filled by air instead. Specific yield will vary roughly between 0.05 (clay) and 0.45 (peat) (Johnson, 1967).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/base/#L0-L10">source</a></section></article><h2 id="Connectivity"><a class="docs-heading-anchor" href="#Connectivity">Connectivity</a><a id="Connectivity-1"></a><a class="docs-heading-anchor-permalink" href="#Connectivity" title="Permalink"></a></h2><p>The connectivity between cells is defined as follows.</p><article class="docstring"><header><a class="docstring-binding" id="Wflow.Connectivity" href="#Wflow.Connectivity"><code>Wflow.Connectivity</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Connectivity{T}</code></pre><p>Stores connection data between cells. Connections are stored in a compressed sparse column (CSC) adjacency matrix: only non-zero values are stored. Primarily, this consist of two vectors:</p><ul><li>the row value vector holds the cell indices of neighbors</li><li>the column pointers marks the start and end index of the row value vector</li></ul><p>This matrix is square: n = m = ncell. nconnection is equal to nnz (the number of non-zero values).</p><ul><li>ncell: the number of (active) cells in the simulation</li><li>nconnection: the number of connections between cells</li><li>length1: for every connection, the length in the first cell, size nconnection</li><li>length2: for every connection, the length in the second cell, size nconnection</li><li>width: width for every connection, (approx.) perpendicular to length1 and length2, size nconnection</li><li>colptr: CSC column pointer (size ncell + 1)</li><li>rowval: CSC row value (size nconnection)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/cbe4a9f71068d92455202fb81a7fac637a5d3264/src/groundwater/connectivity.jl#LL1-L21">source</a></section></article><h2 id="Constant-head"><a class="docs-heading-anchor" href="#Constant-head">Constant head</a><a id="Constant-head-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-head" title="Permalink"></a></h2><p>Dirichlet boundary conditions can be specified through the field <code>constanthead</code>.</p><h2 id="Aquifer-boundary-conditions"><a class="docs-heading-anchor" href="#Aquifer-boundary-conditions">Aquifer boundary conditions</a><a id="Aquifer-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Aquifer-boundary-conditions" title="Permalink"></a></h2><h3 id="River"><a class="docs-heading-anchor" href="#River">River</a><a id="River-1"></a><a class="docs-heading-anchor-permalink" href="#River" title="Permalink"></a></h3><p>The flux between river and aquifer is calculated using Darcy&#39;s law following the approach in MODFLOW:</p><p class="math-container">\[    Q_{riv} =  \Bigg\lbrace{C_{i} \,\text{min}(h_{riv} - B_{riv}, h_{riv} - \phi), \,h_{riv} &gt; \phi \atop C_{e} (h_{riv} - \phi) , \,h_{riv} \leq \phi}\]</p><p>where <span>$Q_{riv}$</span> is the exchange flux from river to aquifer [L<span>$^3$</span> T<span>$^{-1}$</span>], <span>$C_i$</span> [L<span>$^2$</span> T<span>$^{-1}$</span>] is the river bed infiltration conductance, <span>$C_e$</span> [L<span>$^2$</span> T<span>$^{-1}$</span>] is the river bed exfiltration conductance, <span>$B_{riv}$</span> the bottom of the river bed [L], <span>$h_{riv}$</span> is the rive stage [L] and <span>$\phi$</span> is the hydraulic head in the river cell [L].</p><h3 id="Drainage"><a class="docs-heading-anchor" href="#Drainage">Drainage</a><a id="Drainage-1"></a><a class="docs-heading-anchor-permalink" href="#Drainage" title="Permalink"></a></h3><p>The flux from drains to the aquifer is calculated as follows:</p><p class="math-container">\[Q_{drain} = C_{drain} \text{min}(0, h_{drain} - \phi)\]</p><p>where <span>$Q_{drain}$</span> is the exchange flux from drains to aquifer [L<span>$^3$</span> T<span>$^{-1}$</span>], <span>$C_{drain}$</span> [L<span>$^2$</span> T<span>$^{-1}$</span>] is the drain conductance, <span>$h_{drain}$</span> is the drain elevation [L] and <span>$\phi$</span> is the hydraulic head in the cell with drainage [L].</p><h3 id="Recharge"><a class="docs-heading-anchor" href="#Recharge">Recharge</a><a id="Recharge-1"></a><a class="docs-heading-anchor-permalink" href="#Recharge" title="Permalink"></a></h3><p>The recharge flux <span>$Q_{r}$</span> to the aquifer is calculated as follows:</p><p class="math-container">\[Q_{r} = R \, A\]</p><p>with <span>$R$</span> the recharge rate [L T<span>$^{-1}$</span>] and <span>$A$</span> the area [L<span>$^2$</span> ] of the aquifer cell.</p><h3 id="Head-boundary"><a class="docs-heading-anchor" href="#Head-boundary">Head boundary</a><a id="Head-boundary-1"></a><a class="docs-heading-anchor-permalink" href="#Head-boundary" title="Permalink"></a></h3><p>This boundary is a fixed head with time outside of the model domain, and is generally used to avoid an unnecessary extension of the model domain to the location of the fixed boundary. The flux from the boundary <span>$Q_{hb}$</span> [L<span>$^3$</span> T<span>$^{-1}$</span>] is calculated as follows:</p><p class="math-container">\[Q_{hb} = C_{hb} (\phi_{hb} - \phi)\]</p><p>with <span>$C_{hb}$</span> the conductance of the head boundary [L<span>$^2$</span> T<span>$^{-1}$</span>], <span>$\phi_{hb}$</span> the head [L] of the head boundary and  <span>$\phi$</span> the head of the aquifer cell.</p><h3 id="Well-boundary"><a class="docs-heading-anchor" href="#Well-boundary">Well boundary</a><a id="Well-boundary-1"></a><a class="docs-heading-anchor-permalink" href="#Well-boundary" title="Permalink"></a></h3><p>A volumetric well rate [L<span>$^3$</span> T<span>$^{-1}$</span>] can be specified as a boundary condition.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For an unconfined aquifer the boundary fluxes are checked, in case of a dry aquifer cell a negative flux is not allowed.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kinwave/">« Kinematic wave</a><a class="docs-footer-nextpage" href="../sediment/">Sediment Flux »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 11 March 2021 17:00">Thursday 11 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

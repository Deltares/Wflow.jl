<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Wflow.jl</title><link rel="canonical" href="https://deltares.github.io/Wflow.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Wflow.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Wflow"><a class="docs-heading-anchor" href="#Wflow">Wflow</a><a id="Wflow-1"></a><a class="docs-heading-anchor-permalink" href="#Wflow" title="Permalink"></a></h1><p>This is an in development version of wflow, a continuation of the work available <a href="https://github.com/openstreams/wflow">here</a>. For now using this for any real calculations is not advised, please use the linked stable wflow release for that.   </p><ul><li><a href="#Wflow.pcrdir"><code>Wflow.pcrdir</code></a></li><li><a href="#Wflow.Aquifer"><code>Wflow.Aquifer</code></a></li><li><a href="#Wflow.Config"><code>Wflow.Config</code></a></li><li><a href="#Wflow.ConfinedAquifer"><code>Wflow.ConfinedAquifer</code></a></li><li><a href="#Wflow.Connectivity"><code>Wflow.Connectivity</code></a></li><li><a href="#Wflow.UnconfinedAquifer"><code>Wflow.UnconfinedAquifer</code></a></li><li><a href="#Wflow.accucapacityflux-Tuple{Any,Any,Any}"><code>Wflow.accucapacityflux</code></a></li><li><a href="#Wflow.active_indices-Tuple{AbstractArray{T,2} where T,Any}"><code>Wflow.active_indices</code></a></li><li><a href="#Wflow.acttransp_unsat_sbm"><code>Wflow.acttransp_unsat_sbm</code></a></li><li><a href="#Wflow.add_time-Tuple{Any,Any}"><code>Wflow.add_time</code></a></li><li><a href="#Wflow.close_files-Tuple{Any}"><code>Wflow.close_files</code></a></li><li><a href="#Wflow.conductance-Tuple{Wflow.UnconfinedAquifer,Any,Any,Any}"><code>Wflow.conductance</code></a></li><li><a href="#Wflow.connection_geometry-NTuple{4,Any}"><code>Wflow.connection_geometry</code></a></li><li><a href="#Wflow.connections-Tuple{Wflow.Connectivity,Int64}"><code>Wflow.connections</code></a></li><li><a href="#Wflow.csv_header-Tuple{Any,Any,Any}"><code>Wflow.csv_header</code></a></li><li><a href="#Wflow.detdrainlength-Tuple{Any,Any,Any}"><code>Wflow.detdrainlength</code></a></li><li><a href="#Wflow.detdrainwidth-Tuple{Any,Any,Any}"><code>Wflow.detdrainwidth</code></a></li><li><a href="#Wflow.equal_size_vectors-Tuple{Any}"><code>Wflow.equal_size_vectors</code></a></li><li><a href="#Wflow.flat!-Tuple{Any,Any,Dict}"><code>Wflow.flat!</code></a></li><li><a href="#Wflow.flowgraph-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T,AbstractArray{T,1} where T}"><code>Wflow.flowgraph</code></a></li><li><a href="#Wflow.fraction_runoff_toriver-NTuple{5,Any}"><code>Wflow.fraction_runoff_toriver</code></a></li><li><a href="#Wflow.get_at!-Tuple{Any,NCDatasets.CFVariable,AbstractArray{var&quot;#s13&quot;,1} where var&quot;#s13&quot;&lt;:Dates.TimeType,Dates.TimeType}"><code>Wflow.get_at!</code></a></li><li><a href="#Wflow.glacier_hbv-NTuple{8,Any}"><code>Wflow.glacier_hbv</code></a></li><li><a href="#Wflow.harmonicmean_conductance-NTuple{7,Any}"><code>Wflow.harmonicmean_conductance</code></a></li><li><a href="#Wflow.horizontal_conductance-Union{Tuple{A}, Tuple{Int64,Int64,Int64,A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer"><code>Wflow.horizontal_conductance</code></a></li><li><a href="#Wflow.infiltration-Tuple{Any,Any,Any,Any,Any,Any,Any,Bool,Bool}"><code>Wflow.infiltration</code></a></li><li><a href="#Wflow.initialize_conductance!-Union{Tuple{A}, Tuple{A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer"><code>Wflow.initialize_conductance!</code></a></li><li><a href="#Wflow.initialize_hbv_model-Tuple{Wflow.Config}"><code>Wflow.initialize_hbv_model</code></a></li><li><a href="#Wflow.initialize_sbm_gwf_model-Tuple{Wflow.Config}"><code>Wflow.initialize_sbm_gwf_model</code></a></li><li><a href="#Wflow.initialize_sbm_model-Tuple{Wflow.Config}"><code>Wflow.initialize_sbm_model</code></a></li><li><a href="#Wflow.initialize_storage-NTuple{4,Any}"><code>Wflow.initialize_storage</code></a></li><li><a href="#Wflow.kin_wave!-NTuple{9,Any}"><code>Wflow.kin_wave!</code></a></li><li><a href="#Wflow.kinematic_wave-NTuple{7,Any}"><code>Wflow.kinematic_wave</code></a></li><li><a href="#Wflow.kinematic_wave_ssf-NTuple{13,Any}"><code>Wflow.kinematic_wave_ssf</code></a></li><li><a href="#Wflow.monthday_passed-Tuple{Any,Any}"><code>Wflow.monthday_passed</code></a></li><li><a href="#Wflow.ncnames-Tuple{Any}"><code>Wflow.ncnames</code></a></li><li><a href="#Wflow.ncread-Tuple{Any,Any}"><code>Wflow.ncread</code></a></li><li><a href="#Wflow.out_map-Tuple{Any,Any}"><code>Wflow.out_map</code></a></li><li><a href="#Wflow.param-Tuple{Any,Any}"><code>Wflow.param</code></a></li><li><a href="#Wflow.pow-Tuple{Any,Any}"><code>Wflow.pow</code></a></li><li><a href="#Wflow.rainfall_interception_gash-NTuple{5,Any}"><code>Wflow.rainfall_interception_gash</code></a></li><li><a href="#Wflow.rainfall_interception_modrut-NTuple{5,Any}"><code>Wflow.rainfall_interception_modrut</code></a></li><li><a href="#Wflow.reducer-NTuple{7,Any}"><code>Wflow.reducer</code></a></li><li><a href="#Wflow.reducerfunction-Tuple{AbstractString}"><code>Wflow.reducerfunction</code></a></li><li><a href="#Wflow.run_simulation-Tuple{Any}"><code>Wflow.run_simulation</code></a></li><li><a href="#Wflow.scurve-Tuple{Any}"><code>Wflow.scurve</code></a></li><li><a href="#Wflow.set_layerthickness-Tuple{Float64,StaticArrays.SArray{Tuple{S},T,1,S} where T where S,StaticArrays.SArray{Tuple{S},T,1,S} where T where S}"><code>Wflow.set_layerthickness</code></a></li><li><a href="#Wflow.set_states-Tuple{Any,Any,Any}"><code>Wflow.set_states</code></a></li><li><a href="#Wflow.setup_netcdf-NTuple{8,Any}"><code>Wflow.setup_netcdf</code></a></li><li><a href="#Wflow.snowpack_hbv-NTuple{9,Any}"><code>Wflow.snowpack_hbv</code></a></li><li><a href="#Wflow.stable_timestep-Tuple{Any}"><code>Wflow.stable_timestep</code></a></li><li><a href="#Wflow.statevars"><code>Wflow.statevars</code></a></li><li><a href="#Wflow.sum_at-Tuple{Any,Any}"><code>Wflow.sum_at</code></a></li><li><a href="#Wflow.symbols-Tuple{Any}"><code>Wflow.symbols</code></a></li><li><a href="#Wflow.timecycles-Tuple{Any}"><code>Wflow.timecycles</code></a></li><li><a href="#Wflow.tosecond-Tuple{Dates.Hour}"><code>Wflow.tosecond</code></a></li><li><a href="#Wflow.unsatzone_flow_layer-NTuple{4,Any}"><code>Wflow.unsatzone_flow_layer</code></a></li><li><a href="#Wflow.unsatzone_flow_sbm-NTuple{7,Any}"><code>Wflow.unsatzone_flow_sbm</code></a></li><li><a href="#Wflow.update-Tuple{Wflow.NaturalLake,Any,Any,Any,Any}"><code>Wflow.update</code></a></li><li><a href="#Wflow.update-Union{Tuple{Wflow.Model{N,L,V,R,W}}, Tuple{W}, Tuple{R}, Tuple{V}, Tuple{L}, Tuple{N}} where W where R where V&lt;:Wflow.SBM where L where N"><code>Wflow.update</code></a></li><li><a href="#Wflow.update-Tuple{Wflow.SimpleReservoir,Any,Any,Any}"><code>Wflow.update</code></a></li><li><a href="#Wflow.update_cyclic!-Tuple{Any}"><code>Wflow.update_cyclic!</code></a></li><li><a href="#Wflow.update_forcing!-Tuple{Any}"><code>Wflow.update_forcing!</code></a></li><li><a href="#Wflow.update_sbm_gwf-Tuple{Any}"><code>Wflow.update_sbm_gwf</code></a></li><li><a href="#Wflow.write_netcdf_timestep-Tuple{Any,Any,Any}"><code>Wflow.write_netcdf_timestep</code></a></li><li><a href="#Wflow.write_output-Tuple{Any}"><code>Wflow.write_output</code></a></li><li><a href="#Wflow.@symbols_str-Tuple{Any}"><code>Wflow.@symbols_str</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Wflow.pcrdir" href="#Wflow.pcrdir"><code>Wflow.pcrdir</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>Map from PCRaster LDD value to a CartesianIndex</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL2">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.Aquifer" href="#Wflow.Aquifer"><code>Wflow.Aquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Aquifer</code></pre><p>Abstract type representing an aquifer, either confined or unconfined.</p><p>The vertically averaged governing equation of an unconfined, inhomogeneous and isotropic aquifer in one dimension can be written as:</p><p>S * ∂ϕ / ∂t = ∂ / ∂x * (kH * ∂ϕ / ∂x) + Q</p><p>with:</p><ul><li>S: storativity (or storage coefficient)</li><li>ϕ: hydraulic head (groundwater level)</li><li>t: time</li><li>k: conductivity</li><li>H: H the (saturated) aquifer height: groundwater level - aquifer bottom elevation</li><li>η: elevation of aquifer bottom</li><li>Q: fluxes from boundary conditions (e.g. recharge or abstraction)</li></ul><p>The simplest finite difference formulation is forward in time, central in space, and can be written as:</p><p>Sᵢ * (ϕᵢᵗ⁺¹ - ϕᵢᵗ) / Δt = -Cᵢ₋₁ * (ϕᵢ₋₁ - ϕᵢ) -Cᵢ * (ϕᵢ₊₁ - ϕᵢ) + Qᵢ</p><p>with:</p><ul><li>ᵢ as cell index</li><li>ᵗ as time index</li><li>Δt as step size</li><li>Cᵢ₋₁ as the intercell conductance between cell i-1 and i</li><li>Cᵢ as the intercell conductance between cell i and i+1</li></ul><p>Conductance is defined as:</p><p>C = kH * w / l</p><p>with:</p><ul><li>w the width of the cell to cell connection</li><li>l the length of the cell to cell connection</li></ul><p>k and H may both vary in space; intercell conductance is therefore an average using the properties of two cells. See the documentation below.</p><p>There is only one unknown, ϕᵢᵗ⁺¹. Reshuffling terms: </p><p>ϕᵢᵗ⁺¹ = ϕᵢᵗ + (Cᵢ₋₁ * (ϕᵢ - ϕᵢ₋₁) + Cᵢ * (ϕᵢ₊₁ - ϕᵢ) + Qᵢ) * Δt / Sᵢ</p><p>This can be generalized to two dimensions, for both regular and irregular cell connectivity.</p><p>See this paper for more details:      Chu, W. S., &amp; Willis, R. (1984). An explicit finite difference model for      unconfined aquifers. Groundwater, 22(6), 728-734. </p><p>Boundary conditions can be classified into three categories:</p><ul><li>specified head (Dirichlet)</li><li>specified flux (Neumann)</li><li>head-dependent flux (Robin)</li></ul><p>Neumann and Robin conditions are implemented by adding to or subtracting from a net (lumped) cell flux. Dirichlet conditions are special cased, since they cannot (easily) be implemented via the flux, but the head is set directly instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL1-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.Config" href="#Wflow.Config"><code>Wflow.Config</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parsed TOML configuration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.ConfinedAquifer" href="#Wflow.ConfinedAquifer"><code>Wflow.ConfinedAquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ConfinedAquifer{T} &lt;: Aquifer</code></pre><p>Confined aquifers are overlain by a poorly permeable confining layer (e.g. clay). No air can get in to fill the pore space so that the aquifer always remains fully saturated. For a confined aquifer, water will always flow along the complete height over the aquifer and transmissivity kH (m d⁻¹) is a constant.</p><p>Specific storage is the amount of water an aquifer releases per unit change in hydraulic head, per unit volume of aquifer, as the aquifer and the groundwater itself is compressed. Its value is much smaller than specific yield, between 1E-5 (stiff) and 0.01 (weak).</p><p>NOTA BENE: <strong>specific</strong> storage is per m of aquifer (conf. specific weight). <strong>Storativity</strong> or (<strong>storage coefficient</strong>) is for the entire aquifer (conf. transmissivity).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL71-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.Connectivity" href="#Wflow.Connectivity"><code>Wflow.Connectivity</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Connectivity{T}</code></pre><p>Stores connection data between cells. Connections are stored in a compressed sparse column (CSC) adjacency matrix: only non-zero values are stored. Primarily, this consist of two vectors:</p><ul><li>the row value vector holds the cell indices of neighbors</li><li>the column pointers marks the start and end index of the row value vector</li></ul><p>This matrix is square: n = m = ncell. nconnection is equal to nnz (the number of non-zero values).</p><ul><li>ncell: the number of (active) cells in the simulation</li><li>nconnection: the number of connections between cells</li><li>length1: for every connection, the length in the first cell, size nconnection</li><li>length2: for every connection, the length in the second cell, size nconnection</li><li>width: width for every connection, (approx.) perpendicular to length1 and length2, size nconnection</li><li>colptr: CSC column pointer (size ncell + 1)</li><li>rowval: CSC row value (size nconnection)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/connectivity.jl#LL1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.UnconfinedAquifer" href="#Wflow.UnconfinedAquifer"><code>Wflow.UnconfinedAquifer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">UnconfinedAquifer{T} &lt;: Aquifer</code></pre><p>The upper boundary of an unconfined aquifer is the water table (the phreatic surface).</p><p>Specific yield (or drainable porosity) represents the volumetric fraction the aquifer will yield when all water drains and the pore volume is filled by air instead. Specific yield will vary roughly between 0.05 (clay) and 0.45 (peat) (Johnson, 1967).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL101-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.accucapacityflux-Tuple{Any,Any,Any}" href="#Wflow.accucapacityflux-Tuple{Any,Any,Any}"><code>Wflow.accucapacityflux</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Transport of material downstream with a limited transport capacity over a directed graph</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/horizontal_process.jl#LL141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.active_indices-Tuple{AbstractArray{T,2} where T,Any}" href="#Wflow.active_indices-Tuple{AbstractArray{T,2} where T,Any}"><code>Wflow.active_indices</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">active_indices(subcatch_2d, nodata)</code></pre><p>Takes a 2D array of the subcatchments. And derive forward and reverse indices.</p><p>1: Get a list of <code>CartesianIndex{2}</code>` that are active, based on a nodata value. These map from the 1D internal domain to the 2D external domain.</p><p>2: Make a reverse index, a <code>Matrix{Int}</code>`, which maps from the 2D external domain to the 1D internal domain, providing an Int which can be used as a linear index. Values of 0 represent inactive cells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL23-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.acttransp_unsat_sbm" href="#Wflow.acttransp_unsat_sbm"><code>Wflow.acttransp_unsat_sbm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">acttransp_unsat_sbm(rootingdepth, ustorelayerdepth, sumlayer, restpotevap, sum_actevapustore, c, usl, θₛ, θᵣ, hb, ust::Bool = false)</code></pre><p>Compute actual transpiration for unsaturated zone. If <code>ust</code> is <code>true</code>, the whole unsaturated store is available for transpiration.</p><p><strong>Arguments</strong></p><ul><li><code>rootingdepth</code></li><li><code>ustorelayerdepth</code></li><li><code>sumlayer</code> (depth (z) of upper boundary unsaturated layer)</li><li><code>restpotevap</code> (remaining evaporation)</li><li><code>sum_actevapustore</code> (cumulative actual transpiration (more than one unsaturated layers))</li><li><code>c</code> (Brooks-Corey coefficient)</li><li><code>usl</code> (thickness of unsaturated zone)</li><li><code>θₛ</code></li><li><code>θᵣ</code></li><li><code>hb</code> (air entry pressure)</li><li><code>ust</code></li></ul><p><strong>Output</strong></p><ul><li><code>ustorelayerdepth</code></li><li><code>sum_actevapustore</code></li><li><code>restpotevap</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL121-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.add_time-Tuple{Any,Any}" href="#Wflow.add_time-Tuple{Any,Any}"><code>Wflow.add_time</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Add a new time to the unlimited time dimension, and return the index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL324">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.close_files-Tuple{Any}" href="#Wflow.close_files-Tuple{Any}"><code>Wflow.close_files</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Close input and output datasets that are opened on model initialization</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL740">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.conductance-Tuple{Wflow.UnconfinedAquifer,Any,Any,Any}" href="#Wflow.conductance-Tuple{Wflow.UnconfinedAquifer,Any,Any,Any}"><code>Wflow.conductance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">conductance(aquifer::UnconfinedAquifer, connectivity::Connectivity)</code></pre><p>This computes the conductance for an unconfined aquifer using the &quot;upstream saturated fraction&quot; as the MODFLOW documentation calls it. In this approach, the saturated thickness of a cell-to-cell is approximated using the cell with the highest head. This results in a consistent overestimation of the saturated thickness, but it avoids complexities related with cell drying and rewetting, such as having to define a &quot;wetting threshold&quot; or a &quot;wetting factor&quot;.</p><p>See the documentation for MODFLOW-NWT or MODFLOW6 for more background: Niswonger, R.G., Panday, Sorab, and Ibaraki, Motomu, 2011, MODFLOW-NWT, A Newton formulation for MODFLOW-2005: U.S. Geological Survey Techniques and Methods 6-A37, 44 p.</p><p>Langevin, C.D., Hughes, J.D., Banta, E.R., Niswonger, R.G., Panday, Sorab, and Provost, A.M., 2017, Documentation for the MODFLOW 6 Groundwater Flow Model: U.S. Geological Survey Techniques and Methods, book 6, chap. A55, 197 p., https://doi.org/10.3133/tm6A55.</p><p>For background on drying and rewetting, see: McDonald, M.G., Harbaugh, A.W., Orr, B.R., and Ackerman, D.J., 1991, A method of converting no-flow cells to variable-head cells for the U.S. Geological Survey modular finite-difference groundwater flow model: U.S. Geological Survey Open-File Report 91-536, 99 p</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL210-L235">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.connection_geometry-NTuple{4,Any}" href="#Wflow.connection_geometry-NTuple{4,Any}"><code>Wflow.connection_geometry</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">connection_geometry(I, J, Δx, Δy)</code></pre><p>Compute geometrical properties of connections for structured input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/connectivity.jl#LL41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.connections-Tuple{Wflow.Connectivity,Int64}" href="#Wflow.connections-Tuple{Wflow.Connectivity,Int64}"><code>Wflow.connections</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">connections(C::Connectivity, id::Int)</code></pre><p>Returns connections for a single cell, identified by <span>$id$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/connectivity.jl#LL33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.csv_header-Tuple{Any,Any,Any}" href="#Wflow.csv_header-Tuple{Any,Any,Any}"><code>Wflow.csv_header</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get a Vector{String} of all columns names for the CSV header, exept the first, time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL438">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.detdrainlength-Tuple{Any,Any,Any}" href="#Wflow.detdrainlength-Tuple{Any,Any,Any}"><code>Wflow.detdrainlength</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">detdrainlength(ldd, xl, yl)</code></pre><p>Determines the drainaige length for a non square grid. Input <code>ldd</code> (drainage network), <code>xl</code> (length of cells in x direction), <code>yl</code> (length of cells in y direction). Output is drainage length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL230-L235">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.detdrainwidth-Tuple{Any,Any,Any}" href="#Wflow.detdrainwidth-Tuple{Any,Any,Any}"><code>Wflow.detdrainwidth</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">detdrainwidth(ldd, xl, yl)</code></pre><p>Determines the drainaige width for a non square grid. Input <code>ldd</code> (drainage network), <code>xl</code> (length of cells in x direction), <code>yl</code> (length of cells in y direction). Output is drainage width.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL249-L254">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.equal_size_vectors-Tuple{Any}" href="#Wflow.equal_size_vectors-Tuple{Any}"><code>Wflow.equal_size_vectors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">equal_size_vectors(x)</code></pre><p>Used in the structs of arrays to ensure all vectors are of equal length.</p><p><code>equal_size_vectors(([1,2], [1,2,3]))</code> would throw an ArgumentError. <code>equal_size_vectors(([4,5], [4,5]))</code> would pass. <code>equal_size_vectors((1, [4,5], [4,5]))</code> would also pass, since <code>1</code> is not an AbstractVector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL308-L316">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.flat!-Tuple{Any,Any,Dict}" href="#Wflow.flat!-Tuple{Any,Any,Dict}"><code>Wflow.flat!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Flatten a nested dictionary, keeping track of the full address of the keys. Useful for converting TOML of the format:</p><pre><code class="language-none">[a.b]
field_of_b = &quot;name_in_output&quot;

[a.d.c]
field_of_c = &quot;other_name_in_output&quot;</code></pre><p>to a non-nested format:</p><p>Dict(     symbols&quot;a.b.field<em>of</em>b&quot; =&gt; &quot;name<em>in</em>output,     symbols&quot;a.d.c.field<em>of</em>c&quot; =&gt; &quot;other<em>name</em>in_output, )</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL465-L481">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.flowgraph-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T,AbstractArray{T,1} where T}" href="#Wflow.flowgraph-Tuple{AbstractArray{T,1} where T,AbstractArray{T,1} where T,AbstractArray{T,1} where T}"><code>Wflow.flowgraph</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Convert a gridded drainage direction to a directed graph</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/horizontal_process.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.fraction_runoff_toriver-NTuple{5,Any}" href="#Wflow.fraction_runoff_toriver-NTuple{5,Any}"><code>Wflow.fraction_runoff_toriver</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fraction_runoff_toriver(graph, ldd, index_river, slope, n)</code></pre><p>Determine ratio <code>frac</code> between <code>slope</code> river cell <code>index_river</code> and <code>slope</code> of each upstream neighbor (based on directed acyclic graph <code>graph</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL289-L294">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.get_at!-Tuple{Any,NCDatasets.CFVariable,AbstractArray{var&quot;#s13&quot;,1} where var&quot;#s13&quot;&lt;:Dates.TimeType,Dates.TimeType}" href="#Wflow.get_at!-Tuple{Any,NCDatasets.CFVariable,AbstractArray{var&quot;#s13&quot;,1} where var&quot;#s13&quot;&lt;:Dates.TimeType,Dates.TimeType}"><code>Wflow.get_at!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Extract a NetCDF variable at a given time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.glacier_hbv-NTuple{8,Any}" href="#Wflow.glacier_hbv-NTuple{8,Any}"><code>Wflow.glacier_hbv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">glacier_hbv(glacierfrac, glacierstore, snow, temperature, tt, cfmax, g_sifrac, Δt)</code></pre><p>HBV-light type of glacier modelling. First, a fraction of the snowpack is converted into ice using the HBV-light model (fraction between 0.001-0.005 per day). Glacier melting is modelled using a temperature degree factor and only occurs if the snow cover &lt; 10 mm.</p><p><strong>Arguments</strong></p><ul><li><code>glacierFrac</code> fraction covered by glaciers [-]</li><li><code>glacierstore</code> volume of the glacier [mm] w.e.</li><li><code>snow</code> snow pack on top of glacier [mm]</li><li><code>temperature</code> air temperature [°C]</li><li><code>tt</code> temperature threshold for ice melting [°C]</li><li><code>cfmax</code> ice degree-day factor in [mm/(°C/day)]</li><li><code>g_sifrac</code> fraction of the snow turned into ice [-]</li><li><code>Δt</code> model timestep [s]</li></ul><p><strong>Output</strong></p><ul><li><code>snow</code></li><li><code>snow2glacier</code></li><li><code>glacierstore</code></li><li><code>glaciermelt</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL390-L415">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.harmonicmean_conductance-NTuple{7,Any}" href="#Wflow.harmonicmean_conductance-NTuple{7,Any}"><code>Wflow.harmonicmean_conductance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">harmonicmean_conductance(k1, k2, H1, H2, l1, l2, width)</code></pre><p>The harmonic mean is the exact interblock transmissivity for steady-state one-dimensional flow with no recharge if the transmissivity is assumed to be spatially uniform over each finite difference block, changing abruptly at the block interface. </p><p>Refer to:</p><pre><code class="language-none">Goode, D. J., &amp; Appel, C. A. (1992). Finite-Difference Interblock Transmissivity
for Unconﬁned Aquifers and for Aquifers having Smoothly Varying Transmissivity.
Water-resources investigations report, 92, 4124.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL128-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.horizontal_conductance-Union{Tuple{A}, Tuple{Int64,Int64,Int64,A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer" href="#Wflow.horizontal_conductance-Union{Tuple{A}, Tuple{Int64,Int64,Int64,A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer"><code>Wflow.horizontal_conductance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">horizontal_conductance(i, j, nzi, aquifer, C)</code></pre><p>Compute fully saturated horizontal conductance for a single connection between two cells (indexed with <code>i</code> and <code>j</code>). Geometry characteristics are taken from the connectivity struct <code>C</code>, using the non-zero index (nzi) of its CSC data structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL162-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.infiltration-Tuple{Any,Any,Any,Any,Any,Any,Any,Bool,Bool}" href="#Wflow.infiltration-Tuple{Any,Any,Any,Any,Any,Any,Any,Bool,Bool}"><code>Wflow.infiltration</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">infiltration(avail_forinfilt, pathfrac, cf_soil, tsoil, infiltcapsoil, infiltcappath, ustorecapacity, modelsnow::Bool, soilinfreduction::Bool)</code></pre><p>Soil infiltration based on infiltration capacity soil <code>infiltcapsoil</code>, infiltration capacity compacted area <code>infiltcappath</code> and capacity unsatured zone <code>ustorecapacity</code>. The soil infiltration capacity can be adjusted in case the soil is frozen (<code>modelsnow</code> and <code>soilinfreduction</code> is <code>true</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL214-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.initialize_conductance!-Union{Tuple{A}, Tuple{A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer" href="#Wflow.initialize_conductance!-Union{Tuple{A}, Tuple{A,Wflow.Connectivity}} where A&lt;:Wflow.Aquifer"><code>Wflow.initialize_conductance!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_conductance!(aquifer::A, connectivity::Connectivity) where A &lt;: Aquifer</code></pre><p>Conductance for a confined aquifer is constant, and only has to be set once. For an unconfined aquifer, conductance is computed per timestep by multiplying by degree of saturation [0.0 - 1.0].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL187-L193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.initialize_hbv_model-Tuple{Wflow.Config}" href="#Wflow.initialize_hbv_model-Tuple{Wflow.Config}"><code>Wflow.initialize_hbv_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_hbv_model(config::Config)</code></pre><p>Initial part of the SBM model concept. Reads the input settings and data as defined in the Config object. Will return a Model that is ready to run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/hbv_model.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.initialize_sbm_gwf_model-Tuple{Wflow.Config}" href="#Wflow.initialize_sbm_gwf_model-Tuple{Wflow.Config}"><code>Wflow.initialize_sbm_gwf_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_sbm_gwf_model(config::Config)</code></pre><p>Initial part of the sbm_gwf model concept. The model contains:     - the vertical SBM concept     - the following lateral components:         - 1-D kinematic wave for river flow         - 1-D kinematic wave for overland flow         - unconfined aquifer with groundwater flow in four directions (adjacent cells)</p><p>The unconfined aquifer contains a recharge, river and a drain (optional) boundary. </p><p>The initial part reads the input settings and data as defined in the Config object.  Will return a Model that is ready to run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/sbm_gwf_model.jl#LL1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.initialize_sbm_model-Tuple{Wflow.Config}" href="#Wflow.initialize_sbm_model-Tuple{Wflow.Config}"><code>Wflow.initialize_sbm_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_sbm_model(config::Config)</code></pre><p>Initial part of the SBM model concept. Reads the input settings and data as defined in the Config object. Will return a Model that is ready to run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/sbm_model.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.initialize_storage-NTuple{4,Any}" href="#Wflow.initialize_storage-NTuple{4,Any}"><code>Wflow.initialize_storage</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Determine the initial storage depending on the storage function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/reservoir_lake.jl#LL345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.kin_wave!-NTuple{9,Any}" href="#Wflow.kin_wave!-NTuple{9,Any}"><code>Wflow.kin_wave!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Kinematic wave flow rate over the whole network for a single timestep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/horizontal_process.jl#LL57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.kinematic_wave-NTuple{7,Any}" href="#Wflow.kinematic_wave-NTuple{7,Any}"><code>Wflow.kinematic_wave</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Kinematic wave flow rate for a single cell and timestep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/horizontal_process.jl#LL22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.kinematic_wave_ssf-NTuple{13,Any}" href="#Wflow.kinematic_wave_ssf-NTuple{13,Any}"><code>Wflow.kinematic_wave_ssf</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Kinematic wave for lateral subsurface flow for a single cell and timestep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/horizontal_process.jl#LL67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.monthday_passed-Tuple{Any,Any}" href="#Wflow.monthday_passed-Tuple{Any,Any}"><code>Wflow.monthday_passed</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">monthday_passed(curr, avail)</code></pre><p>Given two monthday tuples such as (12, 31) and (12, 15), return true if the first argument falls after or on the same day as the second argument, assuming the same year. The tuples generally come from <code>Dates.monthday</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; monthday_passed((12, 31), (12, 15))
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL158-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.ncnames-Tuple{Any}" href="#Wflow.ncnames-Tuple{Any}"><code>Wflow.ncnames</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">ncnames(dict)</code></pre><p>Create a flat mapping from internal parameter locations to NetCDF variable names.</p><p>Ignores top level values in the Dict. This function is used to convert a TOML such as:</p><pre><code class="language-toml">[output]
path = &quot;path/to/file.nc&quot;

[output.vertical]
canopystorage = &quot;my_canopystorage&quot;

[output.lateral.river]
q = &quot;my_q&quot;</code></pre><p>To a dictionary of the flattened parameter locations and NetCDF names. The top level values are ignored since the output path is not a NetCDF name.</p><pre><code class="language-julia">Dict(
    (:vertical, :canopystorage) =&gt; &quot;my_canopystorage,
    (:lateral, :river, :q) =&gt; &quot;my_q,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL495-L522">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.ncread-Tuple{Any,Any}" href="#Wflow.ncread-Tuple{Any,Any}"><code>Wflow.ncread</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">ncread(nc, var; &lt;keyword arguments&gt;)</code></pre><p>Read parameter <code>var</code> from NetCDF file <code>nc</code>. Supports various keyword arguments to get selections of data in desired types, with or without missing values.</p><p><strong>Arguments</strong></p><ul><li><code>key=identity</code>: <code>key</code> is a function which maps <code>var</code> to the name of the parameter in the       NetCDF file. The default <code>identity</code> keeps <code>var</code> as is.</li><li><code>sel=nothing</code>: a selection of indices, such as a <code>Vector{CartesianIndex}</code> of active cells,       to return from the NetCDF. By default all cells are returned.</li><li><code>defaults=nothing</code>: a dictionary in which default values are looked up if <code>var</code> is not       in <code>nc</code>. By default it gives an error in this case.</li><li><code>type=nothing</code>: type to convert data to after reading. By default no conversion is done.</li><li><code>allow_missing=false</code>: Missing values within <code>sel</code> is not allowed by default. Set to       <code>true</code> to allow missing values.</li><li><code>fill=nothing</code>: Missing values are replaced by this fill value if <code>allow_missing</code> is <code>false</code>.</li><li><code>dimname</code> : name of third dimension of parameter <code>var</code>. By default no third dimension is expected.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL131-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.out_map-Tuple{Any,Any}" href="#Wflow.out_map-Tuple{Any,Any}"><code>Wflow.out_map</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">out_map(ncnames_dict, modelmap)</code></pre><p>Create a Dict that maps parameter NetCDF names to arrays in the Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL533-L537">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.param-Tuple{Any,Any}" href="#Wflow.param-Tuple{Any,Any}"><code>Wflow.param</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get a nested field using a tuple of Symbols</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.pow-Tuple{Any,Any}" href="#Wflow.pow-Tuple{Any,Any}"><code>Wflow.pow</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Faster method for exponentiation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL270">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.rainfall_interception_gash-NTuple{5,Any}" href="#Wflow.rainfall_interception_gash-NTuple{5,Any}"><code>Wflow.rainfall_interception_gash</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">rainfall_interception_gash(cmax, e_r, canopygapfraction, precipitation, canopystorage;maxevap = 9999.0)</code></pre><p>Interception according to the Gash model (for daily timesteps). <code>cmax</code> is the maximum canopy storage and <code>e_r</code> is the ratio of the average evaporation from the wet canopy and the average precipitation intensity on a saturated canopy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL18-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.rainfall_interception_modrut-NTuple{5,Any}" href="#Wflow.rainfall_interception_modrut-NTuple{5,Any}"><code>Wflow.rainfall_interception_modrut</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">rainfall_interception_modrut(precipitation, potential_evaporation, canopystorage, canopygapfraction, cmax)</code></pre><p>Interception according to a modified Rutter model. The model is solved explicitly and there is no drainage below <code>cmax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL71-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.reducer-NTuple{7,Any}" href="#Wflow.reducer-NTuple{7,Any}"><code>Wflow.reducer</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get a reducer function based on CSV output settings defined in a dictionary</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL776">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.reducerfunction-Tuple{AbstractString}" href="#Wflow.reducerfunction-Tuple{AbstractString}"><code>Wflow.reducerfunction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Mapping from reducer strings in the TOML to functions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL760">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.run_simulation-Tuple{Any}" href="#Wflow.run_simulation-Tuple{Any}"><code>Wflow.run_simulation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">run_simulation(tomlpath::String)
run_simulation(config::Config)
run_simulation(model::Model)</code></pre><p>Run an entire simulation starting either from a path to a TOML settings file, a prepared <code>Config</code> object, or an initialized <code>Model</code> object. This allows more flexibility if you want to for example modify a <code>Config</code> before initializing the <code>Model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/Wflow.jl#LL49-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.scurve-Tuple{Any}" href="#Wflow.scurve-Tuple{Any}"><code>Wflow.scurve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">scurve(x; a = 0.0, b = 1.0, c = 1.0)</code></pre><p>Sigmoid &quot;S&quot;-shaped curve.</p><p><strong>Arguments</strong></p><ul><li><code>x::Real</code>: input</li><li><code>a::Real</code>: determines the centre level (default = 0.0)</li><li><code>b::Real</code>: determines the amplitude of the curve</li><li><code>c::Real</code>: determines the steepness or &quot;stepwiseness&quot; of the curve.            The higher c the sharper the function. A negative c reverses the function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.set_layerthickness-Tuple{Float64,StaticArrays.SArray{Tuple{S},T,1,S} where T where S,StaticArrays.SArray{Tuple{S},T,1,S} where T where S}" href="#Wflow.set_layerthickness-Tuple{Float64,StaticArrays.SArray{Tuple{S},T,1,S} where T where S,StaticArrays.SArray{Tuple{S},T,1,S} where T where S}"><code>Wflow.set_layerthickness</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">set_layerthickness(d::Float64, sl::SVector)</code></pre><p>Calculate actual soil thickness of layers based on a reference depth (e.g. soil depth or water table depth) <code>d</code>, a SVector <code>sl</code> with cumulative soil depth starting at soil surface (0), and a SVector <code>tl</code> with actual thickness per soil layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL208-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.set_states-Tuple{Any,Any,Any}" href="#Wflow.set_states-Tuple{Any,Any,Any}"><code>Wflow.set_states</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">set_states(instate_path, model, state_ncnames; &lt;keyword arguments&gt;)</code></pre><p>Read states contained in <code>Dict</code> <code>state_ncnames</code> from NetCDF file located in <code>instate_path</code>, and set states in <code>model</code> object. Active cells are selected with the corresponding network&#39;s (<code>Vector{CartesianIndex}</code>) from the NetCDF file. </p><p><strong>Arguments</strong></p><ul><li><code>type = nothing</code>: type to convert data to after reading. By default no conversion is done.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL76-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.setup_netcdf-NTuple{8,Any}" href="#Wflow.setup_netcdf-NTuple{8,Any}"><code>Wflow.setup_netcdf</code></a> — <span class="docstring-category">Method</span></header><section><div><p>prepare an output dataset</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL200">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.snowpack_hbv-NTuple{9,Any}" href="#Wflow.snowpack_hbv-NTuple{9,Any}"><code>Wflow.snowpack_hbv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">snowpack_hbv(snow, snowwater, precipitation, temperature, tti, tt, ttm, cfmax, whc)</code></pre><p>HBV type snowpack modeling using a temperature degree factor. All correction factors (RFCF and SFCF) are set to 1. The refreezing efficiency factor is set to 0.05.</p><p><strong>Arguments</strong></p><ul><li><code>snow</code> (snow storage)</li><li><code>snowwater</code> (liquid water content in the snow pack)</li><li><code>precipitation</code> (throughfall + stemflow)</li><li><code>temperature</code></li><li><code>tti</code> (snowfall threshold interval length)</li><li><code>tt</code> (threshold temperature for snowfall)</li><li><code>ttm</code> (melting threshold)</li><li><code>cfmax</code> (degree day factor, rate of snowmelt)</li><li><code>whc</code> (Water holding capacity of snow)</li><li><code>rfcf</code> correction factor for rainfall</li><li><code>sfcf</code> correction factor for snowfall</li><li><code>cfr</code> refreeing efficiency constant in refreezing of freewater in snow</li></ul><p><strong>Output</strong></p><ul><li><code>snow</code></li><li><code>snowwater</code></li><li><code>snowmelt</code></li><li><code>rainfall</code> (precipitation that occurs as rainfall)</li><li><code>snowfall</code> (precipitation that occurs as snowfall)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL327-L354">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.stable_timestep-Tuple{Any}" href="#Wflow.stable_timestep-Tuple{Any}"><code>Wflow.stable_timestep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">stable_timestep(aquifer)</code></pre><p>Compute a stable timestep size given the forward-in-time, central in space scheme. The following criterion can be found in Chu &amp; Willis (1984)</p><p>Δt * k * H / (Δx * Δy * S) &lt;= 1/4</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/groundwater/aquifer.jl#LL269-L276">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.statevars" href="#Wflow.statevars"><code>Wflow.statevars</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">statevars(::SBM; snow=false)
statevars(::LateralSSF)
statevars(::SurfaceFlow)
statevars(::NaturalLake)
statevars(::SimpleReservoir)</code></pre><p>Get a tuple of symbols representing the fields that are model states.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/reservoir_lake.jl#LL360-L368">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.sum_at-Tuple{Any,Any}" href="#Wflow.sum_at-Tuple{Any,Any}"><code>Wflow.sum_at</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Return the sum of the array <code>A</code> at indices <code>inds</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.symbols-Tuple{Any}" href="#Wflow.symbols-Tuple{Any}"><code>Wflow.symbols</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Turn &quot;a.aa.aaa&quot; into (:a, :aa, :aaa)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.timecycles-Tuple{Any}" href="#Wflow.timecycles-Tuple{Any}"><code>Wflow.timecycles</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">timecycles(times)</code></pre><p>Given a vector of times, return a tuple of (month, day) for each time entry, to use as a cyclic time series that repeats every year. By using <code>monthday</code> rather than <code>dayofyear</code>, leap year offsets are avoided.</p><p>It can generate such a series from eiher TimeTypes given that the year is constant, or it will interpret integers as either months or days of year if possible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL703-L712">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.tosecond-Tuple{Dates.Hour}" href="#Wflow.tosecond-Tuple{Dates.Hour}"><code>Wflow.tosecond</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">tosecond(x::Period)</code></pre><p>Convert a Period into a Float64, which represents the number of seconds. Will fail if this is not well defined, such as for Month.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; tosecond(Day(1))
86400.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/utils.jl#LL331-L342">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.unsatzone_flow_layer-NTuple{4,Any}" href="#Wflow.unsatzone_flow_layer-NTuple{4,Any}"><code>Wflow.unsatzone_flow_layer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">unsatzone_flow_layer(usd, kv_z, l_sat, c)</code></pre><p>Assuming a unit head gradient, the transfer of water from an unsaturated store layer <code>usd</code> is controlled by the vertical saturated hydraulic conductivity <code>kv_z</code> (bottom layer or water table), the effective saturation degree of the layer (ratio <code>usd</code> and <code>l_sat</code>), and a Brooks-Corey power coefficient <code>c</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL264-L270">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.unsatzone_flow_sbm-NTuple{7,Any}" href="#Wflow.unsatzone_flow_sbm-NTuple{7,Any}"><code>Wflow.unsatzone_flow_sbm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">unsatzone_flow_sbm(ustorelayerdepth, soilwatercapacity, satwaterdepth, kv_z, usl, θₛ, θᵣ)</code></pre><p>The transfer of water from the unsaturated store <code>ustorelayerdepth</code> to the saturated store <code>satwaterdepth</code> is controlled by the vertical saturated hydraulic conductivity <code>kv_z</code> at the water table and the ratio between <code>ustorelayerdepth</code> and the saturation deficit (<code>soilwatercapacity</code> minus <code>satwaterdepth</code>). This is the original Topog_SBM vertical transfer formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/vertical_process.jl#LL294-L302">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update-Tuple{Wflow.NaturalLake,Any,Any,Any,Any}" href="#Wflow.update-Tuple{Wflow.NaturalLake,Any,Any,Any,Any}"><code>Wflow.update</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Update a single lake at position <code>i</code>.</p><p>This is called from within the kinematic wave loop, therefore updating only for a single element rather than all at once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/reservoir_lake.jl#LL385-L390">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update-Tuple{Wflow.SimpleReservoir,Any,Any,Any}" href="#Wflow.update-Tuple{Wflow.SimpleReservoir,Any,Any,Any}"><code>Wflow.update</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Update a single reservoir at position <code>i</code>.</p><p>This is called from within the kinematic wave loop, therefore updating only for a single element rather than all at once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/reservoir_lake.jl#LL127-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update-Union{Tuple{Wflow.Model{N,L,V,R,W}}, Tuple{W}, Tuple{R}, Tuple{V}, Tuple{L}, Tuple{N}} where W where R where V&lt;:Wflow.SBM where L where N" href="#Wflow.update-Union{Tuple{Wflow.Model{N,L,V,R,W}}, Tuple{W}, Tuple{R}, Tuple{V}, Tuple{L}, Tuple{N}} where W where R where V&lt;:Wflow.SBM where L where N"><code>Wflow.update</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update SBM model for a single timestep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/sbm_model.jl#LL260">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update_cyclic!-Tuple{Any}" href="#Wflow.update_cyclic!-Tuple{Any}"><code>Wflow.update_cyclic!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get cyclic NetCDF input for the given time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update_forcing!-Tuple{Any}" href="#Wflow.update_forcing!-Tuple{Any}"><code>Wflow.update_forcing!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get dynamic NetCDF input for the given time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.update_sbm_gwf-Tuple{Any}" href="#Wflow.update_sbm_gwf-Tuple{Any}"><code>Wflow.update_sbm_gwf</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update the sbm_gwf model for a single timestep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/sbm_gwf_model.jl#LL379">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.write_netcdf_timestep-Tuple{Any,Any,Any}" href="#Wflow.write_netcdf_timestep-Tuple{Any,Any,Any}"><code>Wflow.write_netcdf_timestep</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write a new timestep to the NetCDF file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL659">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.write_output-Tuple{Any}" href="#Wflow.write_output-Tuple{Any}"><code>Wflow.write_output</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write model output</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL692">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wflow.@symbols_str-Tuple{Any}" href="#Wflow.@symbols_str-Tuple{Any}"><code>Wflow.@symbols_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Turn symbols&quot;a.aa.aaa&quot; into (:a, :aa, :aaa)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/41737994a5e29272188afe5ca4d9caed1608d0b1/src/io.jl#LL11">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 4 November 2020 22:04">Wednesday 4 November 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sediment flux · Wflow.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/model_docs/lateral/sediment_flux/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Wflow.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">About wflow</a></li><li><a class="tocitem" href="../../../intro/use_cases/">Case studies</a></li><li><a class="tocitem" href="../../../intro/publications/">Publications</a></li><li><a class="tocitem" href="../../../changelog/">Changelog</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../../user_guide/intro/">About the user guide</a></li><li><a class="tocitem" href="../../../user_guide/install/">How to install</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">How to use wflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../user_guide/step1_requirements/">Step 1: Understanding the requirements</a></li><li><a class="tocitem" href="../../../user_guide/step2_settings_file/">Step 2: Preparing the settings file</a></li><li><a class="tocitem" href="../../../user_guide/step3_input_data/">Step 3: Preparing the input data</a></li><li><a class="tocitem" href="../../../user_guide/step4_running/">Step 4: Running a simulation</a></li><li><a class="tocitem" href="../../../user_guide/step5_output/">Step 5: Analyzing the model output</a></li><li><a class="tocitem" href="../../../user_guide/additional_options/">Additional wflow options</a></li><li><a class="tocitem" href="../../../user_guide/sample_data/">Example models</a></li></ul></li><li><a class="tocitem" href="../../../user_guide/model-setup/">Building a model from scratch</a></li></ul></li><li><span class="tocitem">Model documentation</span><ul><li><a class="tocitem" href="../../intro/">About the model documentation</a></li><li><a class="tocitem" href="../../model_configurations/">Model configurations</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vertical concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../../vertical/flextopo/">FLEXTopo</a></li><li><a class="tocitem" href="../../vertical/sediment/">Sediment</a></li><li><a class="tocitem" href="../../shared_concepts/">Shared processes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Lateral concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../local-inertial/">Local inertial</a></li><li><a class="tocitem" href="../waterbodies/">Reservoirs and Lakes</a></li><li class="is-active"><a class="tocitem" href>Sediment flux</a><ul class="internal"><li><a class="tocitem" href="#Inland-Sediment-Model"><span>Inland Sediment Model</span></a></li><li><a class="tocitem" href="#River-Sediment-Model"><span>River Sediment Model</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Model parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../params_vertical/">Parameters vertical concepts</a></li><li><a class="tocitem" href="../../params_lateral/">Parameters lateral concepts</a></li><li><a class="tocitem" href="../../structures/">Julia structures</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model documentation</a></li><li><a class="is-disabled">Lateral concepts</a></li><li class="is-active"><a href>Sediment flux</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sediment flux</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/model_docs/lateral/sediment_flux.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Sediment-flux"><a class="docs-heading-anchor" href="#Sediment-flux">Sediment flux</a><a id="Sediment-flux-1"></a><a class="docs-heading-anchor-permalink" href="#Sediment-flux" title="Permalink"></a></h1><p>Both the inland and river sediment model take into account sediment flux or transport of sediment in water, either in overland flow or in the stream flow. These two transport are distinguished in two different structures.</p><h2 id="Inland-Sediment-Model"><a class="docs-heading-anchor" href="#Inland-Sediment-Model">Inland Sediment Model</a><a id="Inland-Sediment-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Inland-Sediment-Model" title="Permalink"></a></h2><h3 id="Sediment-Flux-in-overland-flow"><a class="docs-heading-anchor" href="#Sediment-Flux-in-overland-flow">Sediment Flux in overland flow</a><a id="Sediment-Flux-in-overland-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Sediment-Flux-in-overland-flow" title="Permalink"></a></h3><p>Once the amount of soil detached by both rainfall and overland flow has been estimated, it has then to be routed and delivered to the river network. Inland routing in sediment models is usually done by comparing the amount of detached sediment with the transport capacity of the flow, which is the maximum amount of sediment that the flow can carry downslope. There are several existing formulas available in the literature. For a wide range of slopes and for overland flow, the Govers equation (1990) seems the most appropriate choice (Hessel et al, 2007). However, as the wflow_sediment model was developed to be linked to water quality issues, the Yalin transport equation was chosen as it can handle particle differentiation (Govers equation can still be used if wflow_sediment is used to only model inland processes with no particle differentiation). For land cells, wflow_sediment assumes that erosion can mobilize 5 classes of sediment:</p><ul><li>Clay (mean diameter of <span>$\SI{2}{\mu m}$</span>)</li><li>Silt (mean diameter of <span>$\SI{10}{\mu m}$</span>)</li><li>Sand (mean diameter of <span>$\SI{200}{\mu m}$</span>)</li><li>Small aggregates (mean diameter of <span>$\SI{30}{\mu m}$</span>)</li><li>Large aggregates (mean diameter of <span>$\SI{50}{\mu m}$</span>).</li></ul><p class="math-container">\[   \mathrm{PSA} = \mathrm{SAN} (1-\mathrm{CLA})^{2.4} \\
   \mathrm{PSI} = 0.13\mathrm{SIL}\\
   \mathrm{PCL} = 0.20\mathrm{CLA} \\

   \mathrm{SAG} = 
   \begin{align*}
      \begin{cases}
         2.0\mathrm{CLA} &amp;\text{ if }\quad \mathrm{CLA} &lt; 0.25 \\
         0.28(\mathrm{CLA}-0.25)+0.5 &amp;\text{ if }\quad 0.25 \leq \mathrm{CLA} \leq 0.5 \\
         0.57 &amp;\text{ if }\quad \mathrm{CLA} &gt; 0.5
      \end{cases}
   \end{align*} \\

   \mathrm{LAG} = 1 - \mathrm{PSA} - \mathrm{PSI} - \mathrm{PCL} - \mathrm{SAG}\]</p><p>where <span>$\mathrm{CLA}$</span>, <span>$\mathrm{SIL}$</span> and <span>$\mathrm{SAN}$</span> are the primary clay, silt, sand fractions of the topsoil and <span>$\mathrm{PCL}$</span>, <span>$\mathrm{PSI}$</span>, <span>$\mathrm{PSA}$</span>, <span>$\mathrm{SAG}$</span> and <span>$\mathrm{LAG}$</span> are the clay, silt, sand, small and large aggregates fractions of the detached sediment respectively. The transport capacity of the flow using Yalin&#39;s equation with particle differentiation, developed by Foster (1982), is:</p><p class="math-container">\[   \mathbf{TC}_i = (P_e)_i  (S_g)_i \, \rho_w \,  g \, d_i  V_*\]</p><p>where <span>$\mathbf{TC}_i$</span> is the transport capacity of the flow for the particle class <span>$i$</span>, <span>$(P_e)_i$</span> is the effective number of particles of class <span>$i$</span>, <span>$\SIb{(S_g)_i}{kg m^{-3}}$</span> is the specific gravity for the particle class <span>$i$</span>, <span>$\SIb{\rho_w}{kg m^{-3}}$</span> is the mass density of the fluid, <span>$\SIb{g}{m s^{-2}}$</span> is the acceleration due to gravity, <span>$\SIb{d_i}{m}$</span> is the diameter of the particle of class <span>$i$</span> and <span>$V_* = \SIb{(g R S)^{0.5}}{m s^{-1}}$</span> is the shear velocity of the flow with <span>$S$</span> the slope gradient and <span>$\SIb{R}{m}$</span> the hydraulic radius of the flow. The detached sediment are then routed down slope until the river network using the <code>accucapacityflux</code>, <code>accupacitystate</code> functions depending on the transport capacity from Yalin.</p><p>The choice of transport capacity method for the overland flow is set up in the model section of the TOML:</p><pre><code class="language-toml hljs">[model]
landtransportmethod = &quot;yalinpart&quot; # Overland flow transport capacity method: [&quot;yalinpart&quot;, &quot;govers&quot;, &quot;yalin&quot;]</code></pre><p>Note that the &quot;govers&quot; and &quot;yalin&quot; equations can only assess total transport capacity of the flow and can therefore not be used in combination with the river part of the sediment model.</p><h2 id="River-Sediment-Model"><a class="docs-heading-anchor" href="#River-Sediment-Model">River Sediment Model</a><a id="River-Sediment-Model-1"></a><a class="docs-heading-anchor-permalink" href="#River-Sediment-Model" title="Permalink"></a></h2><p>Sediment dynamics in rivers can be described by the same three processes on land: erosion, deposition and transport. The difference is that channel ﬂow is much higher, deeper and permanent compared to overland ﬂow. In channels, erosion is the direct removal of sediments from the river bed or bank (lateral erosion). Sediments are transported in the river either by rolling, sliding and silting (bed load transport) or via turbulent flow in the higher water column (suspended load transport). The type of transport is determined by the river bed shear stress. As sediment particles have a higher density than water, they can also be deposited on the river bed according to their settling velocity compared to the ﬂow velocity. In addition to regular deposition in the river, lakes, reservoirs and floodplains represents additional major sediment settling pools.</p><p>Complete models of sediment dynamics based on hydrology and not on hydraulics or hydrodynamics are much rarer than for soil loss and inland dynamics. The simpler models such as the SWAT default sediment river model uses again the transport capacity of the ﬂow to determine if there is erosion or deposition (Neitsch et al., 2011).  A more physics-based approach (Partheniades, 1965) to determine river erosion is used by Liu et al. (2018) and in the new SWAT&#39;s approach developed by Narasimhan et al. (2017). For wﬂow_sediment, the new physics-based model of SWAT was chosen for transport and erosion as it enables the use of parameter estimation for erosion of bed and bank of the channel and separates the suspended from the bed loads.</p><p>Overview of the different processes for a river cell in wflow_sediment.</p><p><img src="../../../images/river-scheme.png" alt="sediment_instream"/></p><p>Running the river model is an option of the wflow_sediment model and is enabled using the TOML file. By default it is <code>false</code>:</p><pre><code class="language-toml hljs">[model]
runrivermodel = true</code></pre><h3 id="Sediment-inputs-in-a-river-cell"><a class="docs-heading-anchor" href="#Sediment-inputs-in-a-river-cell">Sediment inputs in a river cell</a><a id="Sediment-inputs-in-a-river-cell-1"></a><a class="docs-heading-anchor-permalink" href="#Sediment-inputs-in-a-river-cell" title="Permalink"></a></h3><p>The first part of the river model assesses how much detached sediment are in the river cell at the beginning of the timestep <span>$t$</span>. Sources of detached sediment are sediments coming from land erosion, estimated with the soil loss part of wflow_sediment model, the sediment coming from upstream river cells and the detached sediment that were left in the cell at the end of the previous timestep <span>$(t-1)$</span>:</p><p class="math-container">\[   (\subtext{\mathrm{sed}}{in})_t = (\subtext{\mathrm{sed}}{land})_t + \mathrm{upstream}\left[(\subtext{\text{sed}}{out})_{t-1}\right] + (\subtext{\text{sed}}{riv})_{t-1}\]</p><h3 id="River-transport-and-erosion"><a class="docs-heading-anchor" href="#River-transport-and-erosion">River transport and erosion</a><a id="River-transport-and-erosion-1"></a><a class="docs-heading-anchor-permalink" href="#River-transport-and-erosion" title="Permalink"></a></h3><p>Once the amount of sediment inputs at the beginning of the timestep is known, the model then estimates transport, and river erosion if there is a deficit of sediments. Transport in the river system is estimated via a transport capacity formula. There are several transport capacity formulas available in wflow_sediment, some requiring calibration and some not. Choosing a transport capacity equation depends on the river characteristics (some equation are more suited for narrow or wider rivers), and on the reliability of the required river parameters (such as slope, width or mean particle diameter of the river channel). Several river transport capacity are available and the choice is set up in the model section of the TOML:</p><pre><code class="language-toml hljs">[model]
rivtransportmethod = &quot;bagnold&quot; # River flow transport capacity method: [&quot;bagnold&quot;, &quot;engelund&quot;, &quot;yang&quot;, &quot;kodatie&quot;, &quot;molinas&quot;]</code></pre><p><strong>Simplified Bagnold</strong></p><p>Originally more valid for intermediate to large rivers, this simplified version of the Bagnold equation relates sediment transport to flow velocity with two simple calibration parameters (Neitsch et al, 2011):</p><p class="math-container">\[C_{\max} = \subtext{c}{sp}  \left( \dfrac{\mathrm{prf} Q}{h W} \right)^{\subtext{\mathrm{sp}}{exp}}\]</p><p>where <span>$\SIb{C_{\max}}{kg L^{-1}}$</span> (or <span>$\SIb{}{ton m^{-1}}$</span>) is the sediment concentration, <span>$\SIb{Q}{m^3 s^{-1}}$</span> is the surface runoff in the river cell, <span>$\SIb{h}{m}$</span> is the river water level, <span>$\SIb{W}{m}$</span> is the river width and <span>$\subtext{c}{sp}$</span>, <span>$\mathrm{prf}$</span> and <span>$\subtext{\mathrm{sp}}{exp}$</span> are calibration parameters. The <span>$\mathrm{prf}$</span> coefficient is usually used to deduce the peak velocity of the flow, but for simplification in <code>wflow_sediment</code>, the equation was simplified to only get two parameters to calibrate: <span>$\subtext{\mathrm{sp}}{exp}$</span> and <span>$\subtext{c}{Bagnold} = \subtext{c}{sp} \, \mathrm{prf}^{\subtext{\mathrm{sp}}{exp}}$</span>. The coefficient <span>$\subtext{\mathrm{sp}}{exp}$</span> usually varies between <span>$1$</span> and <span>$2$</span> while <span>$\mathrm{prf}$</span> and <span>$\subtext{c}{sp}$</span> have a wider range of variation. The table below summarizes ranges and values of the three Bagnold coefficients used by other studies:</p><p>Table: Range of the simplified Bagnold coefficients (and calibrated value)</p><table><tr><th style="text-align: left">Study</th><th style="text-align: right">River</th><th style="text-align: right"><span>$\mathrm{prf}$</span> range</th><th style="text-align: right"><span>$\subtext{c}{sp}$</span> range</th><th style="text-align: right"><span>$\subtext{\mathrm{sp}}{exp}$</span> range</th></tr><tr><td style="text-align: left">Vigiak 2015</td><td style="text-align: right">Danube</td><td style="text-align: right">0.5-2 (/)</td><td style="text-align: right">0.0001-0.01 (0.003-0.006)</td><td style="text-align: right">1-2 (1.4)</td></tr><tr><td style="text-align: left">Vigiak 2017</td><td style="text-align: right">Danube</td><td style="text-align: right">/</td><td style="text-align: right">0.0001-0.01 (0.0015)</td><td style="text-align: right">1-2 (1.4)</td></tr><tr><td style="text-align: left">Abbaspour 2007</td><td style="text-align: right">Thur (CH)</td><td style="text-align: right">0.2-0.25 (/)</td><td style="text-align: right">0.001-0.002 (/)</td><td style="text-align: right">0.35-1.47 (/)</td></tr><tr><td style="text-align: left">Oeurng 2011</td><td style="text-align: right">Save (FR)</td><td style="text-align: right">0-2 (0.58)</td><td style="text-align: right">0.0001-0.01 (0.01)</td><td style="text-align: right">1-2 (2)</td></tr></table><p><strong>Engelund and Hansen</strong> This transport capacity is not present in SWAT but used in many models such as Delft3D-WAQ, Engelund and Hansen calculates the total sediment load as (Engelund and Hansen, 1967):</p><p class="math-container">\[   C_w = 0.05 \left( \dfrac{\rho_{s}}{\rho_{s} - \rho} \right) \left( \dfrac{u S}{\sqrt{\left( \dfrac{\rho_{s}}{\rho_{s} - \rho} \right) g  D_{50}}} \right) \theta^{1/2}\]</p><p>where <span>$C_w$</span> is the sediment concentration by weight, <span>$\SIb{\rho}{g m^{-3}}$</span> and <span>$\SIb{\rho_{s}}{g m^{-3}}$</span> are the fluid and sediment density (here respectively equal to <span>$\SI{1000}{g m^{-3}}$</span> and <span>$\SI{2650}{g m^{-3}}$</span>), <span>$\SIb{u}{m s^{-1}}$</span> is the water mean velocity, <span>$S$</span> is the river slope, <span>$g$</span> is the acceleration due to gravity, <span>$\SIb{D_{50}}{m}$</span> is the river mean diameter and <span>$\theta$</span> is the Shields parameter.</p><p><strong>Kodatie</strong> Kodatie (1999) developed the power relationships from Posada (1995) using field data and linear optimization so that they would be applicable for a wider range of riverbed sediment size. The resulting equation, for a rectangular channel, is (Neitsch et al, 2011):</p><p class="math-container">\[   C_{\max} = \left( \dfrac{a u^{b} h^{c} S^{d}}{\subtext{V}{in}} \right)  W\]</p><p>where <span>$\SIb{\subtext{V}{in}}{m^3}$</span> in the volume of water entering the river cell during the timestep and <span>$a$</span>, <span>$b$</span>, <span>$c$</span> and <span>$d$</span> are coefficients depending on the riverbed sediment size. Values of these coefficients are summarized in the table below.</p><p>Table: Range of the simplified Bagnold coefficients (and calibrated value)</p><table><tr><th style="text-align: left">River sediment diameter</th><th style="text-align: right">a</th><th style="text-align: right">b</th><th style="text-align: right">c</th><th style="text-align: right">d</th></tr><tr><td style="text-align: left"><span>$D_{50} \leq \SI{0.05}{mm}$</span></td><td style="text-align: right">281.4</td><td style="text-align: right">2.622</td><td style="text-align: right">0.182</td><td style="text-align: right">0</td></tr><tr><td style="text-align: left"><span>$\SI{0.05}{mm} &lt; D_{50} \leq \SI{0.25}{mm}$</span></td><td style="text-align: right">2  829.6</td><td style="text-align: right">3.646</td><td style="text-align: right">0.406</td><td style="text-align: right">0.412</td></tr><tr><td style="text-align: left"><span>$\SI{0.25}{mm} &lt; D_{50} \leq \SI{2.0}{mm}$</span></td><td style="text-align: right">2  123.4</td><td style="text-align: right">3.300</td><td style="text-align: right">0.468</td><td style="text-align: right">0.613</td></tr><tr><td style="text-align: left"><span>$D_{50} &gt; \SI{2.0}{mm}$</span></td><td style="text-align: right">431  884.8</td><td style="text-align: right">1.000</td><td style="text-align: right">1.000</td><td style="text-align: right">2.000</td></tr></table><p><strong>Yang</strong> Yang (1996) developed a set of two equations giving transport of sediments for sand-bed or gravel-bed rivers. The sand equation (<span>$D_{50} &lt; \SI{2.0}{mm}$</span>) is:</p><p class="math-container">\[   \log\left(C_{ppm}\right) = 5.435 - 0.286\log\left(\frac{\omega_{s,50}D_{50}}{\nu}\right)-0.457\log\left(\frac{u_*}{\omega_{s,50}}\right) \\
   +\left(1.799-0.409\log\left(\frac{\omega_{s,50}D_{50}}{\nu}\right)-0.314\log\left(\frac{u_*}{\omega_{s,50}}\right)\right)\log\left(\frac{uS}{\omega_{s,50}}-\frac{u_{cr}S}{\omega_{s,50}}\right)\]</p><p>And the gravel equation (<span>$\SI{2.0}{mm} \leq D_{50} &lt; \SI{10.0}{mm}$</span>) is:</p><p class="math-container">\[   \log\left(C_{ppm}\right) = 6.681 - 0.633\log\left(\frac{\omega_{s,50}D_{50}}{\nu}\right)-4.816\log\left(\frac{u_*}{\omega_{s,50}}\right) \\
   +\left(2.784-0.305\log\left(\frac{\omega_{s,50}D_{50}}{\nu}\right)-0.282\log\left(\frac{u_*}{\omega_{s,50}}\right)\right)\log\left(\frac{uS}{\omega_{s,50}}-\frac{u_{cr}S}{\omega_{s,50}}\right)\]</p><p>where <span>$C_{ppm}$</span> is sediment concentration in parts per million by weight, <span>$\SIb{\omega_{s,50}}{m s^{-1}}$</span> is the settling velocity of a particle with the median riverbed diameter estimated with Stokes, <span>$\SIb{\nu}{m^2 s^{-1}}$</span> is the kinematic viscosity of the fluid, <span>$\SIb{u_*}{m s^{-1}}$</span> is the shear velocity where <span>$u_* = \sqrt{gR_{H}S}$</span> with <span>$R_{H}$</span> the hydraulic radius of the river and <span>$\SIb{u_{cr}}{m s^{-1}}$</span> is the critical velocity (equation can be found in Hessel, 2007).</p><p><strong>Molinas and Wu</strong> The Molinas and Wu (2001) transport equation was developed for large sand-bed rivers based on the universal stream power <span>$\psi$</span>. The corresponding equation is (Neitsch et al, 2011):</p><p class="math-container">\[   C_{w} = \dfrac{1430 (0.86+\sqrt{\psi}) \psi^{1.5}}{0.016+\psi} 10^{-6}\]</p><p>where <span>$\psi$</span> is the universal stream power given by:</p><p class="math-container">\[   \psi = \dfrac{\psi^{3}}{\left(\dfrac{\rho_{s}}{\rho}-1\right) g h \omega_{s,50}  \left[ \log_{10}\left(\dfrac{h}{D_{50}}\right)\right]^{2}}\]</p><p>Once the maximum concentration <span>$C_{\max}$</span> is established with one of the above transport formula, the model then determines if there is erosion of the river bed and bank. In order to do that, the difference <span>$sed_{ex}$</span> between the maximum amount of sediment estimated with transport (<span>$\mathrm{sed}_{\max} = C_{\max} \subtext{V}{in}$</span>) and the sediment inputs to the river cell (<span>$\subtext{\mathrm{sed}}{in}$</span> calculated above) is calculated. If too much sediment is coming in and <span>$\subtext{\mathrm{sed}}{ex}$</span> is negative, then there is no river bed and bank erosion. And if the river has not reach its maximum transport capacity, then erosion of the river happens.</p><p>First, the sediments stored in the cell from deposition in previous timesteps <span>$\subtext{\mathrm{sed}}{stor}$</span> are eroded from clay to gravel. If this amount is not enough to cover <span>$\subtext{\mathrm{sed}}{ex}$</span>, then erosion of the local river bed and bank material starts.</p><p>Instead of just setting river erosion amount to just cover the remaining difference <span>$\subtext{\mathrm{sed}}{exeff}$</span> between <span>$\subtext{\mathrm{sed}}{ex}$</span> and <span>$\subtext{\mathrm{sed}}{stor}$</span>, actual erosion potential is adjusted using river characteristics and is separated between the bed and bank of the river using the physics-based approach of Knight (1984).</p><p>The bed and bank of the river are supposed to only be able to erode a maximum amount of their material <span>$E_{R,\mathrm{bed}}$</span> for the bed and <span>$E_{R,\mathrm{bank}}$</span> for the river bank. For a rectangular channel, assuming it is meandering and thus only one bank is prone to erosion, they are calculated from the equations (Neitsch et al, 2011):</p><p class="math-container">\[   E_{R,\mathrm{bed}} = k_{d,\mathrm{bed}} \left( \tau_{e,\mathrm{bed}} - \tau_{cr,\mathrm{bed}} \right) 10^{-6}  L  W  \rho_{b, \mathrm{bed}}  \Delta t \\~\\
   E_{R,\mathrm{bank}} = k_{d,\mathrm{bank}} \left( \tau_{e,\mathrm{bank}} - \tau_{cr,\mathrm{bank}} \right) 10^{-6} L h \rho_{b, \mathrm{bank}}  \Delta t\]</p><p>where <span>$\SIb{E_R}{ton}$</span> is the potential bed/bank erosion rates, <span>$\SIb{k_d}{cm^3 N^{-1}, s^{-1}}$</span> is the erodibility of the bed/bank material, <span>$\SIb{\tau_e}{N m^{-2}}$</span> is the effective shear stress from the flow on the bed/bank, <span>$\SIb{\tau_{cr}}{N m^{-2}}$</span> is the critical shear stress for erosion to happen, <span>$\SIb{L}{m}$</span>, <span>$\SIb{W}{m}$</span> and <span>$\SIb{h}{m}$</span> are the channel length, width and water height, <span>$\SIb{\rho_{b}}{g cm^{-3}}$</span> is the bulk density of the bed/bank of the river and <span>$\SIb{\Delta t}{s}$</span> is the model timestep.</p><p>In wflow_sediment, the erodibility of the bed/bank are approximated using the formula from Hanson and Simon (2001):</p><p class="math-container">\[   k_d=0.2 \tau_{cr}^{-0.5}\]</p><p>Normally erodibilities are evaluated using jet test in the field and there are several reviews and some adjustments possible to this equation (Simon et al, 2011). However, to avoid too heavy calibration and for the scale considered, this equation is supposed to be efficient enough. The critical shear stress <span>$\tau_{cr}$</span> is evaluated differently for the bed and bank. For the bed, the most common formula from Shields initiation of movement is used. For the bank, a more recent approach from Julian and Torres (2006) is used :</p><p class="math-container">\[   \tau_{cr,\mathrm{bank}} = (0.1+0.1779 SC+0.0028 SC^{2}-2.34 10^{-5}  SC^{3}) C_{ch}\]</p><p>where <span>$SC$</span> is the percent clay and silt content of the river bank and <span>$C_{ch}$</span> is a coefficient taking into account the positive impact of vegetation on erosion reduction. This coefficient is then dependent on the land use and classical values are shown in the table below. These values where then adapted for use with the GlobCover land use map. Percent of clay and silt (along with sand and gravel) for the channel is estimated from the river median particle diameter assuming the same values as SWAT shown in the table below. Median particle diameter is here estimated depending on the Strahler river order. The higher the order, the smaller the diameter is. As the median diameter is only used in wflow_sediment for the estimation of the river bed/bank sediment composition, this supposition should be enough. Actual refined data or calibration may however be needed if the median diameter is also required for the transport formula. In a similar way, the bulk densities of river bed and bank are also just assumed to be of respectively 1.5 and 1.4 g cm<span>$^{-3}$</span>.</p><p>Table: Classical values of the channel cover vegetation coefficient (Julian and Torres, 2006)</p><table><tr><th style="text-align: left">Bank vegetation</th><th style="text-align: right"><span>$C_{ch}$</span></th></tr><tr><td style="text-align: left">None</td><td style="text-align: right">1.00</td></tr><tr><td style="text-align: left">Grassy</td><td style="text-align: right">1.97</td></tr><tr><td style="text-align: left">Sparse trees</td><td style="text-align: right">5.40</td></tr><tr><td style="text-align: left">Dense trees</td><td style="text-align: right">19.20</td></tr></table><p>Table : Composition of the river bed/bank depending on the median diameter <span>$d_{50}$</span> [<span>$\mu$</span>m] (Neitsch et al, 2011)</p><table><tr><th style="text-align: left">Sediment Fraction</th><th style="text-align: right"><span>$\leq$</span> 5</th><th style="text-align: right">5 to 50</th><th style="text-align: right">50 to 2000</th><th style="text-align: right"><span>$&gt;$</span>2000</th></tr><tr><td style="text-align: left">Sand</td><td style="text-align: right">0.15</td><td style="text-align: right">0.15</td><td style="text-align: right">0.65</td><td style="text-align: right">0.15</td></tr><tr><td style="text-align: left">Silt</td><td style="text-align: right">0.15</td><td style="text-align: right">0.65</td><td style="text-align: right">0.15</td><td style="text-align: right">0.15</td></tr><tr><td style="text-align: left">Clay</td><td style="text-align: right">0.65</td><td style="text-align: right">0.15</td><td style="text-align: right">0.15</td><td style="text-align: right">0.05</td></tr><tr><td style="text-align: left">Gravel</td><td style="text-align: right">0.05</td><td style="text-align: right">0.05</td><td style="text-align: right">0.05</td><td style="text-align: right">0.65</td></tr></table><p>Then, the repartition of the flow shear stress is refined into the effective shear stress and the bed and bank of the river using the equations developed by Knight (1984) for a rectangular channel:</p><p class="math-container">\[   \tau_{e,\mathrm{bed}} = \rho g R_{H} S  \left(1 - \dfrac{SF_{\mathrm{bank}}}{100}\right) \left(1+\dfrac{2h}{W}\right) \\~\\
   \tau_{e,\mathrm{bank}} = \rho g R_{H} S  \left( SF_{\mathrm{bank}}\right)  \left(1+\dfrac{W}{2h}\right)\]</p><p>where <span>$\rho g$</span> is the fluid specific weight (<span>$\SI{9800}{N m^{-3}}$</span> for water), <span>$\SIb{R_H}{m}$</span> is the hydraulic radius of the channel, <span>$\SIb{h}{m}$</span> and <span>$\SIb{W}{m}$</span> are the water level and river width. <span>$SF_{\mathrm{bank}}$</span> is the proportion of shear stress acting on the bank (%) and is estimated from (Knight, 1984):</p><p class="math-container">\[   \mathrm{SF}_{\mathrm{bank}} = \exp \left( -3.230 \log_{10}\left(\dfrac{W}{h}+3\right)+6.146 \right)\]</p><p>Finally the relative erosion potential of the bank and bed of the river is calculated by:</p><p class="math-container">\[   \mathrm{RTE}_{\mathrm{bed}} = \dfrac{E_{R,\mathrm{bed}}}{E_{R,\mathrm{bed}}+E_{R,\mathrm{bank}}} \\~\\
   \mathrm{RTE}_{\mathrm{bank}} = 1 - RTE_{\mathrm{bed}}\]</p><p>And the final actual eroded amount for the bed and bank is the maximum between <span>$\mathrm{RTE} \subtext{\mathrm{sed}}{exeff}$</span> and the erosion potential <span>$E_R$</span>. Total eroded amount of sediment <span>$\subtext{\mathrm{sed}}{erod}$</span> is then the sum of the eroded sediment coming from the storage of previously deposited sediment and the river bed/bank erosion.</p><h3 id="River-deposition"><a class="docs-heading-anchor" href="#River-deposition">River deposition</a><a id="River-deposition-1"></a><a class="docs-heading-anchor-permalink" href="#River-deposition" title="Permalink"></a></h3><p>As sediments have a higher density than water, moving sediments in water can be deposited in the river bed. The deposition process depends on the mass of the sediment, but also on flow characteristics such as velocity. In wflow_sediment, as in SWAT, deposition is modelled with Einstein&#39;s equation (Neitsch et al, 2011):</p><p class="math-container">\[   \subtext{P}{dep}=\left(1-\dfrac{1}{e^{x}}\right)100\]</p><p>where <span>$\subtext{P}{dep}$</span> is the percentage of sediments that is deposited on the river bed and x is a parameter calculated with:</p><p class="math-container">\[   x = \dfrac{1.055 L  \omega_{s}}{u h}\]</p><p>where <span>$\SIb{L}{m}$</span> and <span>$\SIb{h}{m}$</span> are channel length and water height, <span>$\SIb{\omega_s}{m s^{-1}}$</span> is the particle settling velocity calculated with Stokes&#39; formula and <span>$\SIb{u}{m s^{-1}}$</span> is the mean flow velocity. The calculated percentage is then subtracted from the amount of sediment input and eroded river sediment for each particle size class (<span>$\subtext{\mathrm{sed}}{dep} = \subtext{P}{dep}/100 (\subtext{\mathrm{sed}}{in} + \subtext{\mathrm{sed}}{erod})$</span>). Resulting deposited sediment are then stored in the river bed and can be re-mobilized in future time steps by erosion.</p><h3 id="Mass-balance-and-sediment-concentration"><a class="docs-heading-anchor" href="#Mass-balance-and-sediment-concentration">Mass balance and sediment concentration</a><a id="Mass-balance-and-sediment-concentration-1"></a><a class="docs-heading-anchor-permalink" href="#Mass-balance-and-sediment-concentration" title="Permalink"></a></h3><p>Finally after estimating inputs, deposition and erosion with the transport capacity of the flow, the amount of sediment actually leaving the river cell to go downstream is estimated using:</p><p class="math-container">\[   \subtext{\mathrm{sed}}{out} = (\subtext{\mathrm{sed}}{in} + \subtext{\mathrm{sed}}{erod} - \subtext{\mathrm{sed}}{dep}) \dfrac{\subtext{V}{out}}{V}\]</p><p>where <span>$\SIb{\subtext{\mathrm{sed}}{out}}{ton}$</span> is the amount of sediment leaving the river cell (tons), <span>$\SIb{\subtext{\mathrm{sed}}{in}}{ton}$</span> is the amount of sediment coming into the river cell (storage from previous timestep, land erosion and sediment flux from upstream river cells), <span>$\SIb{\subtext{\mathrm{sed}}{erod}}{ton}$</span> is the amount of sediment coming from river erosion, <span>$\SIb{\subtext{\mathrm{sed}}{dep}}{ton}$</span> is the amount of deposited sediments, <span>$\SIb{\subtext{V}{out}}{m^3}$</span> is the volume of water leaving the river cell (surface runoff <span>$Q$</span> times timestep <span>$\Delta t$</span>) and <span>$\SIb{V}{m^3}$</span> is the total volume of water in the river cell (<span>$\subtext{V}{out}$</span> plus storage <span>$h W L$</span>).</p><p>A mass balance is then used to calculate the amount of sediment remaining in the cell at the end of the timestep <span>$(\subtext{\mathrm{sed}}{riv})_t$</span>:</p><p class="math-container">\[   (\subtext{\mathrm{sed}}{riv})_t = (\subtext{\mathrm{sed}}{riv})_{t-1} + (\subtext{\mathrm{sed}}{land})_t + \mathrm{upstream}\left[(\subtext{\mathrm{sed}}{out})_{t-1}\right] + (\subtext{\mathrm{sed}}{erod})_t - (\subtext{\mathrm{sed}}{dep})_t - (\subtext{\mathrm{sed}}{out})_t\]</p><h3 id="Lake-and-reservoir-modelling"><a class="docs-heading-anchor" href="#Lake-and-reservoir-modelling">Lake and reservoir modelling</a><a id="Lake-and-reservoir-modelling-1"></a><a class="docs-heading-anchor-permalink" href="#Lake-and-reservoir-modelling" title="Permalink"></a></h3><p>Apart from land and river, the hydrologic <code>wflow_sbm</code> model also handles lakes and reservoirs modelling. In <code>wflow_sbm</code>, lakes and large reservoirs are modelled using a 1D bucket model at the cell corresponding to the outlet. For the other cells belonging to the lake/reservoir which are not the outlet, processes such as precipitation and evaporation are filtered out and shifted to the outlet cell. <code>wflow_sediment</code> handles the lakes and reservoirs in the same way. If a cell belongs to a lake/reservoir and is not the outlet then the model assumes that no erosion/deposition of sediments is happening and the sediments are only all transported to the lake/reservoir outlet. Once the sediments reach the outlet, then sediments are deposited in the lake/reservoir according to Camp&#39;s model (1945) (Verstraeten et al, 2000):</p><p class="math-container">\[   \mathrm{TE} = \dfrac{\omega_s}{u_{cr,\mathrm{res}}} = \dfrac{\subtext{A}{res}}{\subtext{Q}{out,res}} \omega_s\]</p><p>where <span>$\mathrm{TE}$</span> is the trapping efficiency of the lake/reservoir (or the fraction of particles trapped), <span>$\SIb{\omega_{s}}{m s^{-1}}$</span> is the particle velocity from Stokes, <span>$\SIb{\subtext{u}{cr,res}}{m s^{-1}}$</span> is the reservoir&#39;s critical settling velocity which is equal to the reservoir&#39;s outflow <span>$\SIb{\subtext{Q}{out,res}}{m^3 s^{-1}}$</span> divided by the reservoir&#39;s surface area <span>$\SIb{\subtext{A}{res}}{m^2}$</span>.</p><p>For reservoirs, coarse sediment particles from the bed load are also assumed to be trapped by the dam structure. This adding trapping is taken into account with a reservoir trapping efficiency coefficient for large particles (between <span>$0$</span> and <span>$1$</span>). Depending on the type of the dam, all bed load particles are trapped (<code>restrapefficiency = 1.0</code>, for example for a gravity dam) or only partly (for example for run-of-the-river dams).</p><p>Lake and reservoir modelling is enabled in the model section of the TOML and require the extra following input arguments:</p><pre><code class="language-toml hljs">[model]
doreservoir = true
dolake = false

[input.vertical]
# Reservoir
resareas = &quot;wflow_reservoirareas&quot;
# Lake
lakeareas = &quot;wflow_lakeareas&quot;

[input.lateral.river]
# Reservoir
resarea = &quot;ResSimpleArea&quot;
restrapefficiency = &quot;ResTrapEff&quot;
resareas = &quot;wflow_reservoirareas&quot;
reslocs = &quot;wflow_reservoirlocs&quot;
# Lake
lakearea = &quot;LakeArea&quot;
lakeareas = &quot;wflow_lakeareas&quot;
lakelocs = &quot;wflow_lakelocs&quot;</code></pre><p>Note that in the inland part, lake and reservoir coverage are used to filter erosion and transport in overland flow.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>K.C. Abbaspour, J. Yang, I. Maximov, R. Siber, K. Bogner, J. Mieleitner, J. Zobrist, and R.Srinivasan. Modelling hydrology and water quality in the pre-alpine/alpine Thur watershed using SWAT. Journal of Hydrology, 333(2-4):413-430, 2007. 10.1016/j.jhydrol.2006.09.014</li><li>P. Borrelli, M. Märker, P. Panagos, and B. Schütt. Modeling soil erosion and river sediment yield for an intermountain drainage basin of the Central Apennines, Italy. Catena, 114:45-58, 2014. 10.1016/j.catena.2013.10.007</li><li>F. Engelund and E. Hansen. A monograph on sediment transport in alluvial streams. Technical University of Denmark 0stervoldgade 10, Copenhagen K., 1967.</li><li>G. Govers. Empirical relationships for the transport capacity of overland flow. IAHS Publication, (January 1990):45-63 ST, 1990.</li><li>G.J Hanson and A Simon. Erodibility of cohesive streambeds in the loess area of the midwestern USA. Hydrological Processes, 15(May 1999):23-38, 2001.</li><li>R Hessel and V Jetten. Suitability of transport equations in modelling soil erosion for a small Loess Plateau catchment. Engineering Geology, 91(1):56-71, 2007. 10.1016/j.enggeo.2006.12.013</li><li>J.P Julian, and R. Torres. Hydraulic erosion of cohesive riverbanks. Geomorphology,  76:193-206, 2006. 10.1016/j.geomorph.2005.11.003</li><li>D.W. Knight, J.D. Demetriou, and M.E. Hamed. Boundary Shear in Smooth Rectangular Channels. J. Hydraul. Eng., 110(4):405-422, 1984. 10.1061/(ASCE)0733-9429(1987)113:1(120)</li><li>S.L Neitsch, J.G Arnold, J.R Kiniry, and J.R Williams. SWAT Theoretical Documentation Version 2009. Texas Water Resources Institute, pages 1-647, 2011. 10.1016/j.scitotenv.2015.11.063</li><li>C. Oeurng, S. Sauvage, and J.M. Sanchez-Perez. Assessment of hydrology, sediment and particulate organic carbon yield in a large agricultural catchment using the SWAT model. Journal of Hydrology, 401:145-153, 2011. 10.1016/j.hydrol.2011.02.017</li><li>A. Simon, N. Pollen-Bankhead, and R.E Thomas. Development and application of a deterministic bank stability and toe erosion model for stream restoration. Geophysical Monograph Series, 194:453-474, 2011. 10.1029/2010GM001006</li><li>G. Verstraeten and J. Poesen. Estimating trap efficiency of small reservoirs and ponds: methods and implications for the assessment of sediment yield. Progress in Physical Geography, 24(2):219-251, 2000. 10.1177/030913330002400204</li><li>O. Vigiak, A. Malago, F. Bouraoui, M. Vanmaercke, and J. Poesen. Adapting SWAT hillslope erosion model to predict sediment concentrations and yields in large Basins. Science of the Total Environment, 538:855-875, 2015. 10.1016/j.scitotenv.2015.08.095</li><li>O. Vigiak, A. Malago, F. Bouraoui, M. Vanmaercke, F. Obreja, J. Poesen, H. Habersack, J. Feher, and S. Groselj. Modelling sediment fluxes in the Danube River Basin with SWAT. Science of the Total Environment, 2017. 10.1016/j.scitotenv.2017.04.236</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../waterbodies/">« Reservoirs and Lakes</a><a class="docs-footer-nextpage" href="../../params_vertical/">Parameters vertical concepts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 28 October 2024 13:55">Monday 28 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Changelog · Wflow.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/changelog/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Wflow.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../publications/">Publications</a></li><li><a class="tocitem" href="../quick-start/">Quick start</a></li><li><a class="tocitem" href="../cli/">Command line interface</a></li><li><span class="tocitem">Structures and config</span><ul><li><a class="tocitem" href="../structure/">Structures</a></li><li><a class="tocitem" href="../config/">Config</a></li></ul></li><li><a class="tocitem" href="../model-setup/">Building a model</a></li><li><span class="tocitem">Model parameters</span><ul><li><a class="tocitem" href="../vertical/parameters/">Vertical concepts</a></li><li><a class="tocitem" href="../lateral/kinwave_params/">Kinematic wave</a></li><li><a class="tocitem" href="../lateral/gwf_params/">Groundwater flow</a></li><li><a class="tocitem" href="../lateral/sediment_params/">Sediment flux</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../model/sbm/">wflow_sbm</a></li><li><a class="tocitem" href="../model/hbv/">wflow_hbv</a></li><li><a class="tocitem" href="../model/sediment/">wflow_sediment</a></li></ul></li><li><span class="tocitem">Vertical components</span><ul><li><a class="tocitem" href="../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../vertical/process/">Vertical processes</a></li><li><a class="tocitem" href="../vertical/sediment/">Soil Loss</a></li></ul></li><li><span class="tocitem">Lateral components</span><ul><li><a class="tocitem" href="../lateral/kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../lateral/gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../lateral/sediment/">Sediment Flux</a></li></ul></li><li><a class="tocitem" href="../bmi/">Basic Model Interface</a></li><li><a class="tocitem" href="../fews/">Run from Delft-FEWS</a></li><li class="is-active"><a class="tocitem" href>Changelog</a><ul class="internal"><li><a class="tocitem" href="#Unreleased"><span>Unreleased</span></a></li><li><a class="tocitem" href="#v0.4.0-2021-09-02"><span>v0.4.0 - 2021-09-02</span></a></li><li><a class="tocitem" href="#v0.3.1-2021-05-19"><span>v0.3.1 - 2021-05-19</span></a></li><li><a class="tocitem" href="#v0.3.0-2021-05-10"><span>v0.3.0 - 2021-05-10</span></a></li><li><a class="tocitem" href="#v0.2.0-2021-03-26"><span>v0.2.0 - 2021-03-26</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Changelog</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Changelog</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/changelog.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Changelog"><a class="docs-heading-anchor" href="#Changelog">Changelog</a><a id="Changelog-1"></a><a class="docs-heading-anchor-permalink" href="#Changelog" title="Permalink"></a></h1><p>All notable changes to this project will be documented in this file.</p><p>The format is based on <a href="https://keepachangelog.com/en/1.0.0/">Keep a Changelog</a>, and this project adheres to <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning</a>.</p><h2 id="Unreleased"><a class="docs-heading-anchor" href="#Unreleased">Unreleased</a><a id="Unreleased-1"></a><a class="docs-heading-anchor-permalink" href="#Unreleased" title="Permalink"></a></h2><h3 id="Changed"><a class="docs-heading-anchor" href="#Changed">Changed</a><a id="Changed-1"></a><a class="docs-heading-anchor-permalink" href="#Changed" title="Permalink"></a></h3><ul><li>The <span>$\alpha$</span> parameter of the kinematic wave has a fixed value now and is not updated because of changes in water height (this could result in large water balance errors). See also <a href="../lateral/kinwave/#Surface-routing">Surface routing</a>.</li></ul><h3 id="Added"><a class="docs-heading-anchor" href="#Added">Added</a><a id="Added-1"></a><a class="docs-heading-anchor-permalink" href="#Added" title="Permalink"></a></h3><ul><li>Check if reservoirs and lakes have downstream nodes. Without downstream nodes is not supported and in that case an error message is thrown that is easier to understand than the previous one: &quot;ArgumentError: Collection is empty, must contain exactly 1 element.&quot;</li><li>For the <code>input.path_forcing</code> TOML setting we use <a href="https://github.com/vtjnash/Glob.jl/">Glob.jl</a> to expand strings like <code>&quot;data/forcing-year-*.nc&quot;</code> to a set of netCDF files that are split in time.</li></ul><h3 id="Fixed"><a class="docs-heading-anchor" href="#Fixed">Fixed</a><a id="Fixed-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed" title="Permalink"></a></h3><ul><li>River inflow for reservoirs and lakes in the kinematic wave. This inflow was based on <span>$sf.q[v]$</span> at the previous time step, and this has been fixed to the current time step.</li></ul><h2 id="v0.4.0-2021-09-02"><a class="docs-heading-anchor" href="#v0.4.0-2021-09-02">v0.4.0 - 2021-09-02</a><a id="v0.4.0-2021-09-02-1"></a><a class="docs-heading-anchor-permalink" href="#v0.4.0-2021-09-02" title="Permalink"></a></h2><h3 id="Changed-2"><a class="docs-heading-anchor" href="#Changed-2">Changed</a><a class="docs-heading-anchor-permalink" href="#Changed-2" title="Permalink"></a></h3><ul><li>Changed length units for lateral subsurface flow component from millimeter to meter. This means that state netCDF files from previous versions can only be reused if <code>ssf</code> is divided by 10^9.</li><li>Add snow and glacier processes to wflow_sbm figure of the documentation.</li></ul><h3 id="Added-2"><a class="docs-heading-anchor" href="#Added-2">Added</a><a class="docs-heading-anchor-permalink" href="#Added-2" title="Permalink"></a></h3><ul><li>Multi-threading of vertical SBM concept and lateral kinematic wave components (overland, river and subsurface flow) of wflow_sbm model <a href="../model/sbm/#SBM-Kinematic-wave">SBM + Kinematic wave</a>.</li><li>Improved error message for CSV Reducer.</li><li>The TOML keys <code>kv₀</code>, <code>θᵣ</code> and <code>θₛ</code> have been replaced with the ASCII versions <code>kv_0</code>, <code>theta_r</code> and <code>theta_s</code>, to avoid encoding issues with certain text editors. The old keys still work as well.</li></ul><h3 id="Fixed-2"><a class="docs-heading-anchor" href="#Fixed-2">Fixed</a><a class="docs-heading-anchor-permalink" href="#Fixed-2" title="Permalink"></a></h3><ul><li>Calculation of volumetric water content of vertical SBM (soil layers and root zone).</li><li>Update of <code>satwaterdepth</code> in SBM (evaporation was only substracted from a local variable, and not from <code>sbm.satwaterdepth</code>).</li><li>Fixed the index <code>lowerlake_ind</code> of <code>NaturalLake</code>. Linked lakes were not simulated correctly (flows between upstream and downsteam lake).</li><li>Interpolation function <code>interpolate_linear(x, xp, fp)</code> for CSV tables lakes. When <code>x</code> was larger or smaller than <code>xp</code>, maximum(<code>xp</code>) or minimum(<code>xp</code>) was returned instead of maximum(<code>fp</code>) or minimum(<code>fp</code>).</li><li>Fixed model timestep of reservoirs (<code>SimpleReservoir</code>) and lakes (<code>NaturalLake</code>) in relation to precipitation and evapotranspiration fluxes. This was set to the fixed Wflow <code>basetimestep</code> of 86400 s, and should be set to the actual model time step from the TOML configuration file.</li><li>Add <code>flux</code> from <code>Drainage</code> (<code>GroundwaterFlow</code>) in the <code>sbm_gwf_model</code> to the overland flow component instead of the river component of the kinematic wave.</li><li>Fixed option <code>constanthead = false</code> (TOML file), <code>constant_head</code> field of <code>GroundwaterFlow</code> was not defined in this case. Fixed this by initialising empty fields (Vector) for struct <code>ConstantHead</code>.</li><li>Fixed return max(0, boundary.flux[index]) to return max(0, flux) the flux should be returned when cell is dry, no negative value allowed.</li><li>Fixed path to initialize lake to: dirname(static_path) </li><li>Fixed outflow = 0, when lake level is below lake threshold. Before a negative value could enter the log function and model would fail. </li><li>Fixed the lake storage initialization. For continuation runs (<code>reinit = false</code>), this caused the lake to be reset to the initial conditions instead of the saved state.</li></ul><h2 id="v0.3.1-2021-05-19"><a class="docs-heading-anchor" href="#v0.3.1-2021-05-19">v0.3.1 - 2021-05-19</a><a id="v0.3.1-2021-05-19-1"></a><a class="docs-heading-anchor-permalink" href="#v0.3.1-2021-05-19" title="Permalink"></a></h2><h3 id="Fixed-3"><a class="docs-heading-anchor" href="#Fixed-3">Fixed</a><a class="docs-heading-anchor-permalink" href="#Fixed-3" title="Permalink"></a></h3><ul><li>Ignore extra dimensions in input NetCDFs if they are size 1</li></ul><h2 id="v0.3.0-2021-05-10"><a class="docs-heading-anchor" href="#v0.3.0-2021-05-10">v0.3.0 - 2021-05-10</a><a id="v0.3.0-2021-05-10-1"></a><a class="docs-heading-anchor-permalink" href="#v0.3.0-2021-05-10" title="Permalink"></a></h2><h3 id="Changed-3"><a class="docs-heading-anchor" href="#Changed-3">Changed</a><a class="docs-heading-anchor-permalink" href="#Changed-3" title="Permalink"></a></h3><ul><li>New deposition process for coarse sediment in the reservoirs with a new parameter  <code>restrapefficiency</code> in the sediment model.</li><li>New variables added to the <code>LandSediment</code> and <code>RiverSediment</code> structs in order to save  more output from the sediment model.</li><li>Added variables <code>volume</code> and <code>inwater</code> to <code>SurfaceFlow</code> struct, this is convenient for the coupling with the water quality model Delwaq.</li><li>River water level (<code>h</code>) and discharge (<code>q</code>) forced directly into the <code>RiverSediment</code> struct (instead of using the <code>OverlandFlowSediment</code> struct first). </li><li>Require Julia 1.6 or later.</li></ul><h3 id="Added-3"><a class="docs-heading-anchor" href="#Added-3">Added</a><a class="docs-heading-anchor-permalink" href="#Added-3" title="Permalink"></a></h3><ul><li>Modify model parameters and forcing through the TOML file (see <a href="../config/#Modify-parameters">Modify parameters</a>).</li><li>Run wflow_sbm (SBM + kinematic wave) in two parts (until recharge and after subsurface flow) from BMI, including the option to switch off the lateral subsurface component of wflow_sbm.</li><li>Support more netCDF dimension and axis order variants.</li></ul><h3 id="Fixed-4"><a class="docs-heading-anchor" href="#Fixed-4">Fixed</a><a class="docs-heading-anchor-permalink" href="#Fixed-4" title="Permalink"></a></h3><ul><li>Corrected a bug in sediment deposition in the river (case when incoming sediment load is more than the river transport capacity).</li><li>Fixed update of <code>snow</code> and <code>glacierstore</code> fields of HBV and SBM concepts by the <code>glacier_hbv</code> module. </li></ul><h2 id="v0.2.0-2021-03-26"><a class="docs-heading-anchor" href="#v0.2.0-2021-03-26">v0.2.0 - 2021-03-26</a><a id="v0.2.0-2021-03-26-1"></a><a class="docs-heading-anchor-permalink" href="#v0.2.0-2021-03-26" title="Permalink"></a></h2><h3 id="Changed-4"><a class="docs-heading-anchor" href="#Changed-4">Changed</a><a class="docs-heading-anchor-permalink" href="#Changed-4" title="Permalink"></a></h3><ul><li>Removed dependency of the <code>f</code> model parameter of wflow_sbm on the parameters <span>$\theta_{s}$</span>, <span>$\theta_{r}$</span> and <span>$M$</span>. This approach is used in Topog_SBM, but not applicable for wflow_sbm. The <code>f</code> parameter needs to be provided as part of the NetCDF model parameter file.</li><li>Grid properties as cell length and elevation now stored as part of the <code>model.land.network</code> component and not as part of the vertical model components, as it is not used by these components. <code>altitude</code> (elevation) should now be provided as part of the <code>[input]</code> section of the TOML configuration file, and not as part of the <code>[input.vertical]</code> section.</li><li>Removed parameter <span>$\theta_{e}$</span> from SBM struct (not used in update). Parameters <span>$\theta_{s}$</span> and <span>$\theta_{r}$</span> included separately (instead of <span>$\theta_{e}$</span>) in <code>LateralSSF struct</code>, now directly linked to SBM parameters.</li><li>Improve error messages (NetCDF and cyclic flow graph).</li></ul><h3 id="Added-4"><a class="docs-heading-anchor" href="#Added-4">Added</a><a class="docs-heading-anchor-permalink" href="#Added-4" title="Permalink"></a></h3><ul><li>Export of NetCDF scalar timeseries (separate NetCDF file from gridded timeseries). This also allows for importing these timeseries by Delft-FEWS (General Adapter).</li></ul><h3 id="Fixed-5"><a class="docs-heading-anchor" href="#Fixed-5">Fixed</a><a class="docs-heading-anchor-permalink" href="#Fixed-5" title="Permalink"></a></h3><ul><li>Model parameter Manning&#39;s <code>n</code> now used during the update of the <code>struct SurfaceFlow</code>, to change the related <span>$\alpha$</span> parameter of the kinematic wave for channel flow.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fews/">« Run from Delft-FEWS</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Thursday 7 October 2021 10:35">Thursday 7 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

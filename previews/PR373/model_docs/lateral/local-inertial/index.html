<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Local inertial · Wflow.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/model_docs/lateral/local-inertial/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Wflow.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">About wflow</a></li><li><a class="tocitem" href="../../../intro/use_cases/">Case studies</a></li><li><a class="tocitem" href="../../../intro/publications/">Publications</a></li><li><a class="tocitem" href="../../../changelog/">Changelog</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../../user_guide/intro/">About the user guide</a></li><li><a class="tocitem" href="../../../user_guide/install/">How to install</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">How to use wflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../user_guide/step1_requirements/">Step 1: Understanding the requirements</a></li><li><a class="tocitem" href="../../../user_guide/step2_settings_file/">Step 2: Preparing the settings file</a></li><li><a class="tocitem" href="../../../user_guide/step3_input_data/">Step 3: Preparing the input data</a></li><li><a class="tocitem" href="../../../user_guide/step4_running/">Step 4: Running a simulation</a></li><li><a class="tocitem" href="../../../user_guide/step5_output/">Step 5: Analyzing the model output</a></li><li><a class="tocitem" href="../../../user_guide/additional_options/">Additional wflow options</a></li><li><a class="tocitem" href="../../../user_guide/sample_data/">Example models</a></li></ul></li><li><a class="tocitem" href="../../../user_guide/model-setup/">Building a model from scratch</a></li></ul></li><li><span class="tocitem">Model documentation</span><ul><li><a class="tocitem" href="../../intro/">About the model documentation</a></li><li><a class="tocitem" href="../../model_configurations/">Model configurations</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vertical concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../../vertical/flextopo/">FLEXTopo</a></li><li><a class="tocitem" href="../../vertical/sediment/">Sediment</a></li><li><a class="tocitem" href="../../shared_concepts/">Shared processes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Lateral concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../kinwave/">Kinematic wave</a></li><li class="is-active"><a class="tocitem" href>Local inertial</a><ul class="internal"><li><a class="tocitem" href="#River-and-floodplain-routing"><span>River and floodplain routing</span></a></li><li><a class="tocitem" href="#Overland-flow-(2D)"><span>Overland flow (2D)</span></a></li><li><a class="tocitem" href="#Inflow"><span>Inflow</span></a></li><li><a class="tocitem" href="#Multi-Threading"><span>Multi-Threading</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../waterbodies/">Reservoirs and Lakes</a></li><li><a class="tocitem" href="../sediment_flux/">Sediment flux</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Model parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../params_vertical/">Parameters vertical concepts</a></li><li><a class="tocitem" href="../../params_lateral/">Parameters lateral concepts</a></li><li><a class="tocitem" href="../../structures/">Julia structures</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model documentation</a></li><li><a class="is-disabled">Lateral concepts</a></li><li class="is-active"><a href>Local inertial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Local inertial</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/model_docs/lateral/local-inertial.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="local_inertial"><a class="docs-heading-anchor" href="#local_inertial">Local inertial</a><a id="local_inertial-1"></a><a class="docs-heading-anchor-permalink" href="#local_inertial" title="Permalink"></a></h1><h2 id="River-and-floodplain-routing"><a class="docs-heading-anchor" href="#River-and-floodplain-routing">River and floodplain routing</a><a id="River-and-floodplain-routing-1"></a><a class="docs-heading-anchor-permalink" href="#River-and-floodplain-routing" title="Permalink"></a></h2><p>The local inertial approximation of shallow water flow neglects only the convective acceleration term in the Saint-Venant momentum conservation equation. The numerical solution of the local inertial approximation on a staggered grid is as follows (Bates et al., 2010):</p><p class="math-container">\[Q_{t+\Delta t} = \frac{Q_t - g A_t \Delta t S_t}{(1+g\Delta t n^2 |Q_t| / (R_t^{4/3} A_t))}\]</p><p>where <span>$Q_{t+\Delta t}$</span> is the river flow [m<span>$^3$</span>/s] at time step <span>$t+\Delta t$</span>, <span>$g$</span> is acceleration due to gravity [m/s<span>$^2$</span>], <span>$A_t$</span> is the cross sectional flow area at the previous time step, <span>$R_t$</span> is the hydraulic radius at the previous time step, <span>$Q_t$</span> is the river flow [m<span>$^3$</span>/s] at the previous time step, <span>$S_t$</span> is the water surface slope at the previous time step and <span>$n$</span> is the Manning&#39;s roughness coefficient [m<span>$^{-1/3}$</span> s].</p><p>The momentum equation is applied to each link between two river grid cells, while the continuity equation over <span>$\Delta t$</span> is applied to each river cell:</p><p class="math-container">\[h^{t+\Delta t} = h^t + \Delta t \frac{Q^{t+\Delta t}_{src} - Q^{t+\Delta t}_{dst}}{A}\]</p><p>where <span>$h^{t+\Delta t}$</span> is the water depth [m] at time step <span>$t+\Delta t$</span>, <span>$h^t$</span> is the water depth [m] at the previous time step, <span>$A$</span> is the river area [m<span>$^2$</span>] and <span>$Q_{src}$</span> and <span>$Q_{dst}$</span> represent river flow [m<span>$^3$</span>/s] at the upstream and downstream link of the river cell, respectively.</p><p>The model time step <span>$\Delta t$</span> for the local inertial model is estimated based on the Courant-Friedrichs-Lewy condition (Bates et al., 2010):</p><p class="math-container">\[\Delta t = min(\alpha \frac{\Delta x_i}{\sqrt{(gh_i)}})\]</p><p>where <span>$\sqrt{(gh_i)}$</span> is the wave celerity for river cell <span>$i$</span> , <span>$\Delta x_i$</span> is the river length [m] for river cell <span>$i$</span> and <span>$\alpha$</span> is a coefficient (typically between 0.2 and 0.7) to enhance the stability of the simulation.</p><p>In the TOML file the following properties related to the local inertial model can be provided for the <code>sbm</code> and <code>sbm_gwf</code> model types:</p><pre><code class="language-toml hljs">[model]
river_routing = &quot;local-inertial&quot;  # default is &quot;kinematic-wave&quot;
inertial_flow_alpha = 0.5         # alpha coefficient for model stability (default = 0.7)
froude_limit = true               # default is true, limit flow to subcritical-critical according to Froude number
h_thresh = 0.1                    # water depth [m] threshold for calculating flow between cells (default = 1e-03)
floodplain_1d = true              # include 1D floodplain schematization (default = false)</code></pre><p>Two optional constant boundary conditions <code>riverlength_bc</code> and <code>riverdepth_bc</code> can be provided at a river outlet node (or multiple river outlet nodes) through the model parameter netCDF file, as follows:</p><pre><code class="language-toml hljs">[input.lateral.river]
riverlength_bc = &quot;riverlength_bc&quot;   # optional river length [m], default = 1e04
riverdepth_bc = &quot;riverdepth_bc&quot;     # optional river depth [m], default = 0.0</code></pre><p>These boundary conditions are copied to a ghost node (downstream of the river outlet node) in the code.</p><p>The optional 1D floodplain schematization is based on provided flood volumes as a function of flood depth (per flood depth interval) for each river cell. Wflow calculates from these flood volumes a rectangular floodplain profile for each flood depth interval. Routing is done separately for the river channel and floodplain.</p><p>The momentum equation is most stable for low slope environments, and to keep the simulation stable for (partly) steep environments the <code>froude_limit</code> option is set to true by default. This setting limits flow conditions to subcritical-critical conditions based on the Froude number (<span>$\le 1$</span>), similar to Coulthard et al. (2013) in the CAESAR-LISFLOOD model and Adams et al. (2017) in the Landlab v1.0 OverlandFlow component. The froude number <span>$Fr$</span> on a link is calculated as follows:</p><p class="math-container">\[  Fr = \frac{u}{\sqrt{(gh_f)}}\]</p><p>where <span>$\sqrt{(gh_f)}$</span> is the wave celerity on a link and <span>$u$</span> is the water velocity on a link. If the water velocity from the local inertial model is causing the Froude number to be greater than 1.0, the water velocity (and flow) is reduced in order to maintain a Froude number of 1.0.</p><p>The downstream boundary condition basically simulates a zero water depth boundary condition at a set distance, as follows. For the downstream boundary condition (ghost point) the river width, river bed elevation and Manning&#39;s roughness coefficient are copied from the upstream river cell. The river length [m] of the boundary cell can be set through the TOML file with <code>riverlength_bc</code>, and has a default value of 10 km. The water depth at the boundary cell is fixed at 0.0 m.</p><p>Simplified <a href="../waterbodies/#reservoir_lake">reservoir and lake</a> models can be included as part of the local inertial model for river flow (1D) and river and overland flow combined (see next section). Reservoir and lake models are included as a boundary point with zero water depth for both river and overland flow. For river flow the reservoir or lake model replaces the local inertial model at the reservoir or lake location, and <span>$Q$</span> is set by the outflow from the reservoir or lake. Overland flow at a reservoir or lake location is not allowed to or from the downstream river grid cell.</p><h2 id="Overland-flow-(2D)"><a class="docs-heading-anchor" href="#Overland-flow-(2D)">Overland flow (2D)</a><a id="Overland-flow-(2D)-1"></a><a class="docs-heading-anchor-permalink" href="#Overland-flow-(2D)" title="Permalink"></a></h2><p>For the simulation of 2D overland flow on a staggered grid the numerical scheme proposed by de Almeida et al. (2012) is adopted. The explicit solution for the estimation of water discharge between two cells in the x-direction is of the following form (following the notation of Almeida et al. (2012)):</p><p class="math-container">\[Q_{i-1/2}^{n+1} = \frac{\left[ \theta Q_{i-1/2}^{n} +\frac{(1-\theta)}{2}(Q_{(i-3/2)}^{n} + \\
  Q_{(i+1/2)}^{n})\right]- g h_f \frac{\Delta t}{\Delta x} (\eta^n_i - \eta^n_{i-1}) \Delta y}{1+g\Delta t \\
   n^2 |Q_{i-1/2}^{n}|/(h_f^{7/3} \Delta y)}\]</p><p>where subscripts <span>$i$</span> and <span>$n$</span> refer to space and time indices, respectively. Subscript <span>$i-1/2$</span> is to the link between node <span>$i$</span> and <span>$i-1$</span>, subscript <span>$i+1/2$</span> is the link between node <span>$i$</span> and node <span>$i+1$</span>, and subscript <span>$i-3/2$</span> is the link between node <span>$i-1$</span> and node <span>$i-2$</span>. <span>$Q$</span> is the water discharge [m<span>$^3$</span> s<span>$^{-1}$</span>], <span>$\eta$</span> is the water surface elevation [m], <span>$h_f$</span> [m] is the water depth between cells, <span>$n$</span> is the Manning&#39;s roughness coefficient [m<span>$^{-1/3}$</span> s], <span>$g$</span> is acceleration due to gravity [m/s<span>$^2$</span>], <span>$\Delta t$</span> [s] is the adaptive model time step, <span>$\Delta x$</span> [m] is the distance between two cells and <span>$\Delta y$</span> [m] is the flow width. Below the staggered grid and variables of the numerical solution in the x-direction, based on Almeida et al. (2012):</p><p><img src="../../../images/numerical_scheme_almeida.png" alt="numerical_scheme_almeida"/></p><p>The overland flow local inertial approach is used in combination with the local inertial river routing. This is a similar to the modelling approach of Neal et al. (2012), where the hydraulic model LISFLOOD-FP was extended with a subgrid channel model. For the subgrid channel, Neal et al. (2012) make use of a D4 (four direction) scheme, while here a D8 (eight direction) scheme is used, in combination with the D4 scheme for 2D overland flow.</p><p>In the TOML file the following properties related to the local inertial model with 1D river routing and 2D overland flow can be provided for the <code>sbm</code> model type:</p><pre><code class="language-toml hljs">[model]
land_routing = &quot;local-inertial&quot;  # default is kinematic-wave
river_routing = &quot;local-inertial&quot; # default is kinematic-wave
inertial_flow_alpha = 0.5        # alpha coefficient for model stability (default = 0.7)
froude_limit = true              # default is true, limit flow to subcritical-critical according to Froude number
h_thresh = 0.1                   # water depth [m] threshold for calculating flow between cells (default = 1e-03)</code></pre><p>The properties <code>inertial_flow_alpha</code>, <code>froude_limit</code> and <code>h_thresh</code> apply to 1D river routing as well as 2D overland flow. The properties <code>inertial_flow_alpha</code> and <code>froude_limit</code>, and the adaptive model time step <span>$\Delta t$</span> are explained in more detail in the <a href="model_docs/lateral/@ref">River routing</a> section of the local inertial model.</p><h2 id="Inflow"><a class="docs-heading-anchor" href="#Inflow">Inflow</a><a id="Inflow-1"></a><a class="docs-heading-anchor-permalink" href="#Inflow" title="Permalink"></a></h2><p>External water (supply/abstraction) <code>inflow</code> [m<span>$^3$</span> s<span>$^{-1}$</span>]  can be added to the local inertial model for river flow (1D) and river and overland flow combined (1D-2D), as a cyclic parameter or as part of forcing (see also <a href="../../../user_guide/step2_settings_file/#Input-section">Input section</a>).</p><h2 id="Multi-Threading"><a class="docs-heading-anchor" href="#Multi-Threading">Multi-Threading</a><a id="Multi-Threading-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Threading" title="Permalink"></a></h2><p>The local inertial model for river flow (1D) and river and overland flow combined (1D-2D) can be executed in parallel using multiple threads.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Adams, J. M., Gasparini, N. M., Hobley, D. E. J., Tucker, G. E., Hutton, E. W. H., Nudurupati, S. S., and Istanbulluoglu, E., 2017, The Landlab v1.0 OverlandFlow component: a Python tool for computing shallow-water flow across watersheds, Geosci. Model Dev., 10, 1645–1663, <a href="https://doi.org/10.5194/gmd-10-1645-2017">https://doi.org/10.5194/gmd-10-1645-2017</a>.</li><li>de Almeida, G. A. M., P. Bates, J. E. Freer, and M. Souvignet, 2012, Improving the stability of a simple formulation of the shallow water equations for 2-D flood modeling, Water Resour. Res., 48, W05528, <a href="https://doi.org/10.1029/2011WR011570">https://doi.org/10.1029/2011WR011570</a>.</li><li>Bates, P. D., M. S. Horritt, and T. J. Fewtrell, 2010, A simple inertial formulation of the shallow water equations for efficient two-dimensional flood inundation modelling, J. Hydrol., 387, 33–45, <a href="https://doi.org/10.1016/j.jhydrol.2010.03.027">https://doi.org/10.1016/j.jhydrol.2010.03.027</a>.</li><li>Coulthard, T. J., Neal, J. C., Bates, P. D., Ramirez, J., de Almeida, G. A. M., and Hancock, G. R., 2013, Integrating the LISFLOOD-FP 2- D hydrodynamic model with the CAESAR model: implications for modelling landscape evolution, Earth Surf. Proc. Land., 38, 1897–1906, <a href="https://doi.org/10.1002/esp.3478">https://doi.org/10.1002/esp.3478</a>.</li><li>Neal, J., G. Schumann, and P. Bates (2012), A subgrid channel model for simulating river hydraulics and floodplaininundation over large and data sparse areas, Water Resour.Res., 48, W11506, <a href="https://doi.org/10.1029/2012WR012514">https://doi.org/10.1029/2012WR012514</a>.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kinwave/">« Kinematic wave</a><a class="docs-footer-nextpage" href="../waterbodies/">Reservoirs and Lakes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 4 April 2024 14:54">Thursday 4 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>HBV · Wflow.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/model_docs/vertical/hbv/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Wflow.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">About wflow</a></li><li><a class="tocitem" href="../../../intro/use_cases/">Case studies</a></li><li><a class="tocitem" href="../../../intro/publications/">Publications</a></li><li><a class="tocitem" href="../../../changelog/">Changelog</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../../user_guide/intro/">About the user guide</a></li><li><a class="tocitem" href="../../../user_guide/install/">How to install</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">How to use wflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../user_guide/step1_requirements/">Step 1: Understanding the requirements</a></li><li><a class="tocitem" href="../../../user_guide/step2_settings_file/">Step 2: Preparing the settings file</a></li><li><a class="tocitem" href="../../../user_guide/step3_input_data/">Step 3: Preparing the input data</a></li><li><a class="tocitem" href="../../../user_guide/step4_running/">Step 4: Running a simulation</a></li><li><a class="tocitem" href="../../../user_guide/step5_output/">Step 5: Analyzing the model output</a></li><li><a class="tocitem" href="../../../user_guide/additional_options/">Additional wflow options</a></li><li><a class="tocitem" href="../../../user_guide/sample_data/">Example models</a></li></ul></li><li><a class="tocitem" href="../../../user_guide/model-setup/">Building a model from scratch</a></li></ul></li><li><span class="tocitem">Model documentation</span><ul><li><a class="tocitem" href="../../intro/">About the model documentation</a></li><li><a class="tocitem" href="../../model_configurations/">Model configurations</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vertical concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../sbm/">SBM</a></li><li class="is-active"><a class="tocitem" href>HBV</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Snow"><span>Snow</span></a></li><li><a class="tocitem" href="#Glaciers"><span>Glaciers</span></a></li><li><a class="tocitem" href="#Potential-Evaporation"><span>Potential Evaporation</span></a></li><li><a class="tocitem" href="#Interception"><span>Interception</span></a></li><li><a class="tocitem" href="#The-soil-routine"><span>The soil routine</span></a></li><li><a class="tocitem" href="#The-runoff-response-routine"><span>The runoff response routine</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../flextopo/">FLEXTopo</a></li><li><a class="tocitem" href="../sediment/">Sediment</a></li><li><a class="tocitem" href="../../shared_concepts/">Shared processes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Lateral concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lateral/gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../../lateral/kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../../lateral/local-inertial/">Local inertial</a></li><li><a class="tocitem" href="../../lateral/waterbodies/">Reservoirs and Lakes</a></li><li><a class="tocitem" href="../../lateral/sediment_flux/">Sediment flux</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Model parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../params_vertical/">Parameters vertical concepts</a></li><li><a class="tocitem" href="../../params_lateral/">Parameters lateral concepts</a></li><li><a class="tocitem" href="../../structures/">Julia structures</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model documentation</a></li><li><a class="is-disabled">Vertical concepts</a></li><li class="is-active"><a href>HBV</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>HBV</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/model_docs/vertical/hbv.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="vert_hbv"><a class="docs-heading-anchor" href="#vert_hbv">HBV</a><a id="vert_hbv-1"></a><a class="docs-heading-anchor-permalink" href="#vert_hbv" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This section describes the different vertical processes available as part of the vertical HBV concept. This concept is part of the wflow_hbv model.</p><h2 id="Snow"><a class="docs-heading-anchor" href="#Snow">Snow</a><a id="Snow-1"></a><a class="docs-heading-anchor-permalink" href="#Snow" title="Permalink"></a></h2><p>The snow model is described in <a href="../../shared_concepts/#snow_and_glac">Snow and glaciers</a>.</p><h2 id="Glaciers"><a class="docs-heading-anchor" href="#Glaciers">Glaciers</a><a id="Glaciers-1"></a><a class="docs-heading-anchor-permalink" href="#Glaciers" title="Permalink"></a></h2><p>Glacier processes are described in <a href="../../shared_concepts/#snow_and_glac">Snow and glaciers</a>. Glacier modelling is enabled by specifying the following in the TOML file:</p><pre><code class="language-toml hljs">[model]
glacier = true</code></pre><h2 id="Potential-Evaporation"><a class="docs-heading-anchor" href="#Potential-Evaporation">Potential Evaporation</a><a id="Potential-Evaporation-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-Evaporation" title="Permalink"></a></h2><p>The <code>cevpf</code> model parameter is used to adjust the potential evaporation based on land use. In the original HBV version <code>cevpfo</code> is used, a factor for forest land use only.</p><h2 id="Interception"><a class="docs-heading-anchor" href="#Interception">Interception</a><a id="Interception-1"></a><a class="docs-heading-anchor-permalink" href="#Interception" title="Permalink"></a></h2><p>For interception storage a single <code>icf</code> parameter is used according to the land use. In this implementation interception evaporation is subtracted to ensure total evaporation does not exceed potential evaporation. From this storage evaporation equal to the potential evaporation rate will occur as long as water is available, even if it is stored as snow. All water enters this store first, there is no concept of free throughfall (e.g. through gaps in the canopy). In the model a running water budget is kept of the interception store:</p><ul><li>The available storage (<code>icf</code>- actual storage) is filled with the water coming from the snow routine (<span>$Q_{in}$</span>)</li><li>Any surplus water now becomes the new <span>$Q_{in}$</span></li><li>Interception evaporation is determined as the minimum of the current interception storage and the potential evaporation</li></ul><h2 id="The-soil-routine"><a class="docs-heading-anchor" href="#The-soil-routine">The soil routine</a><a id="The-soil-routine-1"></a><a class="docs-heading-anchor-permalink" href="#The-soil-routine" title="Permalink"></a></h2><p>The incoming water from the snow and interception routines, <span>$Q_{in}$</span>, is available for infiltration in the soil routine. The soil layer has a limited capacity, <code>fc</code>, to hold soil water, which means if <code>fc</code> is exceeded the abundant water cannot infiltrate and, consequently, becomes directly available for runoff.</p><p class="math-container">\[    Q_{dr}=max((SM+Q_{in}−fc);0.0)\]</p><p>where <span>$Q_{dr}$</span> is the abundant soil water (also referred to as direct runoff) and <span>$SM$</span> is the soil moisture content. Consequently, the net amount of water that infiltrates into the soil, <span>$I_{net}$</span>, equals:</p><p class="math-container">\[I_{net} = Q_{in} − Q_{dr}\]</p><p>Part of the infiltrating water, <span>$I_{net}$</span>, will runoff through the soil layer (seepage). This runoff volume, <span>$SP$</span>, is related to the soil moisture content, <span>$SM$</span>, through the following power relation:</p><p class="math-container">\[SP = \left(\frac{SM}{fc}\right)^\beta I_{net}\]</p><p>where <span>$\beta$</span> is an empirically based parameter. Application of this equation implies that the amount of seepage water increases with increasing soil moisture content. The fraction of the infiltrating water which does not runoff, <span>$I_{net}−SP$</span>, is added to the available amount of soil moisture, <span>$SM$</span>. The <span>$\beta$</span> parameter affects the amount of supply to the soil moisture reservoir that is transferred to the quick response reservoir. Values of <span>$\beta$</span> vary generally between 1 and 3. Larger values of <span>$\beta$</span> reduce runoff and indicate a higher absorption capacity of the soil.</p><p><img src="../../../images/hbv-soilmoist.png" alt="hbv-soilmoist.png"/></p><p><em>Schematic view of the soil moisture routine</em></p><p>A percentage of the soil moisture will evaporate. This percentage is related to the potential evaporation and the available amount of soil moisture:</p><p class="math-container">\[    E_a = \frac{SM}{T_m} E_p \, ; \, SM&lt;T_m \\~\\
    E_a = E_p \, ; \, SM \geq T_m\]</p><p>where <span>$E_a$</span> is the actual evaporation, <span>$E_p$</span> is the potential evaporation and <span>$T_m$</span> (<span>$\leq fc$</span>) is a user defined threshold, above which the actual evaporation equals the potential evaporation. <span>$T_m$</span> is defined as <span>$LP * fc$</span> in which <span>$LP$</span> is a soil dependent evaporation factor (<span>$LP\leq 1$</span>).</p><p>In the original model (Bergström, 1992), a correction to <span>$E_a$</span> is applied in case of interception. If <span>$E_a$</span> from the soil moisture storage plus <span>$E_i$</span> exceeds <span>$ET_p−E_i$</span> (<span>$E_i$</span> = interception evaporation) then the exceeding part is multiplied by a factor (<span>$1-e_{red}$</span>), where the parameter <span>$e_{red}$</span> varies between 0 and 1. This correction is not present in the wflow_hbv model.</p><h2 id="The-runoff-response-routine"><a class="docs-heading-anchor" href="#The-runoff-response-routine">The runoff response routine</a><a id="The-runoff-response-routine-1"></a><a class="docs-heading-anchor-permalink" href="#The-runoff-response-routine" title="Permalink"></a></h2><p>The volume of water which becomes available for runoff, <span>$S_{dr}+SP$</span>, is transferred to the runoff response routine. In this routine the runoff delay is simulated through the use of a number of linear reservoirs.</p><p>Two linear reservoirs are defined to simulate the different runoff processes: the upper zone (generating quick runoff and interflow) and the lower zone (generating slow runoff). The available runoff water from the soil routine (i.e. direct runoff, <span>$S_{dr}$</span>, and seepage, <span>$SP$</span>) in principle ends up in the lower zone, unless the percolation threshold, <span>$PERC$</span>, is exceeded, in which case the redundant water ends up in the upper zone:</p><p class="math-container">\[\Delta V_{LZ}=min(PERC;(S_{dr}+SP)) \\~\\
\Delta V_{UZ}=max(0.0;(S_{dr}+SP−PERC))\]</p><p>where <span>$V_{UZ}$</span> is the content of the upper zone, <span>$V_{LZ}$</span> is the content of the lower zone.</p><p>Capillary flow from the upper zone to the soil moisture reservoir is modeled according to:</p><p class="math-container">\[Q_{cf}=cflux \; (fc−SM)/fc\]</p><p>where <span>$cflux$</span> is the maximum capillary flux [mm day<span>$^{-1}$</span>].</p><p>The upper zone generates quick runoff (<span>$Q_q$</span>) using:</p><p class="math-container">\[Q_q=K \, UZ^{(1+\alpha)}\]</p><p>where <span>$K$</span> is the upper zone recession coefficient, and <span>$\alpha$</span> determines the amount of non-linearity. Within HBV-96, the value of <span>$K$</span> is determined from three other parameters: <span>$\alpha$</span>, <span>$KHQ$</span>, and <span>$HQ$</span> [mm day<span>$^{-1}$</span>]. The value of <span>$HQ$</span> represents an outflow rate of the upper zone for which the recession rate is equal to <span>$KHQ$</span>. If we define <span>$UZ_{HQ}$</span> to be the content of the upper zone at outflow rate <span>$HQ$</span> we can write the following equation:</p><p class="math-container">\[    HQ=K \cdot UZ^{(1+\alpha)} = KHQ \cdot UZ_{HQ}\]</p><p>If we eliminate <span>$UZ_{HQ}$</span> we obtain:</p><p class="math-container">\[    HQ = K \left(\frac{HQ}{KHQ}\right)^{(1+\alpha)}\]</p><p>Rewriting for <span>$K$</span> results in:</p><p class="math-container">\[    K = KQH^{(1−\alpha)} HQ^{−\alpha}\]</p><p>The lower zone is a linear reservoir, which means the rate of slow runoff, <span>$Q_{LZ}$</span>, which leaves this zone during one time step equals:</p><p class="math-container">\[Q_{LZ} = K_{LZ} \, V_{LZ}\]</p><p>where <span>$K_{LZ}$</span> is the reservoir constant.</p><p>The upper zone is also a linear reservoir, but it is slightly more complicated than the lower zone because it is divided into two zones: a lower part in which interflow is generated and an upper part in which quick flow is generated.</p><p><img src="../../../images/hbv-upper.png" alt="hbv-upper"/></p><p><em>Schematic view of the upper zone</em></p><p>If the total water content of the upper zone, <span>$V_{UZ}$</span> is lower than a threshold <span>$UZ1$</span>, the upper zone only generates interflow. On the other hand, if <span>$V_{UZ}$</span> exceeds <span>$UZ1$</span>, part of the upper zone water will runoff as quick flow:</p><p class="math-container">\[    Q_i = K_i min(UZ1;V_{uz})\\
    Q_q = K_q max((V_{UZ}−UZ1);0.0)\]</p><p>Where <span>$Q_i$</span> is the amount of generated interflow in one time step, <span>$Q_q$</span> is the amount of generated quick flow in one time step and <span>$K_i$</span> and <span>$K_q$</span> are reservoir constants for interflow and quick flow respectively.</p><p>The total runoff rate, <span>$Q$</span>, is equal to the sum of the three different runoff components:</p><p class="math-container">\[    Q = Q_{LZ}+Q_i+Q_q\]</p><p>The runoff behavior in the runoff response routine is controlled by two threshold values <span>$P_m$</span> and <span>$UZ1$</span> in combination with three reservoir parameters, <span>$K_{LZ}$</span>, <span>$K_i$</span> and <span>$K_q$</span>.</p><p>In order to represent the differences in delay times between the three runoff components, the reservoir constants have to meet the following requirement:</p><p class="math-container">\[    K_{LZ}&lt;K_i&lt;K_q\]</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Bergström, S., 1992, The HBV model–its structure and applications, SMHI Reports RH 4, Norrköping.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sbm/">« SBM</a><a class="docs-footer-nextpage" href="../flextopo/">FLEXTopo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 12 March 2024 12:12">Tuesday 12 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

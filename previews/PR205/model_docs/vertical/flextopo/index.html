<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>FLEXTopo · Wflow.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/model_docs/vertical/flextopo/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Wflow.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">About wflow</a></li><li><a class="tocitem" href="../../../intro/use_cases/">Case studies</a></li><li><a class="tocitem" href="../../../intro/publications/">Publications</a></li><li><a class="tocitem" href="../../../changelog/">Changelog</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../../user_guide/intro/">About the user guide</a></li><li><a class="tocitem" href="../../../user_guide/install/">How to install</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">How to use wflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../user_guide/step1_requirements/">Step 1: Understanding the requirements</a></li><li><a class="tocitem" href="../../../user_guide/step2_settings_file/">Step 2: Preparing the settings file</a></li><li><a class="tocitem" href="../../../user_guide/step3_input_data/">Step 3: Preparing the input data</a></li><li><a class="tocitem" href="../../../user_guide/step4_running/">Step 4: Running a simulation</a></li><li><a class="tocitem" href="../../../user_guide/step5_output/">Step 5: Analyzing the model output</a></li><li><a class="tocitem" href="../../../user_guide/additional_options/">Additional wflow options</a></li><li><a class="tocitem" href="../../../user_guide/sample_data/">Example models</a></li></ul></li><li><a class="tocitem" href="../../../user_guide/model-setup/">Building a model from scratch</a></li></ul></li><li><span class="tocitem">Model documentation</span><ul><li><a class="tocitem" href="../../intro/">About the model documentation</a></li><li><a class="tocitem" href="../../model_configurations/">Model configurations</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vertical concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../sbm/">SBM</a></li><li><a class="tocitem" href="../hbv/">HBV</a></li><li class="is-active"><a class="tocitem" href>FLEXTopo</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Snow"><span>Snow</span></a></li><li><a class="tocitem" href="#Glaciers"><span>Glaciers</span></a></li><li><a class="tocitem" href="#Correction-factors-for-forcing-data"><span>Correction factors for forcing data</span></a></li><li><a class="tocitem" href="#Interception"><span>Interception</span></a></li><li><a class="tocitem" href="#Hortonion-ponding-and-runoff"><span>Hortonion ponding and runoff</span></a></li><li><a class="tocitem" href="#Root-zone-soil-moisture"><span>Root zone soil moisture</span></a></li><li><a class="tocitem" href="#Fast-storage-and-runoff"><span>Fast storage and runoff</span></a></li><li><a class="tocitem" href="#Common-slow-groundwater-storage-and-runoff"><span>Common slow groundwater storage and runoff</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../sediment/">Sediment</a></li><li><a class="tocitem" href="../../shared_concepts/">Shared processes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Lateral concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lateral/gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../../lateral/kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../../lateral/local-inertial/">Local inertial</a></li><li><a class="tocitem" href="../../lateral/sediment_flux/">Sediment flux</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Model parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../params_vertical/">Parameters vertical concepts</a></li><li><a class="tocitem" href="../../params_lateral/">Parameters lateral concepts</a></li><li><a class="tocitem" href="../../structures/">Julia structures</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model documentation</a></li><li><a class="is-disabled">Vertical concepts</a></li><li class="is-active"><a href>FLEXTopo</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>FLEXTopo</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/model_docs/vertical/flextopo.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="vert_flextopo"><a class="docs-heading-anchor" href="#vert_flextopo">FLEXTopo</a><a id="vert_flextopo-1"></a><a class="docs-heading-anchor-permalink" href="#vert_flextopo" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This section describes the different vertical processes available as part of the vertical FLEXTopo concept. This concept is part of the wflow_flextopo model. The FLEXTopo model is a process-based model, which consists of different parallel classes connected through their groundwater storage. These classes are usually delineated from topographical data to represent the variability in hydrological processes across user-defined Hydrological Response Units (HRU). The main assumption underlying the concept, which was first introduced by Savenije (2010), is that different parts of the landscape fulfill different tasks in runoff generation and, hence, can be represented by different model structures. Commonly used classes include hillslopes, plateau and wetlands. Hillslopes are often forested and characterized by subsurface flow. Plateaus are defined as relatively flat and elevated areas, suitable for  agriculture, and are mainly driven by deep percolation and hortonian overland flow. Saturation overland flow and capillary rise are the dominant processes on the riparian wetland class. However, the strength of the concept is that the definition of classes and associated model structures is modular and flexible and not constrained by a predefined fixed model structure. The flexible approach allows to develop process-based models for different topographic, climatic, geologic and land use conditions, making use of the available data and expert knowledge. </p><p>In wflow_flextopo, the user is free to determine the number of classes and which processes and/or parameters to include or exclude for each class. For each cell in the model domain, the percentage of each class in the cell is provided by the user. The most complete model structure implemented in wflow_flextopo is shown in the figure below. However, it is also possible to bypass each bucket or to deactivate processes through parameter values (see <a href="../../model_configurations/#config_flextopo">FLEXTopo configuration</a>). When defining several classes, the model structures for each class are implemented in parallel, except for the common glacier, snow and groundwater processes, which are not class specific. An example of a three classes model is also shown in the Figure below. </p><p><img src="../../../images/flextopo_julia_1class.png" alt="flextopo_julia_1class.png"/>  <em>Schematic representation of the FLEXTopo model for a single class model including all storages and fluxes. Main parameters are denoted in red.</em></p><p><img src="../../../images/flextopo_julia_3class.png" alt="flextopo_julia_3class.png"/>  <em>Example of a three class model with different model structure configurations per class</em></p><p>The descriptions below of each of the FLEXTopo model components are given for the most complete model structure with the symbols as shown in the schematic representation of the one class model in the Figure above. By bypassing storages and/or setting parameters to specific values, the model structure can be adapted to a user-defined model structure. </p><h2 id="Snow"><a class="docs-heading-anchor" href="#Snow">Snow</a><a id="Snow-1"></a><a class="docs-heading-anchor-permalink" href="#Snow" title="Permalink"></a></h2><p>The snow model is described in <a href="../../shared_concepts/#snow_and_glac">Snow and glaciers</a>.</p><h2 id="Glaciers"><a class="docs-heading-anchor" href="#Glaciers">Glaciers</a><a id="Glaciers-1"></a><a class="docs-heading-anchor-permalink" href="#Glaciers" title="Permalink"></a></h2><p>Glacier processes are described in <a href="../../shared_concepts/#snow_and_glac">Snow and glaciers</a>. Glacier modelling is enabled by specifying the following in the TOML file:</p><pre><code class="language-toml hljs">[model]
glacier = true</code></pre><h2 id="Correction-factors-for-forcing-data"><a class="docs-heading-anchor" href="#Correction-factors-for-forcing-data">Correction factors for forcing data</a><a id="Correction-factors-for-forcing-data-1"></a><a class="docs-heading-anchor-permalink" href="#Correction-factors-for-forcing-data" title="Permalink"></a></h2><p>The <span>$e_\mathrm{corr}$</span> and <span>$p_\mathrm{corr}$</span>  model parameters can be used to adjust the potential evaporation and precipitation, respectively. </p><h2 id="Interception"><a class="docs-heading-anchor" href="#Interception">Interception</a><a id="Interception-1"></a><a class="docs-heading-anchor-permalink" href="#Interception" title="Permalink"></a></h2><p>After the snow module, rainfall <span>$P_\mathrm{R}$</span> [mm t<span>$^{-1}$</span>] and snowmelt <span>$P_\mathrm{M}$</span> [mm t<span>$^{-1}$</span>] enter the interception storage <span>$S_\mathrm{I}$</span> [mm]. The maximum interception storage is defined by the <span>$I_\mathrm{max}$</span> [mm] parameter for each class. Interception evaporation <span>$E_\mathrm{I}$</span> [mm t<span>$^{-1}$</span>] occurs at potential rate <span>$E_\mathrm{P}$</span> [mm t<span>$^{-1}$</span>] as long as there is enough water in the interception storage. Effective precipitation <span>$P_\mathrm{E}$</span> [mm t<span>$^{-1}$</span>] flows out of the interception store when the storage capacity is exceeded.  Interception evaporation is subtracted from potential evaporation to ensure total evaporation does not exceed potential evaporation. </p><p>The following equations apply: </p><p class="math-container">\[    \mathrm{d}S_\mathrm{I}/\mathrm{d}t = (P_\mathrm{R} + P_\mathrm{M}) - E_\mathrm{I} - P_\mathrm{E}\]</p><p class="math-container">\[    P_\mathrm{E} = \mathrm{max}(0, (S_\mathrm{I} - I_\mathrm{max})/\mathrm{d}t)\]</p><p class="math-container">\[    E_\mathrm{I} = \mathrm{min}(E_\mathrm{P}, S_\mathrm{I}/\mathrm{d}t)\]</p><h2 id="Hortonion-ponding-and-runoff"><a class="docs-heading-anchor" href="#Hortonion-ponding-and-runoff">Hortonion ponding and runoff</a><a id="Hortonion-ponding-and-runoff-1"></a><a class="docs-heading-anchor-permalink" href="#Hortonion-ponding-and-runoff" title="Permalink"></a></h2><p>Hortonian overland flow processes are represented by a combination of two storages: a horton ponding storage (<span>$S_\mathrm{Hp}$</span> [mm]) and a runoff generating storage (<span>$S_\mathrm{Hf}$</span> [mm]). This conceptualization was introduced by de Boer-Euser (2017) and included in the plateau class to represent hortonian overland flow (infiltration excess overland flow) in agricultural fields. When the storage capacity of the ponding storage is exceeded, runoff <span>$Q_\mathrm{H}$</span> [mm t<span>$^{-1}$</span>] is generated that enters the horton runoff storage. The horton runoff generating storage is included to slightly smooth the precipitation signal. However, the response time of the runoff generation storage is very short (<span>$K_\mathrm{Hf}$</span> [t<span>$^{-1}$</span>]) to generate fast runoff <span>$Q_\mathrm{Hf}$</span> [mm t<span>$^{-1}$</span>]. </p><p>Effective precipitation <span>$P_\mathrm{E}$</span> [mm t<span>$^{-1}$</span>] from the interception module enters the horton ponding storage, which has a maximum storage capacity <span>$S_\mathrm{Hmax}$</span> [mm]. When the inflow exceeds the storage capacity, direct runoff is generated (<span>$Q_\mathrm{H,direct}$</span> [mm t<span>$^{-1}$</span>]) and net infiltration in the horton ponding storage is denoted as <span>$Q_\mathrm{H,in,net}$</span> [mm t<span>$^{-1}$</span>]. </p><p>Evaporation from the horton ponding storage <span>$E_\mathrm{H}$</span> [mm t<span>$^{-1}$</span>]  is based on a simple formulation to express water stress. The equation describes how actual evaporation is linearly reduced when the relative horton ponding storage (<span>$\overline{S_\mathrm{Hp}}$</span> [-]) is below a certain threshold (<span>$L_\mathrm{P}$</span> [-] parameter).</p><p>A beta function with parameter <span>$\beta$</span> [-] is used to split the net infiltrating water to storage and to runoff <span>$Q_\mathrm{H}$</span> [mm t<span>$^{-1}$</span>], to which is added the direct runoff (<span>$Q_\mathrm{H,direct}$</span> [mm t<span>$^{-1}$</span>]). </p><p>The shape of the beta function for various values of <span>$\beta$</span> [-] is shown below:</p><pre><code class="language-julia hljs">using Plots
x = 0:0.1:1.0
beta1 = 0.3
beta2 = 1.0
beta3 = 3.0

y1 =  (1 .- (1 .- x).^beta1)
y2 =  (1 .- (1 .- x).^beta2)
y3 =  (1 .- (1 .- x).^beta3)

plot(x,y1, label = &quot;beta = 0.3&quot;, xlabel = &quot;S/Smax&quot;, ylabel = &quot;Fraction of runoff&quot;)
plot!(x,y2, label = &quot;beta = 1.0&quot;)
plot!(x,y3, label = &quot;beta = 3.0&quot;)</code></pre><p>Additionally, water infiltrates from the horton ponding storage to the root zone storage (<span>$Q_\mathrm{HR}$</span> [mm t<span>$^{-1}$</span>]), based on a formulation using a maximum infiltration capacity (<span>$F_\mathrm{max}$</span> [mm t<span>$^{-1}$</span>]) and a decay coefficient (<span>$F_\mathrm{dec}$</span> [-]). </p><p>The maximum storage capacity of the horton ponding storage is reduced when soils are likely to be frozen <span>$S_\mathrm{Hmax,frost}$</span> [mm], i.e. during periods when the temperature is below zero for several consecutive days. </p><p>The following equations apply for the Horton ponding storage (<span>$S_\mathrm{Hp}$</span> [mm]): </p><p class="math-container">\[    \mathrm{d}S_\mathrm{Hp}/\mathrm{d}t = P_\mathrm{E} - E_\mathrm{H}  - Q_\mathrm{H} - Q_\mathrm{HR} \]</p><p>The constitutive equations are:</p><p class="math-container">\[    Q_\mathrm{H,direct}=\mathrm{max}((S_\mathrm{Hp}+P_\mathrm{E}−S_\mathrm{Hmax});0.0)\]</p><p class="math-container">\[    Q_\mathrm{H,in,net} = P_\mathrm{E} − Q_\mathrm{H,direct}\]</p><p class="math-container">\[    \overline{S_\mathrm{Hp}} = S_\mathrm{Hp}/S_\mathrm{H,max}\]</p><p class="math-container">\[    E_\mathrm{H} = \mathrm{min} ( (E_\mathrm{P} - E_\mathrm{I}) \cdot \mathrm{min}(\overline{S_\mathrm{Hp}}/L_\mathrm{P},1), S_\mathrm{Hp}/\mathrm{d}t  )\]</p><p class="math-container">\[    Q_\mathrm{H} = Q_\mathrm{H,in,net} \cdot (1-(1-\overline{S_\mathrm{Hp}})^\beta)\]</p><p class="math-container">\[    Q_\mathrm{HR} = F_\mathrm{max} \cdot \mathrm{exp}(-F_\mathrm{dec} \cdot \overline{S_\mathrm{Hp}})\]</p><p>The reduction of the storage capacity of the horton ponding storage during frozen soil conditions is calculated following the equations provided by de Boer-Euser (2017):</p><p class="math-container">\[    S_\mathrm{Hmax,frost} = F_\mathrm{T} \cdot S_\mathrm{Hmax}\]</p><p>with:</p><p class="math-container">\[F_\mathrm{T} =
    \begin{cases}
      S_\mathrm{Hmin} &amp; \text{if $F_\mathrm{acc,fr} &lt; F_\mathrm{acc,fr0}$}\\
      \frac{F_\mathrm{acc}}{F_\mathrm{acc,fr1} - F_\mathrm{acc,fr0}} - \frac{F_\mathrm{acc,fr0}}{F_\mathrm{acc,fr1} - F_\mathrm{acc,fr0}}  &amp; \text{if $ F_\mathrm{acc,fr0} \le F_\mathrm{acc,fr} \le F_\mathrm{acc,fr1}$}\\
      1 &amp; \text{if $F_\mathrm{acc,fr} &gt; F_\mathrm{acc,fr,1}$}
    \end{cases}   \]</p><p>where <span>$S_\mathrm{Hmin}$</span> [-], <span>$F_\mathrm{acc,fr0}$</span> [degree t], <span>$F_\mathrm{acc,fr1}$</span> [degree t] and <span>$K_\mathrm{mf}$</span> [-] are all model parameters to describe: a coefficient to reduce <span>$S_\mathrm{Hmax}$</span> to a minimum storage capacity, the minimum and maximum modelled accumulated frost and a melt coefficient for the frozen topsoil, respectively.</p><p>The following equations apply for the Horton fast runoff storage (<span>$S_\mathrm{Hf}$</span> [mm]): </p><p class="math-container">\[    \mathrm{d}S_\mathrm{Hf}/\mathrm{d}t = Q_\mathrm{H} - Q_\mathrm{Hf}\]</p><p class="math-container">\[    Q_\mathrm{Hf} = K_\mathrm{Hf}^{-1} \cdot S_\mathrm{Hf}\]</p><h2 id="Root-zone-soil-moisture"><a class="docs-heading-anchor" href="#Root-zone-soil-moisture">Root zone soil moisture</a><a id="Root-zone-soil-moisture-1"></a><a class="docs-heading-anchor-permalink" href="#Root-zone-soil-moisture" title="Permalink"></a></h2><p>The incoming water from the interception and hortonian routines <span>$Q_\mathrm{HR}$</span> [mm t<span>$^{-1}$</span>] enters the root zone storage <span>$S_\mathrm{R}$</span> [mm]. The root zone storage has a maximum capacity <span>$S_\mathrm{Rmax}$</span> [mm], which represents the volume of water in the unsaturated root zone, which is available to the roots of vegetation for transpiration. Abundant water which exceeds the capacity of the root zone storage cannot infiltrate and becomes directly available for runoff (<span>$Q_\mathrm{R,direct}$</span> [mm t<span>$^{-1}$</span>]). The net infiltration in the root zone storage is denoted as <span>$Q_\mathrm{R,in,net}$</span> [mm t<span>$^{-1}$</span>]. </p><p>A simple formulation to express water stress is used to calculate evaporation <span>$E_\mathrm{R}$</span> [mm t<span>$^{-1}$</span>] from the root zone storage. The equation describes how actual evaporation is linearly reduced when the relative root zone storage (<span>$\overline{S_\mathrm{R}}$</span> [-]) is below a certain threshold (<span>$L_\mathrm{P}$</span> [-] parameter). </p><p>Next, a beta function with parameter <span>$\beta$</span> [-] describes the partitioning of incoming water to the root zone storage and to runoff <span>$Q_\mathrm{R}$</span> [mm t<span>$^{-1}$</span>]. The water that leaves the root zone storage is partitioned into the fast storage and through preferential recharge to the slow storage, based on a splitter parameter <span>$d_\mathrm{s}$</span> [-].  </p><p>Water may also leave the root zone storage through percolation to the slow groundwater <span>$Q_\mathrm{perc}$</span> [mm t<span>$^{-1}$</span>] or enter the root zone storage from the slow groundwater through capillary rise <span>$Q_\mathrm{cap}$</span> [mm t<span>$^{-1}$</span>], based on a maximum percolation parameter (<span>$Q_\mathrm{perc,max}$</span> [mm t<span>$^{-1}$</span>]) and a maximum capillary rise flux parameter (<span>$Q_\mathrm{cap,max}$</span> [mm t<span>$^{-1}$</span>]). </p><p>The water balance equation for the root zone storage is:</p><p class="math-container">\[    \mathrm{d}S_\mathrm{R}/\mathrm{d}t = Q_\mathrm{HR} - E_\mathrm{R}  - Q_\mathrm{R} - Q_\mathrm{perc} + Q_\mathrm{cap}\]</p><p>The constitutive equations are:</p><p class="math-container">\[    Q_\mathrm{R,direct}=\mathrm{max}((S_\mathrm{R}+Q_\mathrm{HR}−S_\mathrm{Rmax});0.0)\]</p><p class="math-container">\[    Q_\mathrm{R,in,net} = Q_\mathrm{HR} − Q_\mathrm{R,direct}\]</p><p class="math-container">\[    \overline{S_\mathrm{R}} = S_\mathrm{R}/S_\mathrm{R,max}\]</p><p class="math-container">\[    E_\mathrm{R} = \mathrm{min} ( (E_\mathrm{P} - E_\mathrm{I} - E_\mathrm{H}) \cdot \mathrm{min}(\overline{S_\mathrm{R}}/L_\mathrm{P},1), S_\mathrm{R}/\mathrm{d}t  )\]</p><p class="math-container">\[    Q_\mathrm{R} = Q_\mathrm{R,in,net} \cdot (1-(1-\overline{S_\mathrm{R}})^\beta)\]</p><p class="math-container">\[    Q_\mathrm{perc} = Q_\mathrm{perc,max} \cdot \overline{S_\mathrm{R}}\]</p><p class="math-container">\[    Q_\mathrm{cap} = Q_\mathrm{cap,max} \cdot (1 - \overline{S_\mathrm{R}})\]</p><h2 id="Fast-storage-and-runoff"><a class="docs-heading-anchor" href="#Fast-storage-and-runoff">Fast storage and runoff</a><a id="Fast-storage-and-runoff-1"></a><a class="docs-heading-anchor-permalink" href="#Fast-storage-and-runoff" title="Permalink"></a></h2><p>The outflow from the root zone storage <span>$Q_\mathrm{R}$</span> [mm t<span>$^{-1}$</span>] is split with the splitter parameter <span>$d_\mathrm{s}$</span> [-] into inflow in the fast storage (<span>$Q_\mathrm{RF}$</span> [mm t<span>$^{-1}$</span>]) and inflow in the slow storage <span>$Q_\mathrm{RS}$</span> [mm t<span>$^{-1}$</span>] to represent preferential recharge. The fast runoff storage <span>$S_\mathrm{F}$</span> [mm] generates fast runoff <span>$Q_\mathrm{F}$</span> [mm t<span>$^{-1}$</span>] through a simple non-linear equation with a recession constant <span>$K_\mathrm{F}$</span> [t<span>$^{-1}$</span>] and an exponent <span>$\alpha$</span> [-]. </p><p>The following equations apply:</p><p class="math-container">\[    \mathrm{d}S_\mathrm{F}/\mathrm{d}t = Q_\mathrm{RF} - Q_\mathrm{F}\]</p><p class="math-container">\[    Q_\mathrm{RF} = Q_\mathrm{R} \cdot (1-d_\mathrm{s})\]</p><p class="math-container">\[    Q_\mathrm{F} = K_\mathrm{F}^{-1} \cdot S_\mathrm{F}^{\alpha}\]</p><h2 id="Common-slow-groundwater-storage-and-runoff"><a class="docs-heading-anchor" href="#Common-slow-groundwater-storage-and-runoff">Common slow groundwater storage and runoff</a><a id="Common-slow-groundwater-storage-and-runoff-1"></a><a class="docs-heading-anchor-permalink" href="#Common-slow-groundwater-storage-and-runoff" title="Permalink"></a></h2><p>The slow groundwater storage <span>$S_\mathrm{S}$</span> [mm] is a shared storage for all the different classes. It is filled through preferential recharge from the outflow of the root zone storage <span>$Q_\mathrm{RS}$</span> [mm t<span>$^{-1}$</span>] and through percolation <span>$Q_\mathrm{perc}$</span> [mm t<span>$^{-1}$</span>]. It empties through capillary rise <span>$Q_\mathrm{cap}$</span> [mm t<span>$^{-1}$</span>] and through a linear outflow <span>$Q_\mathrm{S}$</span> [mm t<span>$^{-1}$</span>] with recession timescale coefficient <span>$K_\mathrm{S}$</span> [t<span>$^{-1}$</span>]. </p><p>Total streamflow <span>$Q_\mathrm{TOT}$</span> [mm t<span>$^{-1}$</span>] is the weighted sum of the horton fast runoff and the fast runoff from the different classes based on the fraction of each class in a cell (<span>$F_\mathrm{hrufrac}$</span> [-]) and the slow runoff, which is then routed downstream along the river network through the kinematic wave. </p><p class="math-container">\[    \mathrm{d}S_\mathrm{S}/\mathrm{d}t = Q_\mathrm{RS} + Q_\mathrm{perc} - Q_\mathrm{S} - Q_\mathrm{cap}\]</p><p class="math-container">\[    Q_\mathrm{RS} = Q_\mathrm{R} \cdot d_\mathrm{s}\]</p><p class="math-container">\[    Q_\mathrm{S} = K_\mathrm{S}^{-1} \cdot S_\mathrm{S}\]</p><p class="math-container">\[Q_\mathrm{TOT} =  Q_\mathrm{S} + \sum_{class=1}^{n} (Q_\mathrm{F,class} + Q_\mathrm{Hf,class}) \cdot F_\mathrm{hrufrac,class}\]</p><p>&lt;!– <code>math     Q_\mathrm{TOT} = Q_\mathrm{S} + (Q_\mathrm{F,class1} + Q_\mathrm{Hf,class1}) \cdot F_\mathrm{hrufrac,class1} + (Q_\mathrm{F,class2} + Q_\mathrm{Hf,class2}) \cdot F_\mathrm{hrufrac,class2} + ... +  (Q_\mathrm{F,classN} + Q_\mathrm{Hf,classN})  \cdot F_\mathrm{hrufrac,classN}</code> –&gt;</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li><p>Savenije, H. H. G. (2010). HESS opinions “topography driven conceptual modelling (FLEX-Topo).”  Hydrology and Earth System Sciences, 14(12), 2681–2692. https://doi.org/10.5194/hess-14-2681-2010</p></li><li><p>de Boer-Euser, T. (2017). Added value of distribution in rainfall-runoff models for the Meuse basin  PhD thesis, Delft University of Technology. https://doi.org/10.4233/uuid:89a78ae9-7ffb-4260-b25d-698854210fa8 </p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hbv/">« HBV</a><a class="docs-footer-nextpage" href="../sediment/">Sediment »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 21 March 2022 13:08">Monday 21 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

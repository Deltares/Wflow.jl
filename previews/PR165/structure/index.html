<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Structures · Wflow.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/structure/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Wflow.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../publications/">Publications</a></li><li><a class="tocitem" href="../quick-start/">Quick start</a></li><li><a class="tocitem" href="../cli/">Command line interface</a></li><li><span class="tocitem">Structures and config</span><ul><li class="is-active"><a class="tocitem" href>Structures</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Vertical-and-lateral-models"><span>Vertical and lateral models</span></a></li></ul></li><li><a class="tocitem" href="../config/">Config</a></li></ul></li><li><a class="tocitem" href="../model-setup/">Building a model</a></li><li><span class="tocitem">Model parameters</span><ul><li><a class="tocitem" href="../vertical/parameters/">Vertical concepts</a></li><li><a class="tocitem" href="../lateral/kinwave_params/">Kinematic wave</a></li><li><a class="tocitem" href="../lateral/local-inertial_params/">Local inertial</a></li><li><a class="tocitem" href="../lateral/gwf_params/">Groundwater flow</a></li><li><a class="tocitem" href="../lateral/sediment_params/">Sediment flux</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../model/sbm/">wflow_sbm</a></li><li><a class="tocitem" href="../model/hbv/">wflow_hbv</a></li><li><a class="tocitem" href="../model/sediment/">wflow_sediment</a></li></ul></li><li><span class="tocitem">Vertical components</span><ul><li><a class="tocitem" href="../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../vertical/process/">Vertical processes</a></li><li><a class="tocitem" href="../vertical/sediment/">Soil Loss</a></li></ul></li><li><span class="tocitem">Lateral components</span><ul><li><a class="tocitem" href="../lateral/kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../lateral/local-inertial/">Local inertial</a></li><li><a class="tocitem" href="../lateral/gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../lateral/sediment/">Sediment Flux</a></li></ul></li><li><a class="tocitem" href="../bmi/">Basic Model Interface</a></li><li><a class="tocitem" href="../fews/">Run from Delft-FEWS</a></li><li><a class="tocitem" href="../changelog/">Changelog</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Structures and config</a></li><li class="is-active"><a href>Structures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Structures</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/structure.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Structures"><a class="docs-heading-anchor" href="#Structures">Structures</a><a id="Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Structures" title="Permalink"></a></h1><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>Below the composite type that represents all different aspects of a <code>Wflow.Model</code>, such as  the network, parameters, clock, configuration and input and output.</p><pre><code class="language-julia hljs">struct Model{N,L,V,R,W}
    config::Config  # all configuration options
    network::N      # connectivity information, directed graph
    lateral::L      # lateral model that holds lateral state, moves along network
    vertical::V     # vertical model that holds vertical state, independent of each other
    clock::Clock    # to keep track of simulation time
    reader::R       # provides the model with dynamic input
    writer::W       # writes model output
end</code></pre><p>The <code>lateral</code> field of the <code>struct Model</code> can contain different lateral concepts. For each Wflow model these different lateral concepts are mapped through the use of a <code>NamedTuple</code>. The <code>vertical</code> field of the <code>struct Model</code> always contains one vertical concept, for example the SBM or HBV vertical concept.</p><p>Below an example how lateral concepts are mapped for the SBM model through a <code>NamedTuple</code>:</p><pre><code class="language-julia hljs">(subsurface = ssf, land = olf, river = rf)</code></pre><p>The <code>subsurface</code> part is mapped to the lateral subsurface flow kinematic wave concept, the <code>land</code> part is mapped the overland flow kinematic wave concept and the <code>river</code> part is mapped to the river flow kinematic wave concept. Knowledge of this specific mapping is required to understand and correctly set input, output and state variables in the TOML configuration file, see also <a href="../config/#Config-and-TOML">Config and TOML</a>. This mapping is described in more detail for each model in the section Models. Also the <code>struct</code> of each mapped concept is provided, so one can check the internal variables in the code. These structs are defined as a parametric composite type, with type parameters between curly braces after the <code>struct</code> name. See also the next paragraph <a href="#Vertical-and-lateral-models">Vertical and lateral models</a> for a more detailed description.</p><h2 id="Vertical-and-lateral-models"><a class="docs-heading-anchor" href="#Vertical-and-lateral-models">Vertical and lateral models</a><a id="Vertical-and-lateral-models-1"></a><a class="docs-heading-anchor-permalink" href="#Vertical-and-lateral-models" title="Permalink"></a></h2><p>The different model concepts used in Wflow are defined as parametric <a href="https://docs.julialang.org/en/v1/manual/types/#Composite-Types">composite types</a>. For example the vertical <code>SBM</code> concept is defined as follows: <code>struct SBM{T,N,M}</code>. <code>T</code>, <code>N</code> and <code>M</code> between curly braces after the <code>struct</code> name refer to type parameters, for more information about type parameters you can check out <a href="https://docs.julialang.org/en/v1/manual/types/#man-parametric-composite-types">Type parameters</a>. Since these parameters can be of any type, it is possible to declare an unlimited number of composite types. The type parameters are used to set the type of <code>struct</code> fields, below an example with a part of the <code>SBM</code> struct:</p><pre><code class="language-julia hljs">@get_units @with_kw struct SBM{T,N,M}
    # Model time step [s]
    Δt::T | &quot;s&quot;
    # Maximum number of soil layers
    maxlayers::Int | &quot;-&quot;
    # number of cells
    n::Int | &quot;-&quot;
    # Number of soil layers
    nlayers::Vector{Int} | &quot;-&quot;
    # Number of unsaturated soil layers
    n_unsatlayers::Vector{Int} | &quot;-&quot;
    # Fraction of river [-]
    riverfrac::Vector{T} | &quot;-&quot;
    # Saturated water content (porosity) [mm mm⁻¹]
    θₛ::Vector{T} | &quot;mm mm-1&quot;
    # Residual water content [mm mm⁻¹]
    θᵣ::Vector{T} | &quot;mm mm-1&quot;
    # Vertical hydraulic conductivity [mm Δt⁻¹] at soil surface
    kv₀::Vector{T} | &quot;mm Δt-1&quot;
    # Muliplication factor [-] applied to kv_z (vertical flow)
    kvfrac::Vector{SVector{N,T}} | &quot;-&quot;</code></pre><p>The type parameter <code>T</code> is used in Wflow as a subtype of <code>AbstractFloat</code>, allowing to store fields with a certain floating point precision (e.g. <code>Float64</code> or <code>Float32</code>) in a flexible way. <code>N</code> refers to the maximum number of soil layers of the <code>SBM</code> soil column, and <code>M</code> refers to the maximum number of soil layers + 1. See also part of the following instance of <code>SBM</code>:</p><pre><code class="language-julia hljs">sbm = SBM{Float,maxlayers,maxlayers + 1}(
    Δt = tosecond(Δt),
    maxlayers = maxlayers,
    n = n,</code></pre><p>For the other model concepts, we refer to the code to check these type parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cli/">« Command line interface</a><a class="docs-footer-nextpage" href="../config/">Config »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Monday 4 October 2021 14:17">Monday 4 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

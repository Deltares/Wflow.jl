<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SBM · Wflow.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/vertical/sbm/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Wflow.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick-start/">Quick start</a></li><li><a class="tocitem" href="../../cli/">Command line interface</a></li><li><span class="tocitem">Model structure and config</span><ul><li><a class="tocitem" href="../../structure/">Model structure</a></li><li><a class="tocitem" href="../../config/">Config</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../model/sbm/">wflow_sbm</a></li><li><a class="tocitem" href="../../model/hbv/">wflow_hbv</a></li><li><a class="tocitem" href="../../model/sediment/">wflow_sediment</a></li></ul></li><li><span class="tocitem">Vertical components</span><ul><li class="is-active"><a class="tocitem" href>SBM</a><ul class="internal"><li><a class="tocitem" href="#Snow"><span>Snow</span></a></li><li><a class="tocitem" href="#Glaciers"><span>Glaciers</span></a></li><li><a class="tocitem" href="#Soil"><span>Soil</span></a></li><li><a class="tocitem" href="#Transpiration-and-soil-evaporation"><span>Transpiration and soil evaporation</span></a></li><li><a class="tocitem" href="#Leakage"><span>Leakage</span></a></li><li><a class="tocitem" href="#Soil-temperature"><span>Soil temperature</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../hbv/">HBV</a></li><li><a class="tocitem" href="../process/">Vertical processes</a></li><li><a class="tocitem" href="../sediment/">Soil Loss</a></li></ul></li><li><span class="tocitem">Lateral components</span><ul><li><a class="tocitem" href="../../lateral/kinwave/">Kinematic wave</a></li><li><a class="tocitem" href="../../lateral/gwf/">Groundwater flow</a></li><li><a class="tocitem" href="../../lateral/sediment/">Sediment Flux</a></li></ul></li><li><a class="tocitem" href="../../bmi/">Basic Model Interface</a></li><li><a class="tocitem" href="../../fews/">Run from Delft-FEWS</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Vertical components</a></li><li class="is-active"><a href>SBM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SBM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/vertical/sbm.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SBM-vertical-concept"><a class="docs-heading-anchor" href="#SBM-vertical-concept">SBM vertical concept</a><a id="SBM-vertical-concept-1"></a><a class="docs-heading-anchor-permalink" href="#SBM-vertical-concept" title="Permalink"></a></h1><p>The SBM vertical concept has its roots in the Topog_SBM model but has had considerable changes over time. The main differences are:</p><ul><li>The unsaturated zone can be split-up in different layers</li><li>The addition of evapotranspiration losses</li><li>The addition of a capillary rise</li></ul><p>The sections below describe the working of the SBM vertical concept in more detail.</p><h2 id="Snow"><a class="docs-heading-anchor" href="#Snow">Snow</a><a id="Snow-1"></a><a class="docs-heading-anchor-permalink" href="#Snow" title="Permalink"></a></h2><p>Snow modelling is enabled by specifying the following in the TOML file:</p><pre><code class="language-toml">[model]
snow = true</code></pre><p>The snow model is described in <a href="../process/#Snow-modelling">Snow modelling</a></p><h2 id="Glaciers"><a class="docs-heading-anchor" href="#Glaciers">Glaciers</a><a id="Glaciers-1"></a><a class="docs-heading-anchor-permalink" href="#Glaciers" title="Permalink"></a></h2><p>Glacier processes are described in <a href="../process/#Glacier-modelling">Glacier modelling</a>. Glacier modelling is enabled by specifying the following in the TOML file:</p><pre><code class="language-toml">[model]
glacier = true</code></pre><h2 id="Soil"><a class="docs-heading-anchor" href="#Soil">Soil</a><a id="Soil-1"></a><a class="docs-heading-anchor-permalink" href="#Soil" title="Permalink"></a></h2><h3 id="Infiltration"><a class="docs-heading-anchor" href="#Infiltration">Infiltration</a><a id="Infiltration-1"></a><a class="docs-heading-anchor-permalink" href="#Infiltration" title="Permalink"></a></h3><p>If the surface is (partly) saturated the throughfall and stemflow that falls onto the saturated area is added to the river runoff component (based on fraction rivers, <code>riverfrac</code>) and to the overland runoff component (based on open water fraction (<code>waterfrac</code>) minus <code>riverfrac</code>). Infiltration of the remaining water is determined as follows:</p><p>The soil infiltration capacity can be adjusted in case the soil is frozen, this is optional and can be set in the TOML file as follows:</p><pre><code class="language-toml">[model]
soilinfreduction = true </code></pre><p>The remaining storage capacity of the unsaturated store is determined.  The infiltrating water is split in two parts, the part that falls on compacted areas and the part that falls on non-compacted areas. The maximum amount of water that can infiltrate in these areas is calculated by taking the minimum of the maximum infiltration rate (<code>infiltcapsoil</code> for non-compacted areas and <code>infiltcappath</code> for compacted areas) and the water on these areas. The water that can actual infiltrate is calculated by taking the minimum of the total maximum infiltration rate (compacted and non-compacted areas) and the remaining storage capacity.</p><p>Infiltration excess occurs when the infiltration capacity is smaller then the throughfall and stemflow rate. This amount of water (<code>infiltexcess</code>) becomes overland flow (infiltration excess overland flow). Saturation excess occurs when the (upper) soil becomes saturated and water cannot infiltrate anymore. This amount of water (<code>excesswater</code> and <code>exfiltwater</code>) becomes overland flow (saturation excess overland flow).</p><h3 id="The-SBM-soil-water-accounting-scheme"><a class="docs-heading-anchor" href="#The-SBM-soil-water-accounting-scheme">The SBM soil water accounting scheme</a><a id="The-SBM-soil-water-accounting-scheme-1"></a><a class="docs-heading-anchor-permalink" href="#The-SBM-soil-water-accounting-scheme" title="Permalink"></a></h3><p>A detailed description of the Topog_SBM model has been given by Vertessy (1999). Briefly: the soil is considered as a bucket with a certain depth (<span>$z_{t}$</span>), divided into a saturated store (<span>$S$</span>) and an unsaturated store (<span>$U$</span>), the magnitudes of which are expressed in units of depth. The top of the <span>$S$</span> store forms a pseudo-water table at depth <span>$z_{i}$</span> such that the value of <span>$S$</span> at any time is given by:</p><p class="math-container">\[    S=(z_{t}-z_{i})(\theta_{s}-\theta_{r})\]</p><p>where <span>$\theta_{s}$</span> and <span>$\theta_{r}$</span> are the saturated and residual soil water contents, respectively. </p><p>The unsaturated store (<span>$U$</span>) is subdivided into storage (<span>$U_{s}$</span>) and deficit (<span>$U_{d}$</span>) which are again expressed in units of depth:</p><p class="math-container">\[    U_{d}=(\theta_{s}-\theta_{r})z_{i}-U\\
    U_{s}=U-U_{d}\]</p><p>The saturation deficit (<span>$S_{d}$</span>) for the soil profile as a whole is defined as: </p><p class="math-container">\[    S_{d}=(\theta_{s}-\theta_{r})z_{t}-S\]</p><p>All infiltrating water that enters the <span>$U$</span> store first. The unsaturated layer can be split-up in different layers, by providing the thickness [mm] of the layers in the TOML file. The following example specifies three layers (from top to bottom) of 100, 300 and 800 mm: </p><pre><code class="language-toml">[model]
thicknesslayers = [100, 300, 800]</code></pre><p>The code checks for each grid cell the specified layers against the <code>soilthickness</code>, and adds or removes (partly) layer(s) based on the <code>soilthickness</code>.</p><p>Assuming a unit head gradient, the transfer of water (<span>$st$</span>) from a <span>$U$</span> store layer is controlled by the saturated hydraulic conductivity <span>$K_{sat}$</span> at depth <span>$z$</span> (bottom layer) or <span>$z_{i}$</span>, the effective saturation degree of the layer, and a Brooks-Corey power coefficient (parameter <span>$c$</span>) based on the pore size distribution index <span>$\lambda$</span> (Brooks and Corey (1964)):</p><p class="math-container">\[    st=K_{\mathit{sat}}\left(\frac{\theta-\theta_{r}}{\theta_{s}-\theta_{r}}\right)^{c}\\~\\
    c=\frac{2+3\lambda}{\lambda}\]</p><p>When the unsaturated layer is not split-up into different layers, it is possible to use the original Topog_SBM vertical transfer formulation, by specifying in the TOML file:</p><pre><code class="language-toml">[model]
transfermethod = true</code></pre><p>The transfer of water from the <span>$U$</span> store to the <span>$S$</span> store (<span>$st$</span>) is in that case controlled by the saturated hydraulic conductivity <span>$K_{sat}$</span> at depth <span>$z_{i}$</span> and the ratio between <span>$U$</span> and <span>$S_{d}$</span>: </p><p class="math-container">\[    st=K_{\mathit{sat}}\frac{U_{s}}{S_{d}}\]</p><p>Saturated conductivity (<span>$K_{sat}$</span>) declines with soil depth (<span>$z$</span>) in the model according to: </p><p class="math-container">\[    K_{sat}=K_{0}e^{(-fz)}\]</p><p>where <span>$K_{0}$</span> is the saturated conductivity at the soil surface and <span>$f$</span> is a scaling parameter [mm<span>$^{-1}$</span>].</p><h2 id="Transpiration-and-soil-evaporation"><a class="docs-heading-anchor" href="#Transpiration-and-soil-evaporation">Transpiration and soil evaporation</a><a id="Transpiration-and-soil-evaporation-1"></a><a class="docs-heading-anchor-permalink" href="#Transpiration-and-soil-evaporation" title="Permalink"></a></h2><p>The potential evaporation left over after interception and open water evaporation (rivers and water bodies) is split in potential soil evaporation and potential transpiration based on the canopy gap fraction (assumed to be identical to the amount of bare soil).</p><p>For the case of one single soil layer, soil evaporation is scaled according to:</p><pre><code class="nohighlight">soilevapunsat = potsoilevap * min(1.0, saturationdeficit / sbm.soilwatercapacity[i])</code></pre><p>As such, evaporation will be potential if the soil is fully wetted and it decreases linear with increasing soil moisture deficit.</p><p>For more than one soil layer, soil evaporation is only provided from the upper soil layer (often 100 mm) and soil evaporation is split in evaporation from the unsaturated store and evaporation from the saturated store. First water is evaporated water from the unsaturated store. Then the remaining potential soil evaporation can be used for evaporation from the saturated store. This is only possible, when the water table is present in the upper soil layer (very wet conditions). Both the evaporation from the unsaturated store and the evaporation from the saturated store are limited by the minimum of the remaining potential soil evaporation and the available water in the unsaturated/saturated zone of the upper soil layer. Also for multiple soil layers, the evaporation (both unsaturated and saturated) decreases linearly with decreasing water availability.</p><p>The original Topog_SBM model does not include transpiration or a notion of capillary rise. In SBM transpiration is first taken from the <span>$S$</span> store if the roots reach the water table <span>$z_{i}$</span>. If the <span>$S$</span> store cannot satisfy the demand the <span>$U$</span> store is used next. First the number of wet roots is determined (going from 1 to 0) using a sigmoid function as follows:</p><p class="math-container">\[    wetroots = 1.0/(1.0 + e^{-rootdistpar (zi - rootindepth)})\]</p><p>Here the sharpness parameter <code>rootdistpar</code> (by default a large negative value, -500.0) determines if there is a stepwise output or a more gradual output (default is stepwise). <code>zi</code> [mm] is the level of the water table in the grid cell below the surface, <code>rootindepth</code> [mm] is the maximum depth of the roots below the surface. For all values of <code>zi</code> smaller that <code>rootindepth</code> a value of 1 is returned if they are equal a value of 0.5 is returned if <code>zi</code> is larger than the <code>rootindepth</code> a value of 0 is returned. The returned <code>wetroots</code> fraction is multiplied by the potential evaporation (and limited by the available water in saturated zone) to get the transpiration from the saturated part of the soil:</p><pre><code class="nohighlight">    # transpiration from saturated store
    wetroots = scurve(sbm.zi[i], rootingdepth, 1.0, sbm.rootdistpar[i])
    actevapsat = min(pottrans * wetroots, satwaterdepth)
    satwaterdepth = satwaterdepth - actevapsat
    restpottrans = pottrans - actevapsat</code></pre><p>Next the remaining potential evaporation is used to extract water from the unsaturated store. The fraction of roots (<code>availcap</code>) that cover the unsaturated zone for each soil layer is used to calculate the potential root water extraction rate (<code>maxextr</code>):</p><pre><code class="nohighlight">maxextr = availcap * ustorelayerdepth</code></pre><p>When <code>whole_ust_available</code> is set to true in the TOML file as follows, the complete unsaturated storage is available for transpiration:</p><pre><code class="language-toml">[model]
whole_ust_available = true</code></pre><p>Next, the Feddes root water uptake reduction model (Feddes et al., 1978) is used to calculate a reduction coefficient as a function of soil water pressure. Soil water pressure is calculated following Brooks and Corey (1964):</p><p class="math-container">\[    \frac{(\theta-\theta_r)}{(\theta_s-\theta_r)} =  \Bigg\lbrace{\left(\frac{h_b}{h}\right)^{\lambda}, h &gt; h_b \atop 1 , h \leq h_b}\]</p><p>where <span>$h$</span> is the pressure head (cm), <span>$h_b$</span> is the air entry pressure head, and <span>$\theta$</span>, <span>$\theta_s$</span>, <span>$\theta_r$</span> and <span>$\lambda$</span> as previously defined.</p><p>Feddes (1978) described a transpiration reduction-curve for the reduction coefficient <span>$\alpha$</span>, as a function of <span>$h$</span>.</p><p>Below, the function used in SBM, that calculates actual transpiration from the unsaturated zone layer(s).</p><article class="docstring"><header><a class="docstring-binding" id="Wflow.acttransp_unsat_sbm" href="#Wflow.acttransp_unsat_sbm"><code>Wflow.acttransp_unsat_sbm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">acttransp_unsat_sbm(rootingdepth, ustorelayerdepth, sumlayer, restpotevap, sum_actevapustore, c, usl, θₛ, θᵣ, hb, ust::Bool = false)</code></pre><p>Compute actual transpiration for unsaturated zone. If <code>ust</code> is <code>true</code>, the whole unsaturated store is available for transpiration.</p><p><strong>Arguments</strong></p><ul><li><code>rootingdepth</code></li><li><code>ustorelayerdepth</code></li><li><code>sumlayer</code> (depth (z) of upper boundary unsaturated layer)</li><li><code>restpotevap</code> (remaining evaporation)</li><li><code>sum_actevapustore</code> (cumulative actual transpiration (more than one unsaturated layers))</li><li><code>c</code> (Brooks-Corey coefficient)</li><li><code>usl</code> (thickness of unsaturated zone)</li><li><code>θₛ</code></li><li><code>θᵣ</code></li><li><code>hb</code> (air entry pressure)</li><li><code>ust</code></li></ul><p><strong>Output</strong></p><ul><li><code>ustorelayerdepth</code></li><li><code>sum_actevapustore</code></li><li><code>restpotevap</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Deltares/Wflow.jl/blob/184bc401ddefae056d3ca7590fb1993399b4ac48/src/vertical_process.jl#LL121-L144">source</a></section></article><p>Capillary rise is determined using the following approach: first <span>$K_{sat}$</span> is determined at the water table <span>$z_{i}$</span>; next a potential capillary rise is determined from the minimum of the <span>$K_{sat}$</span>, the actual transpiration taken from the <span>$U$</span> store, the available water in the <span>$S$</span> store and the deficit of the <span>$U$</span> store. Finally the potential rise is scaled using the distance between the roots and the water table using:</p><p class="math-container">\[CSF=CS/(CS+z_{i}-RT)\]</p><p>in which <span>$CSF$</span> is the scaling factor to multiply the potential rise with, <span>$CS$</span> is a model parameter (default = 100) and <span>$RT$</span> the rooting depth. If the roots reach the water table (<span>$RT &gt; z_{i}$</span>) <span>$CS$</span> is set to zero thus setting the capillary rise to zero.</p><h2 id="Leakage"><a class="docs-heading-anchor" href="#Leakage">Leakage</a><a id="Leakage-1"></a><a class="docs-heading-anchor-permalink" href="#Leakage" title="Permalink"></a></h2><p>If the <code>maxleakage</code> parameter is set &gt; 0, water is lost from the saturated zone and runs out of the model.</p><h2 id="Soil-temperature"><a class="docs-heading-anchor" href="#Soil-temperature">Soil temperature</a><a id="Soil-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-temperature" title="Permalink"></a></h2><p>The near surface soil temperature is modelled using a simple equation (Wigmosta et al., 2009):</p><p class="math-container">\[T_s^{t} = T_s^{t-1} + w  (T_a - T_s^{t-1})  \]</p><p>where <span>$T_s^{t}$</span> is the near-surface soil temperature at time <span>$t$</span>, <span>$T_a$</span> is air temperature and <span>$w$</span> is a weighting coefficient determined through calibration (default is 0.1125 for daily timesteps).</p><p>A reduction factor (<code>cf_soil</code>, default is 0.038) is applied to the maximum infiltration rate (<code>infiltcapsoil</code> and <code>infiltcappath</code>), when the following model settings are specified in the TOML file:</p><pre><code class="language-toml">[model]
soilinfreduction = true
snow = true</code></pre><p>A S-curve is used to make a smooth transition (a c-factor (<span>$c$</span>) of 8.0 is used):</p><p class="math-container">\[    b = \frac{1.0}{(1.0 - cf\_soil)}\\~\\
    soilinfredu = \frac{1.0}{b + exp(-c (T_s - a))} + cf\_soil\\~\\
    a = 0.0\\
    c = 8.0\]</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Brooks, R. H., and Corey, A. T., 1964, Hydraulic properties of porous media, Hydrology Papers 3, Colorado State University, Fort Collins, 27 p.</li><li>Feddes, R.A., Kowalik, P.J. and Zaradny, H., 1978, Simulation of field water use and crop yield, Pudoc, Wageningen, Simulation Monographs.</li><li>Vertessy, R., and Elsenbeer, H., 1999, Distributed modeling of storm ﬂow generation in an amazonian rain forest catchment: effects of model parameterization, Water Resour. Res., 35, 2173–2187. doi: 10.1029/1999WR9000511257.</li><li>Wigmosta, M. S., Lane, L. J., Tagestad, J. D., and Coleman A. M., 2009, Hydrologic and erosion models to assess land use and management practices affecting soil erosion, J. Hydrol. Eng., 14, 27-41.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../model/sediment/">« wflow_sediment</a><a class="docs-footer-nextpage" href="../hbv/">HBV »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 June 2021 19:19">Wednesday 16 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

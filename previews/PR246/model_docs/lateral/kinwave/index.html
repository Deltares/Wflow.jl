<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Kinematic wave · Wflow.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://deltares.github.io/Wflow.jl/model_docs/lateral/kinwave/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Wflow.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Wflow.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">About wflow</a></li><li><a class="tocitem" href="../../../intro/use_cases/">Case studies</a></li><li><a class="tocitem" href="../../../intro/publications/">Publications</a></li><li><a class="tocitem" href="../../../changelog/">Changelog</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../../user_guide/intro/">About the user guide</a></li><li><a class="tocitem" href="../../../user_guide/install/">How to install</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">How to use wflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../user_guide/step1_requirements/">Step 1: Understanding the requirements</a></li><li><a class="tocitem" href="../../../user_guide/step2_settings_file/">Step 2: Preparing the settings file</a></li><li><a class="tocitem" href="../../../user_guide/step3_input_data/">Step 3: Preparing the input data</a></li><li><a class="tocitem" href="../../../user_guide/step4_running/">Step 4: Running a simulation</a></li><li><a class="tocitem" href="../../../user_guide/step5_output/">Step 5: Analyzing the model output</a></li><li><a class="tocitem" href="../../../user_guide/additional_options/">Additional wflow options</a></li><li><a class="tocitem" href="../../../user_guide/sample_data/">Example models</a></li></ul></li><li><a class="tocitem" href="../../../user_guide/model-setup/">Building a model from scratch</a></li></ul></li><li><span class="tocitem">Model documentation</span><ul><li><a class="tocitem" href="../../intro/">About the model documentation</a></li><li><a class="tocitem" href="../../model_configurations/">Model configurations</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vertical concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../vertical/sbm/">SBM</a></li><li><a class="tocitem" href="../../vertical/hbv/">HBV</a></li><li><a class="tocitem" href="../../vertical/flextopo/">FLEXTopo</a></li><li><a class="tocitem" href="../../vertical/sediment/">Sediment</a></li><li><a class="tocitem" href="../../shared_concepts/">Shared processes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Lateral concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gwf/">Groundwater flow</a></li><li class="is-active"><a class="tocitem" href>Kinematic wave</a><ul class="internal"><li><a class="tocitem" href="#Surface-routing"><span>Surface routing</span></a></li><li><a class="tocitem" href="#Inflow"><span>Inflow</span></a></li><li><a class="tocitem" href="#Subsurface-flow-routing"><span>Subsurface flow routing</span></a></li><li><a class="tocitem" href="#Multi-Threading"><span>Multi-Threading</span></a></li><li><a class="tocitem" href="#Subcatchment-flow"><span>Subcatchment flow</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li><li><a class="tocitem" href="#External-inflows"><span>External inflows</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../local-inertial/">Local inertial</a></li><li><a class="tocitem" href="../waterbodies/">Reservoirs and Lakes</a></li><li><a class="tocitem" href="../sediment_flux/">Sediment flux</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Model parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../params_vertical/">Parameters vertical concepts</a></li><li><a class="tocitem" href="../../params_lateral/">Parameters lateral concepts</a></li><li><a class="tocitem" href="../../structures/">Julia structures</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model documentation</a></li><li><a class="is-disabled">Lateral concepts</a></li><li class="is-active"><a href>Kinematic wave</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Kinematic wave</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Deltares/Wflow.jl/blob/master/docs/src/model_docs/lateral/kinwave.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="kin_wave"><a class="docs-heading-anchor" href="#kin_wave">Kinematic wave</a><a id="kin_wave-1"></a><a class="docs-heading-anchor-permalink" href="#kin_wave" title="Permalink"></a></h1><h2 id="Surface-routing"><a class="docs-heading-anchor" href="#Surface-routing">Surface routing</a><a id="Surface-routing-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-routing" title="Permalink"></a></h2><p>The main flow routing scheme available in Wflow.jl is the kinematic wave approach for channel and overland flow, assuming that the topography controls water flow mostly. The kinematic wave equations are (Chow, 1988):</p><p class="math-container">\[  \dfrac{dQ}{dx} + \dfrac{dA}{dt} = q \\~\\
   A = \alpha Q^{\beta}\]</p><p>These equations can then be combined as a function of streamflow only:</p><p class="math-container">\[    \dfrac{dQ}{dx} + \alpha \beta Q^{\beta - 1} \dfrac{dQ}{dt} = q\]</p><p>where <span>$Q$</span> is the surface runoff in the kinematic wave [m<span>$^3$</span>/s], <span>$x$</span> is the length of the runoff pathway [m], <span>$A$</span> is the cross-section area of the runoff pathway [m<span>$^{2}$</span>], <span>$t$</span> is the integration timestep [s] and <span>$\alpha$</span> and <span>$\beta$</span> are coefficients.</p><p>These equations are solved with a nonlinear scheme using Newton’s method and can also be iterated depending on the  model space and time resolution. By default, the iterations are performed until a stable solution is reached (<span>$\epsilon &lt; 10^{-12}$</span>). For larger models, the number of iterations can also be fixed for to a specific sub-timestep (in seconds) for both overland and channel flows to improve simulation time. To enable (fixed or not) iterations of the kinematic wave the following lines can be inserted in the TOML file of the model:</p><pre><code class="language-toml hljs">[model]
# Enable iterations of the kinematic wave
kin_wave_iteration = true
# Fixed sub-timestep for iterations of channel flow (river cells)
kw_river_tstep = 900
# Fixed sub-timestep for iterations of overland flow (land cells)
kw_land_tstep = 3600</code></pre><p>The <span>$\alpha$</span> parameter of the kinematic wave is fixed. To estimate the wetted perimeter for the calculation of the <span>$\alpha$</span> parameter a bankfull river depth map (default value is 1.0 m) for the river can be provided as follows:</p><pre><code class="language-toml hljs">[input.lateral.river]
bankfull_depth = &quot;wflow_riverdepth&quot;</code></pre><p>The wetted perimeter of the river is based on half bankfull river depth. For the land part the wetted perimeter is based on the flow width.</p><p>Simplified <a href="../waterbodies/#reservoir_lake">reservoir and lake</a> models can be included as part of the river kinematic wave network.</p><h2 id="Inflow"><a class="docs-heading-anchor" href="#Inflow">Inflow</a><a id="Inflow-1"></a><a class="docs-heading-anchor-permalink" href="#Inflow" title="Permalink"></a></h2><p>External water (supply/abstraction) <code>inflow</code> [m<span>$^3$</span> s<span>$^{-1}$</span>]  can be added to the kinematic wave for surface water routing, as a cyclic parameter or as part of forcing (see also <a href="../../../user_guide/step2_settings_file/#Input-section">Input section</a>).</p><h2 id="Subsurface-flow-routing"><a class="docs-heading-anchor" href="#Subsurface-flow-routing">Subsurface flow routing</a><a id="Subsurface-flow-routing-1"></a><a class="docs-heading-anchor-permalink" href="#Subsurface-flow-routing" title="Permalink"></a></h2><p>In the SBM model the kinematic wave approach is used to route subsurface flow laterally. The saturated store <span>$S$</span> can be drained laterally by saturated downslope subsurface flow per unit width of slope <span>$w$</span> [m] according to:</p><p class="math-container">\[    q=\frac{K_{0}\mathit{tan(\beta)}}{f}(e^{(-fz_{i})}-e^{(-fz_{t})})\]</p><p>where <span>$\beta$</span> is element slope angle [deg.], <span>$q$</span> is subsurface flow [m<span>$^{2}$</span>/t], <span>$K_{0}$</span> is the saturated hydraulic conductivity at the soil surface [m/t], <span>$z_{i}$</span> is the water table depth [m], <span>$z_{t}$</span> is total soil depth [m], and <span>$f$</span> is a scaling parameter [m<span>$^{-1}$</span>], that controls the decrease of vertical saturated conductivity with depth.</p><p>Combining with the following continuity equation:</p><p class="math-container">\[    (\theta_s-\theta_r)\frac{\partial h}{\partial t} = -w\frac{\partial q}{\partial x} + wr\]</p><p>where <span>$h$</span> is the water table height [m], <span>$x$</span> is the distance downslope [m], and <span>$r$</span> is the net input rate [m/t] to the saturated store. Substituting for <span>$h (\frac{\partial q}{\partial h})$</span>, gives:</p><p class="math-container">\[  w \frac{\partial q}{\partial t} = -cw\frac{\partial q}{\partial x} + cwr\]</p><p>where celerity <span>$c = \frac{K_{0}\mathit{tan(\beta)}}{(\theta_s-\theta_r)} e^{(-fz_{i})}$</span></p><p>The kinematic wave equation for lateral subsurface flow is solved iteratively using Newton&#39;s method.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For the lateral subsurface flow kinematic wave the model timestep is not adjusted. For certain model timestep and model grid size combinations this may result in loss of accuracy.</p></div></div><h2 id="Multi-Threading"><a class="docs-heading-anchor" href="#Multi-Threading">Multi-Threading</a><a id="Multi-Threading-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Threading" title="Permalink"></a></h2><p>The kinematic wave calculations for surface - and subsurface flow routing can be executed in parallel using multiple threads. In the model section of the TOML file, a minimum stream order can be provided (default is 4) to define subbasins. Subbasins are created at all confluences where each branch has a minimal stream order. Based on the subbasins a directed acyclic graph is created that controls the order of execution and which subbasins can run in parallel.</p><pre><code class="language-toml hljs">[model]
min_streamorder = 3   # minimum stream order to delineate subbasins, default is 4</code></pre><h2 id="Subcatchment-flow"><a class="docs-heading-anchor" href="#Subcatchment-flow">Subcatchment flow</a><a id="Subcatchment-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Subcatchment-flow" title="Permalink"></a></h2><p>Normally the the kinematic wave is continuous throughout the model. By using the <code>pits</code> entry in the model and input sections of the TOML file all flow is at the subcatchment only (upstream of the pit locations, defined by the netCDF variable <code>wflow_pits</code> in the example below) and no flow is transferred from one subcatchment to another. This can be convenient when connecting the result of the model to a water allocation model such as Ribasim.</p><pre><code class="language-toml hljs">[input]
# these are not directly part of the model
pits = &quot;wflow_pits&quot;

[model]
pits = true</code></pre><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><p>The kinematic wave approach for channel, overland and lateral subsurface flow, assumes that the topography controls water flow mostly. This assumption holds for steep terrain, but in less steep terrain the hydraulic gradient is likely not equal to the surface slope (subsurface flow), or pressure differences and inertial momentum cannot be neglected (channel and overland flow). In addition, while the kinematic wave equations are solved with a nonlinear scheme using Newton&#39;s method (Chow, 1988), other model equations are solved through a simple explicit scheme. In summary the following limitations apply:</p><ul><li><p>Channel flow, and to a lesser degree overland flow, may be unrealistic in terrain that is not steep, and where pressure forces and inertial momentum are important.</p></li><li><p>The lateral movement of subsurface flow may be very wrong in terrain that is not steep.</p></li></ul><h2 id="External-inflows"><a class="docs-heading-anchor" href="#External-inflows">External inflows</a><a id="External-inflows-1"></a><a class="docs-heading-anchor-permalink" href="#External-inflows" title="Permalink"></a></h2><p>External inflows, for example water supply or abstractions, can be added to the kinematic wave via the <code>inflow</code> variable. For this, the user can supply a 2D map of the inflow which can be static or dynamic (changing every timestep or cyclic is possible). These inflow are added or abstracted from the upstream inflow <code>qin</code> before running the kinematic wave to solve the impact on resulting <code>q</code>. In case of a negative inflow (abstractions), a minimum of zero is applied to the upstream flow <code>qin</code>.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Chow, V., Maidment, D. and Mays, L., 1988, Applied Hydrology. McGraw-Hill Book Company, New York.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gwf/">« Groundwater flow</a><a class="docs-footer-nextpage" href="../local-inertial/">Local inertial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 2 March 2023 21:21">Thursday 2 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
